function getIosVersion(e,t){if(/iP(hone|od|ad)/.test(e||navigator.platform)){var a=(t||navigator.appVersion).match(/OS (\d+)_(\d+)_?(\d+)?/);return[parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3]||0,10)]}return!1}function _eC(e,t,a){window.error_catcher&&error_catcher.send_error(e,t,a||{});var i="";if("undefined"!=typeof a&&a.trace&&1==getCookie("show_me_debug")){var n="trace"+999999999*Math.random();i='<div style="margin-top:10px;"><a style="color: #0af;padding: 10px 0 0;" onclick="var el=document.getElementById(\''+n+"'); if(el){el.style.display=('none'==el.style.display)?'block':'none';}\">Подробнее &raquo;</a></div><div id=\""+n+'" style="margin-top:10px;display: none;"><ul>';for(var r=0;r<a.trace.length;r++)i+="<li>"+a.trace[r]+"</li>";i+="</ul></div>"}$('<div id="locked_screen" style="overflow:auto"><div class="wnd" style="text-align:left;margin:60px auto;"><div class="header">Ошибка'+(e.code>0?" #"+e.code:"")+'!</div><div style="font-size:16px;margin:30px 0 0;padding: 20px;background: rgba(0,0,0,.05);border-radius: 3px;">'+e.message+"</div>"+i+(t>0?'<div style="color:#ccc;margin-top:10px;font-size:10px;">(catcher '+t+")</div>":"")+'<div class="btn_wrap"><div class="btn-m btn-default btn-ghost" onclick="window.location.href=window.location.href;">Перезагрузить страницу</div></div></div></div>').appendTo($("body")),setTimeout(function(){throw e},0)}function trim(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")}function ge(e){return"string"==typeof e||"number"==typeof e?document.getElementById(e):e}function geByTag(e,t){return(t||document).getElementsByTagName(e)}function geByTag1(e,t){return t=t||document,t.querySelector&&t.querySelector(e)||geByTag(e,t)[0]}function geByClass(e,t,a){if(t=t||document,a=a||"*",!browser.msie8&&t.querySelectorAll&&"*"!=a)return t.querySelectorAll(a+"."+e);var i=[];if(t.getElementsByClassName){var n=t.getElementsByClassName(e);if("*"!=a){a=a.toUpperCase();for(var r=0,o=n.length;r<o;++r)n[r].tagName.toUpperCase()==a&&i.push(n[r]);r=o=null}else i=Array.prototype.slice.call(n);n=null}else{for(var s=geByTag(a,t),d=new RegExp("(^|\\s)"+e+"(\\s|$)"),r=0,o=s.length;r<o;++r)d.test(s[r].className)&&i.push(s[r]);s=d=r=o=0}return i}function geByClass1(e,t,a){return t=t||document,a=a||"*",!browser.msie8&&t.querySelector&&t.querySelector(a+"."+e)||geByClass(e,t,a)[0]}function ce(e,t,a){var i=document.createElement(e);return t&&extend(i,t),a&&setStyle(i,a),i}function re(e){return e=ge(e),e&&e.parentNode&&e.parentNode.removeChild(e),e}function se(e){var t=document.createElement("div");return t.innerHTML=e,t.firstChild}function rs(e,t){return each(t,function(t,a){e=e.replace(new RegExp("%"+t+"%","g"),a)}),e}function insertBefore(e,t){e.parentNode.insertBefore(t,e)}function insertAfter(e,t){e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t)}function domEL(e,t){for(t=t?"previousSibling":"nextSibling";e&&!e.tagName;)e=e[t];return e}function domNS(e){return domEL((e||{}).nextSibling)}function domPS(e){return domEL((e||{}).previousSibling,1)}function domFC(e){return domEL((e||{}).firstChild)}function domLC(e){return domEL((e||{}).lastChild,1)}function domPN(e){return(e||{}).parentNode}function show(e){if(arguments.length>1){for(var t=0;t<arguments.length;++t)show(arguments[t]);t=null}else{if("string"==typeof e&&(e=ge(e)),!e||!e.style)return;if("none"==getStyle(e,"display")){var a=e.olddisplay,i="block",n=e.tagName.toLowerCase();e.style.display=a||"",i=hasClass(e,"inline")?"inline":"tr"!=n||browser.msie()?"table"!=n||browser.msie()?"block":"table":"table-row",e.style.display=e.olddisplay=i,a=i=n=null}}}function hide(e){if(arguments.length>1){for(var t=0;t<arguments.length;++t)hide(arguments[t]);t=null}else{if("string"==typeof e&&(e=ge(e)),!e||!e.style)return;var a=getStyle(e,"display");"none"!=a&&(e.olddisplay=a,e.style.display="none"),a=null}}function isVisible(e){return e=ge(e),!(!e||!e.style)&&"none"!=getStyle(e,"display")}function toggle(e){isVisible(e)?hide(e):show(e)}function isFunction(e){return"[object Function]"===Object.prototype.toString.call(e)}function isArray(e){return"[object Array]"===Object.prototype.toString.call(e)}function intval(e){return e===!0?1:parseInt(e)||0}function floatval(e){return e===!0?1:parseFloat(e)||0}function each(e,t){var a,i=0,n=e.length;if(void 0===n){for(a in e)if(t.call(e[a],a,e[a])===!1)break}else for(var r=e[0];i<n&&t.call(r,i,r)!==!1;r=e[++i]);return e}function extend(){var e,t=arguments,a=t[0]||{},i=1,n=t.length,r=!1;for("boolean"==typeof a&&(r=a,a=t[1]||{},i=2),"object"==typeof a||isFunction(a)||(a={});i<n;++i)if(null!=(e=t[i]))for(var o in e){var s=a[o],d=e[o];a!==d&&(r&&d&&"object"==typeof d&&!d.nodeType?a[o]=extend(r,s||(null!=d.length?[]:{}),d):void 0!==d&&(a[o]=d))}return a}function hasClass(e,t){return e=ge(e),e&&new RegExp("(\\s|^)"+t+"(\\s|$)").test(e.className)}function hotKeysIsAllowed(){return!hasClass(document.documentElement,"wind_opened")}function addClass(e,t){if(isArray(e)){for(var a in e)addClass(e[a],t);return void(a=null)}"string"==typeof e&&(e=ge(e)),e.className||(e.className=""),hasClass(e,t)||(e.className=(e.className?e.className+" ":"")+t)}function removeClass(e,t){if(isArray(e)){for(var a in e)removeClass(e[a],t);return void(a=null)}"string"==typeof e&&(e=ge(e)),e&&(e.className=trim((e.className||"").replace(new RegExp("(\\s|^)"+t+"(\\s|$)")," ")))}function toggleClass(e,t,a){return"undefined"==typeof a&&(a=!hasClass(e,t)),window[a?"addClass":"removeClass"](e,t)}function closest(e,t){if(!e)return null;for(var a=e,i=0;;){if(!a.parentNode)return null;if(a=a.parentNode,!a||"body"===a.nodeName.toLowerCase()||++i>100){a=null;break}if(hasClass(a,t))break}return i=null,a}function getStyle(e,t,a){if(e=ge(e),isArray(t)){var i={};return each(t,function(t,a){i[a]=getStyle(e,a)}),i}if(void 0===a&&(a=!0),!a&&"opacity"==t&&browser.msie){var n=e.style.filter;return n?n.indexOf("opacity=")>=0?parseFloat(n.match(/opacity=([^)]*)/)[1])/100+"":"1":""}if(!a&&e.style&&(e.style[t]||"height"==t))return e.style[t];var r,o=document.defaultView||window;if(o.getComputedStyle){t=t.replace(/([A-Z])/g,"-$1").toLowerCase();var s=o.getComputedStyle(e,null);s&&(r=s.getPropertyValue(t))}else if(e.currentStyle){if("opacity"==t&&browser.msie){var n=e.currentStyle.filter;return n&&n.indexOf("opacity=")>=0?parseFloat(n.match(/opacity=([^)]*)/)[1])/100+"":"1"}var d=t.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()});if(r=e.currentStyle[t]||e.currentStyle[d],"auto"==r&&(r=0),!/^\d+(px)?$/i.test(r)&&/^\d/.test(r)){var l=e.style,c=l.left,p=e.runtimeStyle.left;e.runtimeStyle.left=e.currentStyle.left,l.left=r||0,r=l.pixelLeft+"px",l.left=c,e.runtimeStyle.left=p}}if(a&&("width"==t||"height"==t)){var u=getSize(e,!0)[{width:0,height:1}[t]];r=(intval(r)?Math.max(floatval(r),u):u)+"px"}return r}function setStyle(e,t,a){if(e=ge(e)){if("object"==typeof t)return each(t,function(t,a){setStyle(e,t,a)});if("opacity"==t)browser.msie&&((a+"").length?1!==a?e.style.filter="alpha(opacity="+100*a+")":e.style.filter="":e.style.cssText=e.style.cssText.replace(/filter\s*:[^;]*/gi,""),e.style.zoom=1),e.style.opacity=a;else{var i="number"==typeof a;i&&/height|width/i.test(t)&&(a=Math.abs(a)),e.style[t]=i&&!/z-?index|font-?weight|opacity|zoom|line-?height/i.test(t)?a+"px":a}}}function attr(e,t,a){if(e&&3!==e.nodeType&&8!==e.nodeType&&2!==e.nodeType){if("undefined"==typeof a){if("undefined"==typeof e.getAttribute)throw"elem has no getAttribute";return e.getAttribute(t)}if(null!==a){try{e.setAttribute(t,a+"")}catch(t){try{e.name=a+""}catch(e){}}return a}e.removeAttribute(t)}}function getWindowSize(){return{width:window.innerWidth||document.documentElement.clientWidth||document.getElementsByTagName("body")[0].clientWidth,height:window.innerHeight||document.documentElement.clientHeight||document.getElementsByTagName("body")[0].clientHeight}}function rnd(){return window.rnd_seed=(9301*window.rnd_seed+49297)%233280,window.rnd_seed/233280}function random(e){return Math.ceil(rnd()*e)}function irand(e,t){return Math.floor(rand(e,t))}function consoleDbg(e){window.dbgMode&&window.console&&console.log(e)}function cwarn(){if(window.dbgMode&&window.console){var e=Array.prototype.slice.call(arguments);console.warn.apply(window,e)}}function getRandomInt(e,t){return Math.floor(Math.random()*(t-e+1))+e}function genPass(e,t){e=e||7,t=t||"qwertyuiopasdfghjklzxcvbnm0123456789";for(var a=t.length,i="",n=0;n<e;n++){for(;;){var r=t[getRandomInt(0,a-1)];if(i.substr(-1,1)!=r)break}i+=r}return i}function isset(e){return"undefined"!=typeof e}function extendClass(e,t){e.prototype=new t,e.prototype.constructor=e}function htmlentities(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function htmlspecialchars(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function htmlspecialchars_decode(e,t){var a=0,i=0,n=!1;"undefined"==typeof t&&(t=2),e=e.toString().replace(/&lt;/g,"<").replace(/&gt;/g,">");var r={ENT_NOQUOTES:0,ENT_HTML_QUOTE_SINGLE:1,ENT_HTML_QUOTE_DOUBLE:2,ENT_COMPAT:2,ENT_QUOTES:3,ENT_IGNORE:4};if(0===t&&(n=!0),"number"!=typeof t){for(t=[].concat(t),i=0;i<t.length;i++)0===r[t[i]]?n=!0:r[t[i]]&&(a|=r[t[i]]);t=a}return t&r.ENT_HTML_QUOTE_SINGLE&&(e=e.replace(/&#0*39;/g,"'")),n||(e=e.replace(/&quot;/g,'"')),e=e.replace(/&amp;/g,"&")}function setcookie(e,t,a,i,n,r){document.cookie=e+"="+escape(t)+(a?"; expires="+new Date(a):"")+(i?"; path="+i:"")+(n?"; domain="+n:"")+(r?"; secure":"")}function _initCookies(){window._cookies={};for(var e=document.cookie.split(";"),t=0,a="",i="",n=0,r=e.length;n<r;n++)t=e[n].indexOf("="),t>0&&(a=e[n].substr(0,t),i=e[n].substr(t+1),window._cookies[trim(a)]=unescape(trim(i)))}function getCookie(e){return _initCookies(),window._cookies[e]}function setCookie(e,t,a,i){var n="";if(a){var r=new Date;r.setTime(r.getTime()+24*a*60*60*1e3),n="; expires="+r.toGMTString()}document.cookie=e+"="+escape(t)+n+"; path=/"+(window.baseDomain?"; domain=."+window.baseDomain:"")+(i&&window.isHttps?"; secure":"")}function clone(e){if(null==e||"object"!=typeof e)return e;if(e instanceof Date){var t=new Date;return t.setTime(e.getTime()),t}if(e instanceof Array){for(var t=[],a=0,i=e.length;a<i;a++)t[a]=clone(e[a]);return t}if(e instanceof Object){var t={};for(var n in e)e.hasOwnProperty(n)&&e[n]!==document&&(t[n]=clone(e[n]));return t}throw new Error("Unable to copy obj! Its type isn't supported.")}function generateUUID(){var e=(new Date).getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var a=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?a:7&a|8).toString(16)});return t}function fileUploaded(e){isset(e.type)&&FE.run("file_uploaded_"+e.type,e)}function fileUploadFail(e){isset(e.type)&&FE.run("file_upload_fail_"+e.type,e)}function makeBtnDisabled(e,t){return"undefined"==typeof $(e).data("clicked")&&(t=t||"Загружается...",$(e).val(t).text(t).addClass("disabled").data("clicked",!0),!0)}function toggleDropdown(e){$(".dropdown_part:visible").hide();var t=$(e).closest(".inp_wrap"),a=t.children(".dropdown_part");a.css({width:t.width()}),a.removeClass("dropped_down dropped_up"),t.offset().top+t.outerHeight()+a.outerHeight()<$(window).height()?(a.css({top:t.outerHeight()-1}),a.addClass("dropped_down")):(a.css({top:-a.outerHeight()}),a.addClass("dropped_up")),a.show()}function initDropdown(){window.curDropDown=null;var e=$("html");e.click(function(){$(".dropdown_part:visible").hide()}),e.find(".dropdown_part").click(function(e){$(this).is(":visible")&&e.stopPropagation()}),e.find(".joined").click(function(e){$(this).closest(".sel_wrap").find(".dropdown_part").is(":visible")&&e.stopPropagation()})}function setStateCookie(e,t){"function"==typeof $.cookie&&($.removeCookie(e),$.cookie(e,t,{expires:360,path:"/"}))}function ColorLuminance(e,t){e=String(e).replace(/[^0-9a-f]/gi,""),e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),t=t||0;var a,i,n="#";for(i=0;i<3;i++)a=parseInt(e.substr(2*i,2),16),a=Math.round(Math.min(Math.max(0,a+a*t),255)).toString(16),n+=("00"+a).substr(a.length);return n}function convertToHex(e){var t={hex:null,opacity:1};if(/(^#?[0-9A-F]{6}$)|(^#?[0-9A-F]{3}$)/i.test(e))t.hex="#"+e.replace("#","");else{var a=e.match(/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(.+)\)$/);if(a)t.hex="#"+("0"+parseInt(a[1],10).toString(16)).slice(-2)+("0"+parseInt(a[2],10).toString(16)).slice(-2)+("0"+parseInt(a[3],10).toString(16)).slice(-2),t.opacity=parseFloat(a[4]);else if("transparent"==e)t.opacity=0;else{var i=rgb2hex(e);null!=i&&(t.hex=i)}}return(null==t.opacity||isNaN(t.opacity))&&(t.opacity=1),t}function rgb2hex(e){return e?(e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),e?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):null):null}function hex2rgb(e){var t=parseInt(e.indexOf("#")>-1?e.substring(1):e,16),a=t>>16,i=(65280&t)>>8,n=255&t;return[a,i,n]}function rgba2parts(e){var t,a,i="#FFFFFF",n=1;return null!=e&&(a=e.match(/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(.+)\)$/),a?(i="#"+("0"+parseInt(a[1],10).toString(16)).slice(-2)+("0"+parseInt(a[2],10).toString(16)).slice(-2)+("0"+parseInt(a[3],10).toString(16)).slice(-2),n=parseFloat(a[4]),(null==n||isNaN(n))&&(n=1)):"transparent"==e?n=0:(t=rgb2hex(e),null!=t&&(i=t))),{color:i,opacity:n}}function escapeRus(e){var t=[];e+="";for(var a=1040;a<=1103;a++)t[a]=a-848;t[1025]=168,t[1105]=184;var i=[];for(a=0;a<e.length;a++){var n=e.charCodeAt(a);"undefined"!=typeof t[n]&&(n=t[n]),n<=255&&(i[a]=escape(String.fromCharCode(n))),8470==n&&(i[a]="%B9"),43==n&&(i[a]="%2B")}return i.join("")}function getUrlVars(){var e=window.location.href.slice(window.location.href.indexOf("?")+1);if(""==e||window.baseUrl==e)return e=null,{};for(var t,a={},i=e.split("&"),n=0;n<i.length;n++)t=i[n].split("="),a[t[0]]=t[1];return t=i=e=null,a}function jAlert(e,t){t=$.extend({id:"jAlert",html:!0,showCloseBtn:!1,width:!1,okText:!1,btnCls:"ibtn-blue",btnWidth:100,onOk:function(){},headerText:!1,hideOnBlackoutClick:!1,alertClass:"",mobileAdapt:!1},t);var a=$("#"+t.id);if(a.length){if(a.attr("class",a.attr("class").replace(/^custom-/g,"")),t.alertClass.length)for(var i=t.alertClass.split(/\s+/g),n=0,r=i.length;n<r;n++)a.addClass("custom-"+i[n]);!1!==t.headerText?a.find(".iblk_header").show().find(".h5-fake").text(t.headerText):a.find(".iblk_header").hide(),a.find(".wind-btn-apply").text(t.okText||"OK").attr("class","btn wind-btn-apply "+t.btnCls).css("width",t.btnWidth),a.find("#jAlertBody")[!0===t.html?"html":"text"](e),a.wind("setApplyFunc",function(){t.onOk()}),t.onCancel&&"function"==typeof t.onCancel&&(a.wind("setCancelFunc",t.onCancel),a.wind("setCloseFunc",t.onCancel)),t.hideOnBlackoutClick&&a.on("click",function(){return!1}),!1!==t.width&&a.css({width:t.width}),t.mobileAdapt&&quizMobileView.adaptWind(a),a.wind("show")}a=null}function jConfirm(e,t,a){t=$.extend({width:500,html:!0,okText:"OK",cancelText:"Отмена",btnWidth:94,okClass:"ibtn-green",cancelClass:"",onOk:function(){},onCancel:function(){},headerText:!1,showClose:!0},t);var i;i=a===!0?$("#"+t.id):$("#jConfirm"),i.length&&(!1!==t.headerText?i.find(".iblk_header").show().find(".h5-fake").text(t.headerText):i.find(".iblk_header").hide(),!0===t.html?i.find("#jConfirmBody").html(e):i.find("#jConfirmBody").text(e),i.find("#jConfirmOk").attr("class","ibtn wind-btn-apply "+t.okClass).text(t.okText).css("min-width",t.btnOkWidth||t.btnWidth),i.find("#jConfirmCancel").attr("class","ibtn wind-btn-cancel ml1 "+t.cancelClass).text(t.cancelText).css("min-width",t.btnCancelWidth||t.btnWidth),i.find(".wind-close")[t.showClose?"show":"hide"](),i.css({width:t.width}),i.wind("setApplyFunc",t.onOk),i.wind("setCancelFunc",t.onCancel),t.onClose&&"function"==typeof t.onClose?i.wind("setCloseFunc",t.onClose):i.wind("setCloseFunc",t.onCancel),i.wind("show")),i=null}function showDoneBox(e,t){var a=$('<div class="pp_mes_wrap"><div class="pp_mes">'+e+"</div></div>");t=$.extend({width:380,top:"40%",fadeIn:100,showTime:2e3,fadeOut:500,cls:"",el:a},t),a.css({width:t.width,"margin-left":-1*Math.round(t.width/2),top:t.top,opacity:0}),t.cls.length&&a.addClass(t.cls),a.appendTo($("body")),a.animate({opacity:1},t.fadeIn,function(){setTimeout(function(){t.el.animate({opacity:0},t.fadeOut,function(){$(this).remove()})},t.showTime)}),a=null}function goTo(e){window.location.href=window.baseUrl+e}function getUrl(){return window.location.href.replace(window.baseUrl,"")}function if_var_val(e,t,a){for(var i in t)if(e==i)return i=null,t[i];return i=null,a||!1}function plural(e,t,a,i){if(e<0&&(e=-1*e),"undefined"==typeof i)return 1==e?t:a;var n=e%10,r=e%100;return 1==e||1==n&&11!=r?(n=r=null,t):n>1&&n<5&&12!=r&&13!=r&&14!=r?(n=r=null,a):(n=r=null,i)}function strtr(e,t){for(var a in t)e=e.replace(new RegExp(a,"g"),t[a]);return a=null,e}function number_format(e,t,a,i){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var n=isFinite(+e)?+e:0,r=isFinite(+t)?Math.abs(t):0,o="undefined"==typeof i?" ":i,s="undefined"==typeof a?".":a,d="",l=function(e,t){var a=Math.pow(10,t);return""+Math.round(e*a)/a};return d=(r?l(n,r):""+Math.round(n)).split("."),d[0].length>3&&(d[0]=d[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,o)),(d[1]||"").length<r&&(d[1]=d[1]||"",d[1]+=new Array(r-d[1].length+1).join("0")),d.join(s)}function formatFileSize(e,t){if(0==e)return"0 байт";"undefined"==typeof t&&(t=0);var a=t+1||3,i=["байт","KB","MB","GB","TB","PB","EB","ZB","YB"],n=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,n)).toFixed(a))+" "+i[n]}function reachGoal(e){if("undefined"!=typeof window.Ya){var t;if("undefined"!=typeof Ya.Metrika2)t=Ya.Metrika2.counters();else{if("undefined"==typeof Ya.Metrika)return void slackErrorDump(new Error("Error #4911"));t=Ya.Metrika.counters()}for(var a in t)window["yaCounter"+t[a].id]?(window["yaCounter"+t[a].id].reachGoal(e),consoleDbg("reachGoal "+e)):consoleDbg("notFound yaCounter"+t[a].id);t=a=null}}function reachGoalByAttr(e,t){var a=e.attr(t);"undefined"!=typeof a&&a.length&&reachGoal(a),a=null}function popoverForm(e){try{var t=$(e),a=t.closest(".blk"),i=t.closest(".blk_form_wrap"),n=$("#formPopover"),r=n.children(".wind-body");if(r.children("form").hide(),i.hasClass("is_popover")){var o=i.children("form.user_form"),s=t.parent().hasClass("quiz-form");if(o.length?o.appendTo(n).addClass("is_popover"):o=n.children("form[id=frm"+a.attr("id")+"]"),o.length){var d=getIosVersion();if(d&&11===d[0]&&d[1]<3){var l=0;n.wind("setCloseFunc",function(){$("body").removeClass("ios-11-fix"),$(window).scrollTop(l)}),l=$(window).scrollTop(),$("body").addClass("ios-11-fix").css("top",-l)}}s?(n.addClass("quiz-form").parent().css("overflow-y","auto"),quizMobileView.toQuizView(o)):n.removeClass("quiz-form").parent().removeAttr("style");var c=n.find(".user_form_regulation");1===c.data("is-regulation-enabled")&&c.addClass("hidden"),o.length&&(reachGoalByAttr(o,"goal-popover"),n.children().hide(),o.show(),n.wind("show"),s&&(quizMobileView.getSmartHeader().recalcHeaderHeight(),sitesMan.adaptQuizContent(sitesMan.quizForm(n))))}}catch(e){consoleDbg(e)}return!1}function initSlick(e){var t=e.find(".slider:first"),a=e.closest(".blk_box_slider");if(a.find(".slide").removeClass("hidden-slide"),t.hasClass("slick-initialized"))return t.slick("unslick"),void t.slick(adapterManager.slickOpt[a.attr("id")]);var i=e.children(".settings-slick:first"),n={touchMove:!1,infinite:!0,speed:parseInt(i.attr("slide-aspeed"))||300,dots:1===parseInt(i.attr("slide-circle")),customPaging:function(){return"<p>&nbsp;</p>"},arrows:1===parseInt(i.attr("slide-arrow")),nextArrow:'<div class="next-slide"><div></div></div>',prevArrow:'<div class="prev-slide"><div></div></div>',slidesToShow:1};1===parseInt(i.attr("slide-auto"))&&1!=i.attr("in-af")&&(n.autoplay=!0,n.autoplaySpeed=1e3*parseFloat(i.attr("slide-pspeed"))||2e3),"crossfade"==i.attr("slide-anim")&&(n.fade=!0,n.cssEase="linear"),t.slick(n),window.animManager.onScroll(),window.adapterManager.slickOpt[a.attr("id")]=n}function hideSectionPopup(e){var t=$("#popup_list > #"+e),a=/\?af_popup/i.test(window.location.href);if(a)return!1;if(t.removeClass("open"),!window._isEditor){var i=".blk.blk_video .video.autoplay iframe";window.speedUpVideoLoadIsEnabled&&(i+=", .blk_video.video--play iframe"),t.find(i).each(function(){window.stopAutoPlayVideo($(this))})}reInitVideoIFrame(t),window.active_fixed_sections&&$.each(window.active_fixed_sections,function(){$(this).css({"z-index":999})}),$("body").css("margin-right",0).removeClass("open_popup"),$("body>.navbar>.navbar-inner").css("padding-right",0),FE.run("sectionPopup_hide")}function clickButtonLink(e,t,a){insertJavaScript(e,t,function(){var e=$(a);e.attr("href")&&("_blank"==e.attr("target")?window.open(e.attr("href")):window.location.href=e.attr("href"))})}function insertJavaScript(e,t,a){if(!e||!t)return void("function"==typeof a&&a());var i=document.getElementById(t);return i?void("function"==typeof a&&a()):(i=document.createElement("script"),i.type="text/javascript",i.src=e,i.id=t,"function"==typeof a&&(i.onload=a),void document.getElementsByTagName("body")[0].appendChild(i))}function btnPopupWnd(e){var t=$(e).closest(".blk"),a=t.attr("id"),i=$("#btnPopupWnd"),n=i.attr("cur-blk"),r=t.find(".wnd_data:first");if("undefined"==typeof n||n!=a){var o=parseInt(r.attr("wnd_width"))||600;"undefined"==typeof adapterManager||adapterManager.isPC()||(o=adapterManager.getSettings(adapterManager.type).window_popover_width),i.width(o),i.find(".wind-header h3, .wind-header .div_h3").text(r.find(".wnd_data_title").text()),i.find(".wind-body").html(r.find(".wnd_data_text").html()),i.attr("cur-blk",a),consoleDbg("btnPopupWnd: move content")}i.wind("show"),i=null}function showExpiredWind(e){var t=$("#sessionExpired form#frmlogin");t.find("#frmlogin__magic").val(e),$("#sessionExpired").wind("show").find("#frmlogin__username").focus()}function ExpiredWindbeforeSend(){var e=$("#sessionExpired #frmlogin__password"),t=$("#sessionExpired #frmlogin__magic");e.val($.sha1($.sha1(e.val())+t.val())),e=t=null}function truncate(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function arrayRemoveByName(e,t){var a=e.indexOf(t),i=!1;return-1!=a&&(e=e.splice(a,1),i=!0),a=null,i}function arrayInsertBeforeItem(e,t,a){var i=e.indexOf(t),n=!1;return-1!=i&&(e.splice(i,0,a),n=!0),i=null,n}function arrayInsertAfterItem(e,t,a){var i=e.indexOf(t),n=!1;return-1!=i&&(i==e.length-1?e.push(a):e.splice(i+1,0,a),n=!0),i=null,n}function arrayInsertItemUniq(e,t){-1==e.indexOf(t)&&e.push(t)}function arrayMoveItemBefore(e,t,a){return!(!arrayRemoveByName(e,t)||!arrayInsertBeforeItem(e,a,t))}function arrayMoveItemAfter(e,t,a){return!(!arrayRemoveByName(e,t)||!arrayInsertAfterItem(e,a,t))}function arraySubset(e,t,a){var i=e.indexOf(t),n=e.indexOf(a),r=[];return-1!=i&&-1!=n&&(i>n&&(i+=n,n=i-n,i-=n),r=e.slice(i,n+1)),i=n=null,r}function guid(){return uuid.v4().replace(/-/g,"")}function ajaxLoad(ops){var o={type:"POST",ops:ops,cache:!1,timeout:4e4,url:window.baseUrl+ops.url,dataType:"json",data:ops.data?ops.data:null,beforeSend:function(e,t){this.ops.onBeforeSend&&"function"==typeof this.ops.onBeforeSend&&this.ops.onBeforeSend(this.ops)},success:function(data){if(!this.ops.onBeforeSuccess||"function"!=typeof this.ops.onBeforeSuccess||this.ops.onBeforeSuccess(data,this.ops)){if(isset(data.error)&&("object"==typeof data.error.name?alert(data.error.name):alert(data.error)),data.html&&this.ops.block&&$(this.ops.block).html(data.html),isset(data.script))try{eval(data.script)}catch(e){window.console&&window.dbgMode&&(console.log(e),console.log("[_Ошибка JS_] "+e.stack),alert("Смотри ошибку в консоли"))}this.ops.onSuccess&&"function"==typeof this.ops.onSuccess&&this.ops.onSuccess(data,this.ops),window.dbgMode&&console.log(data)}},error:function(e,t,a){switch(console.log(t),t){case"timeout":alert("Ошибка! Нет связи с сервером. Проверьте подключение к интернету и попробуйте снова.");break;case"error":case"parsererror":null!=window.error_catcher&&error_catcher.send_error(a,"#5408",{url:ops.url,data:ops.data?ops.data:null,response:e.responseText}),alert("Извините, на сервере возникла ошибка!\n\nПожалуйста, напишите нам в тех-поддержку support@lpmotor.ru"),window.dbgMode&&(console.log(e),console.log(a))}}};return beforeQueryAjax(o,ops),$.ajax(o)}function beforeQueryAjax(e,t){var a=getCsrfHeaderName(),i=getCsrfCookieName(),n=getCookie(i);n&&(e.headers||(e.headers={}),e.headers[a]=n,t.withCredentials=!0),t.withCredentials&&(e.xhrFields={withCredentials:!0},delete t.withCredentials)}function getCsrfHeaderName(){return"X-Csrf-Token"}function getCsrfCookieName(){return"csrf_token"}function getAxios(e){if(!axios)return consoleDbg("axios is undefined"),{request:function(e){},get:function(e,t){},delete:function(e,t){},head:function(e,t){},options:function(e,t){},post:function(e,t,a){},put:function(e,t,a){},patch:function(e,t,a){}};e||(e={}),e.headers||(e.headers={}),e.headers["X-Requested-With"]="XMLHttpRequest",e.xsrfHeaderName=getCsrfHeaderName(),e.xsrfCookieName=getCsrfCookieName();var t=getCookie(e.xsrfCookieName);return t&&(e.headers[e.xsrfHeaderName]=t,e.withCredentials=!0),axios.create(e)}function scrollTop(){return document.body.scrollTop||document.documentElement.scrollTop}function cancelEvent(e){if(e=e||window.e,!e)return!1;for(;e.originalEvent;)e=e.originalEvent;return e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0,e.returnValue=!1,!1}function initTabs(e,t){if(t=extend({itemTag:"a",tabsClass:"itab",activeClass:"active",tabsContainer:null},t),"string"==typeof e&&(e=$(e)),e.length&&!e.hasClass("itabs-inited")){var a=e.children(t.itemTag);a.length&&(a.click({ops:t},function(e){var a=$(this),i="."+t.tabsClass+"[id="+a.attr("itab-id")+"]",n=null;null===t.tabsContainer?n=$(i):("string"==typeof t.tabsContainer&&(t.tabsContainer=$(t.tabsContainer)),t.tabsContainer.length&&(n=t.tabsContainer.children(i))),n.length&&(n.parent().children("."+t.tabsClass+"."+t.activeClass).removeClass(t.activeClass),n.addClass(t.activeClass),a.parent().children(t.itemTag+"."+t.activeClass).removeClass(t.activeClass),a.addClass(t.activeClass)),e.preventDefault(),e.stopPropagation(),a=n=i=null}),e.addClass("itabs-inited")),a=null}}function helpSlider(e,t){var a="string"==typeof e?$(e):e;if(a.length){a.addClass("help-slider-inited"),a.find(".prev_slide, .next_slide").click(function(){helpSliderRoll($(this).closest(".help-slider-inited"),$(this).hasClass("next_slide")?"next":"prev")});var i=a.find(".slides_container");i.css({overflow:"hidden",position:"relative"}),i.children().css({cursor:"pointer"}).click(function(){helpSliderRoll($(this).closest(".help-slider-inited"),"next")})}a=null}function helpSliderRoll(e,t){var a=e.find(".slides_container"),i=a.children(),n=i.filter(":visible"),r=null,o=null,s=n.height();if(!n.is(":animated"))if(a.css({height:s}),n.css({position:"absolute",top:0,left:0}),"prev"===t){if(r=n.prev(),!r.length)return;o=r.width(),r.css({position:"absolute",opacity:1,left:-o}).show(),n.animate({left:o,opacity:.5},400,function(){$(this).hide()}),r.animate({left:0},400,function(){$(this).css({position:"static"})}),0==r.prev().length&&r.closest(".help-slider-inited").find(".prev_slide").hide(),r.closest(".help-slider-inited").find(".next_slide").show()}else if("next"===t){if(r=n.next(),!r.length)return;o=r.width(),r.css({position:"absolute",opacity:1,left:o}).show(),n.animate({left:-o,opacity:.5},400,function(){$(this).hide()}),r.animate({left:0},400,function(){$(this).css({position:"static"})}),0==r.next().length&&r.closest(".help-slider-inited").find(".next_slide").hide(),r.closest(".help-slider-inited").find(".prev_slide").show()}a=i=n=r=o=s=null}function initImgSlider(e){return e=extend({obj:null,editorMode:!0,showBalls:!1,delayBeforeChange:2e3,changeOnClick:!1,changeSpeed:1e3,changeType:"slide",pauseOnHover:!0},e),null===e.obj?0:"string"!=typeof e.obj||(e.obj=$(e.obj),e.obj.length)?(e._animating=!1,e.$slider=e.obj.find(".slider_images:first"),e.$ar_L=e.$slider.find(".arrow_left:first"),e.$ar_R=e.$slider.find(".arrow_right:first"),e.$balls=e.$slider.find(".balls:first"),e.$imgs=e.$slider.find(".imgs:first"),e.$resizer=e.$slider.find(".imgslider_resizer:first"),window.imgSlider?++window.imgSlider.cnt:window.imgSlider={cnt:1,collection:{}},window.imgSlider.collection[window.imgSlider.cnt]=e,e._cnt=window.imgSlider.cnt,e.$slider.attr("slider",window.imgSlider.cnt),e.showBalls&&e.$balls.show(),e.$ar_L.click(function(){imgSliderChange(parseInt($(this).closest(".slider_images").attr("slider")),"prev")}),e.$ar_R.click(function(){imgSliderChange(parseInt($(this).closest(".slider_images").attr("slider")),"next")}),e.pauseOnHover&&e.$slider.find(".arrow,.imgs:first").mouseover(function(){imgSliderKillTimer($(this).closest(".slider_images").addClass("over_slide").attr("slider"))}).mouseout(function(){imgSliderSetTimer($(this).closest(".slider_images").removeClass("over_slide").attr("slider"))}),e.editorMode?(e.delayBeforeChange=0,e.$resizer.show(),$(document).mousedown(function(e){$(e.target).hasClass("imgslider_resizer")&&(window.imgSliderResize=!0,window.imgSliderResizeTop=e.pageY,window.imgSliderResizeH=$())}),$(document).mousemove(function(e){window.imgSliderResize&&console.log("move ",e.pageY-window.imgSliderResizeTop)}),$(document).mouseup(function(e){window.imgSliderResize&&(window.imgSliderResize=!1,console.log("stop ",e.pageY-window.imgSliderResizeTop),window.imgSliderResizeTop=null)})):imgSliderSetTimer(e),"ok"):1}function imgSliderSetTimer(e){if("string"==typeof e){if(e=parseInt(e),!window.imgSlider.collection[e])return;e=window.imgSlider.collection[e]}e.delayBeforeChange&&(e._timer&&clearTimeout(e._timer),e._timer=setTimeout("imgSliderChange("+e._cnt+",'next');",e.delayBeforeChange))}function imgSliderKillTimer(e){if("string"==typeof e){if(e=parseInt(e),!window.imgSlider.collection[e])return;e=window.imgSlider.collection[e]}e._timer&&clearTimeout(e._timer),e._timer="off"}function imgSliderChange(e,t){console.log("run slider animation. id=",e,", direction=",t);var a=window.imgSlider.collection[e];if(!a._animating){switch(a.changeType){case"slide":a._animating=!0;var i=a.$imgs.children("a:visible"),n=null,r=a.$imgs.width();"next"==t?(n=i.next(),n.length||(n=a.$imgs.children("a:first")),n.css({left:r}).show(),i.animate({left:-r},a.changeSpeed,function(){$(this).hide(),window.imgSlider.collection[e]._animating=!1}),n.animate({left:0},a.changeSpeed)):"prev"==t&&(n=i.prev(),n.length||(n=a.$imgs.children("a:last")),n.css({left:-r}).show(),i.animate({left:r},a.changeSpeed,function(){$(this).hide(),window.imgSlider.collection[e]._animating=!1}),n.animate({left:0},a.changeSpeed)),i=n=r=null}a.$slider.hasClass("over_slide")||imgSliderSetTimer(a)}a=null}function enlargeImage(e){function t(e){var t=$('<div class="svg_wrap"><div class="svg_container"></div> </div>');return t.find(".svg_container").append(e),t}function a(e){_eh.origSize={w:$(this).get(0).naturalWidth,h:$(this).get(0).naturalHeight},"svg"===i?_eh.$newImg=t(e.firstElementChild):_eh.$newImg=$(this),_eh.wndSize={w:_eh.$wnd.width()-2*_eh.step,h:_eh.$wnd.height()-2*_eh.step},_eh.newSize={w:0,h:0,x:0,y:0},_eh.origSize.w>_eh.wndSize.w&&_eh.origSize.h>_eh.wndSize.h&&(_eh.origSize.h=_eh.wndSize.w*_eh.origSize.h/_eh.origSize.w,_eh.origSize.w=_eh.wndSize.w),_eh.origSize.w<=_eh.wndSize.w&&_eh.origSize.h<=_eh.wndSize.h?(_eh.newSize.w=_eh.origSize.w,_eh.newSize.h=_eh.origSize.h,_eh.newSize.x=Math.floor((_eh.wndSize.w-_eh.origSize.w)/2)+_eh.step,_eh.newSize.y=Math.floor((_eh.wndSize.h-_eh.origSize.h)/2)+_eh.step):_eh.origSize.w>_eh.wndSize.w&&_eh.origSize.h<=_eh.wndSize.h?(_eh.newSize.w=_eh.wndSize.w,_eh.newSize.h=Math.floor(_eh.newSize.w*_eh.origSize.h/_eh.origSize.w),_eh.newSize.x=_eh.step,_eh.newSize.y=Math.floor((_eh.wndSize.h-_eh.newSize.h)/2)+_eh.step):_eh.origSize.w<=_eh.wndSize.w&&_eh.origSize.h>_eh.wndSize.h&&(_eh.newSize.h=_eh.wndSize.h,_eh.newSize.w=Math.floor(_eh.newSize.h*_eh.origSize.w/_eh.origSize.h),
_eh.newSize.x=Math.floor((_eh.wndSize.w-_eh.newSize.w)/2)+_eh.step,_eh.newSize.y=_eh.step),"svg"===i&&(_eh.newSize.w=window.innerHeight,_eh.newSize.h=window.innerHeight,_eh.newSize.x=_eh.wndSize.w/2-window.innerHeight/2,_eh.newSize.y=0),_eh.bodyWidth=_eh.$body.width(),_eh.$container.show(),$("html").addClass("wind_opened"),_eh.$body.css("margin-right",_eh.$body.width()-_eh.bodyWidth);scrollTop();_eh.$newImg.appendTo(_eh.$container).css({position:"absolute",display:"block",top:_eh.curSize.y,left:_eh.curSize.x,width:_eh.curSize.w,height:_eh.curSize.h}).animate({left:_eh.newSize.x,top:_eh.newSize.y,width:_eh.newSize.w,height:_eh.newSize.h},_eh.speed)}var i=$(e).attr("src").split(".").pop();if(_eh.$body||(_eh.$body=$("body")),_eh.$wnd||(_eh.$wnd=$(window)),_eh.$container||(_eh.$container=$('<div id="image-enlarge-cont"></div>'),_eh.$container.appendTo(_eh.$body),_eh.$container.click(function(){_eh.$newImg&&_eh.$newImg.animate({top:_eh.curSize.y,left:_eh.curSize.x,width:_eh.curSize.w,height:_eh.curSize.h},_eh.speed,function(){_eh.$container.hide(),$("html").removeClass("wind_opened"),_eh.$body.css("margin-right",0),_eh.$newImg.remove(),_eh.$newImg=!1})})),_eh.$img=$(e),_eh.$img.length){var n=_eh.$img.offset();if(_eh.curSize={w:_eh.$img.width(),h:_eh.$img.height(),x:n.left,y:n.top-scrollTop()},n=null,"svg"==i){var r="undefined"!=typeof _eh.$img.attr("original-src")?_eh.$img.attr("original-src"):_eh.$img.attr("src");$.get(r,a)}else{var o=$(new Image);o.unbind("load").bind("load",a),o.attr("src","undefined"!=typeof _eh.$img.attr("original-src")?_eh.$img.attr("original-src"):_eh.$img.attr("src"))}}}function mxSetup(e){!function(e,t){if(!t.__SV){var a,i,n,r;window.mixpanel=t,t._i=[],t.init=function(e,a,i){function o(e,t){var a=t.split(".");2==a.length&&(e=e[a[0]],t=a[1]),e[t]=function(){e.push([t].concat(Array.prototype.slice.call(arguments,0)))}}var s=t;for("undefined"!=typeof i?s=t[i]=[]:i="mixpanel",s.people=s.people||[],s.toString=function(e){var t="mixpanel";return"mixpanel"!==i&&(t+="."+i),e||(t+=" (stub)"),t},s.people.toString=function(){return s.toString(1)+".people (stub)"},n="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.track_charge people.clear_charges people.delete_user".split(" "),r=0;r<n.length;r++)o(s,n[r]);t._i.push([e,a,i])},t.__SV=1.2,a=e.createElement("script"),a.type="text/javascript",a.async=!0,a.src=("https:"===e.location.protocol?"https:":"http:")+"//cdn.mxpnl.com/libs/mixpanel-2.2.min.js",i=e.getElementsByTagName("script")[0],i.parentNode.insertBefore(a,i)}}(document,window.mixpanel||[]),mixpanel.init("14bbe5ece6a7ad1216c5ea30a5194a28"),window.console&&console.log("Mix Panel init"),"undefined"!=typeof e&&(mixpanel.identify(e),window.console&&console.log("Mix Panel identify id="+e))}function mxt(e,t){return"undefined"==typeof window._kmq?void console.log("Kissmetrics track: ",e,", params: ",t):void("undefined"==typeof t?_kmq.push(["record",e]):_kmq.push(["record",e,t]))}function mxGetSourceLink(){var e=window.location.href.replace(window.baseUrl,""),t=null;return t=""==e||"sites/list"==e?"раздел Сайты":"sites/create"==e?"раздел Создание сайта":"profile/balance"==e?"раздел Баланс":e.indexOf("pages/edit")>0?"раздел Редактор сайта":e,e=null,t}function getURLParam(e){return decodeURI((RegExp(e+"=(.+?)(&|$)").exec(location.search)||[,null])[1])}function getURLParam2(e){var t=RegExp(e+"=(.+?)(&|$)").exec(location.search);return null!==t&&"undefined"!=typeof t[1]?t[1]:null}function insertPixel(e){$(document).ready(function(){$("body").append($('<img src="'+e.replace("{order_id}",getURLParam("order_id"))+'" width="1" height="1" style="position: absolute;left:-9999px;"/>'))})}function stVisit(){var e=getCookie("LPmagCode"),t={ref:document.referrer};"undefined"==typeof e?t.new=1:t.id=e,$.ajax({url:window.baseUrl+"stat/visit",data:t,cache:!1,success:function(e){var t=JSON.parse(e);if(console.log(t),"undefined"!=typeof t.res)switch(t.res){case"0":console.log(t.mes);break;case"1":if("undefined"!=typeof t.id)stVisitPropagate(t.id);else{var a=getCookie("_magCode");"undefined"!=typeof a&&stVisitPropagate(a)}}}})}function stVisitPropagate(e){var t,a=["http://s.lpmcdn.com/web/build/pages/lpmotor.ru","http://s.lpmcdn.com/web/build/pages/lpmotor.org","http://s.lpmcdn.com/web/build/pages/bm360.ru","http://s.lpmcdn.com/web/build/pages/admin.lpmotor.ru"];for(var i in a)t=document.createElement("img"),t.className="mag_img",t.src=("https:"==document.location.protocol?"https:":"http:")+"/"+a[i]+"/stat/magcode.png?id="+e,t.onload=function(){this.parentNode.removeChild(this)},document.getElementsByTagName("body")[0].appendChild(t);t=i=a=null}function stLpcidPropagate(){var e=getCookie("_lpcid");if("undefined"!=typeof e){var t,a,i=document.getElementsByTagName("body")[0];for(t in window._lpcid_hosts)window._lpcid_hosts[t].replace(/^http(|s):\/\//,"")!=document.location.host&&(a=new Image,a.className="mag_img",a.onload=stVisImgRemove,a.src=window._lpcid_hosts[t]+"/stat/cid.gif?v="+e+"&t="+ +new Date,i.appendChild(a));t=a=i=null}}function stVisImgRemove(){this.parentNode&&this.parentNode.removeChild(this)}function stVisImgLoaded(){stLpcidPropagate(),this.parentNode&&this.parentNode.removeChild(this)}function stVis(e){"undefined"==typeof e&&(e="landing");var t=new Image,a=getURLParam2("p");t.className="mag_img",t.onload=stVisImgLoaded,t.src=("https:"==document.location.protocol?"https:":"http:")+"//"+document.location.host+"/stat/vis.gif?type="+e+"&ref="+document.referrer+(null===a?"":"&p="+encodeURI(a))+"&t="+ +new Date,document.getElementsByTagName("body")[0].appendChild(t),t=null}function animInit(){}function createFrame(e,t){var a=document.createElement("iframe");a.className="mag_frame",a.src=e+"/tracer/frame/cid:"+t+"?_="+1*new Date,document.body.appendChild(a)}function gaSpread(e){console.log("gaSpread...");var t=getCookie("_ga_cid");if("undefined"!=typeof t)switch(console.log("gaSpread=",e),createFrame("http://admin.lpmotor.ru/",t),e){case"lpmotor":createFrame("http://bm360.ru/",t);break;case"bm360":createFrame("http://lpmotor.ru/",t)}}function analyticSendEvent(e,t){if(!window.carrotquest)return!1;if(t="undefined"==typeof t?{}:t,"undefined"!=typeof t.delay&&t.delay>0)return setTimeout(function(){analyticSendEvent(e,t)},t.delay),delete t.delay,!0;if("undefined"!=typeof t.check_cookie){var a=getCookie(t.check_cookie);if("undefined"==typeof a)return!1;if("undefined"!=typeof t.value_cookie&&t.value_cookie!=a)return!1}if("undefined"!=typeof t.once&&t.once===!0)try{var i=localStorage.getItem("analytic_event");if(i=null==i||"undefined"==typeof i?{}:JSON.parse(i),"undefined"!=typeof i[e])return!1;i[e]=1,localStorage.setItem("analytic_event",JSON.stringify(i))}catch(e){console.log(e)}carrotquest.track(e,t),dbgMode&&console.log("send event [",e,"] ",t)}function funnelEvent(e,t){$.ajax({url:window.baseUrl+"funnel/event",method:"post",dataType:"json",data:{funnel:e,step:t},success:function(a){"undefined"!=typeof a.status&&console.log("funnel:",e,", step:",t,", status:",a.status),"undefined"!=typeof a.exception&&alert("Funnel error\n"+(a.exception.code?"#"+a.exception.code+"\n":"")+a.exception.message)}})}function var_dump(){var e="",t=" ",a=2,i=0,n=0,r=function(e){var t=/\W*function\s+([\w\$]+)\s*\(/.exec(e);return t?t[1]:"(Anonymous)"},o=function(e,t){for(var a="",i=0;i<e;i++)a+=t;return a},s=function(e,t){var a="";if(null===e)a="NULL";else if("boolean"==typeof e)a="bool("+e+")";else if("string"==typeof e)a="string("+e.length+') "'+e+'"';else if("number"==typeof e)a=parseFloat(e)==parseInt(e,10)?"int("+e+")":"float("+e+")";else if("undefined"==typeof e)a="undefined";else if("function"==typeof e)a+="function "+r(e);else if(e instanceof Date)a="Date("+e+")";else if(e instanceof RegExp)a="RegExp("+e+")";else if(e.nodeName)switch(e.nodeType){case 1:a="undefined"==typeof e.namespaceURI||"http://www.w3.org/1999/xhtml"===e.namespaceURI?'HTMLElement("'+e.nodeName+'")':'XML Element("'+e.nodeName+'")';break;case 2:a="ATTRIBUTE_NODE("+e.nodeName+")";break;case 3:a="TEXT_NODE("+e.nodeValue+")";break;case 4:a="CDATA_SECTION_NODE("+e.nodeValue+")";break;case 5:a="ENTITY_REFERENCE_NODE";break;case 6:a="ENTITY_NODE";break;case 7:a="PROCESSING_INSTRUCTION_NODE("+e.nodeName+":"+e.nodeValue+")";break;case 8:a="COMMENT_NODE("+e.nodeValue+")";break;case 9:a="DOCUMENT_NODE";break;case 10:a="DOCUMENT_TYPE_NODE";break;case 11:a="DOCUMENT_FRAGMENT_NODE";break;case 12:a="NOTATION_NODE"}return a},d=function(e,t,a,n){var l="";t>0&&t++;var c=o(a*(t-1),n),p=o(a*(t+1),n),u="",f="";if("object"==typeof e&&null!==e)if(e.jquery)u+=(e.selector?"jQuery('"+e.selector+"')":"[jQuery object]")+"\n";else{if(e.constructor&&"PHPJS_Resource"===r(e.constructor))return e.var_dump();i=0;for(l in e)i++;u+="array("+i+") {\n";for(var h in e){var _=e[h];"object"!=typeof _||null===_||_ instanceof Date||_ instanceof RegExp||_.nodeName?(f=s(_,p),u+=p+"["+h+"] => "+f+"\n"):u+=p+"["+h+"] => "+d(_,t+1,a,n)}u+=c+"}\n"}else u=s(e,p);return u};for(e=d(arguments[0],0,a,t),n=1;n<arguments.length;n++)e+="\n"+d(arguments[n],0,a,t);return e}function lockScreen(e,t){t=extend({show_animation:!1,show_timer:!1,show_btn_close:!1,delay_before:0,css_class:"",hide_bg:!1,v2:!1},t);var a={},i=$('<div class="locker" style="display: none"><div class="locker-background"></div><div class="locker-content"><div class="locker-btn-list"><div class="locker-close-btn"></div></div><div class="locker-animation"></div><div class="locker-text"></div><div class="locker-timer"></div></div></div>');t.v2&&(i=$('<div class="screen-lock"> <div class="screen-lock__loader-wrap"> <div class="screen-lock__loader"></div><div class="screen-lock__text"></div> </div> </div>'),t.bg&&i.find(".screen-lock__loader-wrap").css("background",t.bg)),t.hide_bg&&i.find(".locker-background").hide(),t.css_class.length>0&&i.addClass(t.css_class);var n=generateUUID();if(i.attr("id",n),i.find(".locker-close-btn:first").bind("click",function(){unlockScreen(n)}),"undefined"!=typeof e&&e.length>0&&(t.v2?i.find(".screen-lock__text").text(e):(a["l-show-text"]=!0,i.find(".locker-content .locker-text:first").html(e))),t.show_animation===!0&&(a["l-show-animation"]=!0),t.show_timer===!0&&(a["l-show-timer"]=!0),t.show_btn_close===!0&&(a["l-show-btn-close"]=!0),Object.keys(a).length>0&&(a["l-show-content"]=!0,i.addClass(Object.keys(a).join(" "))),$("body").append(i),t.delay_before>0){var r=setTimeout(function(){i.show()},t.delay_before);i.attr("timeout_id",r)}else i.show();return i.attr("id")}function unlockScreen(e){var t=$("");t="undefined"!=typeof e?$("#"+e):$("body").children(".locker:last"),"undefined"!=typeof t.attr("timeout_id")&&clearTimeout(t.attr("timeout_id")),t.remove()}function processingBlockInCells(e){"undefined"!=typeof adapterManager&&adapterManager.updateCells(e.closest(".blk_container")),(!0===window._isEditor||"undefined"!=typeof adapterManager&&adapterManager.isEditor())&&e.find(".blk_image_ext").each(function(){pages_editor.setZoomImgExt($(this).attr("id"),$(this).find("img:first"))}),e.find(".blk_image").each(function(){var e=$(this).find("img:first"),t=$(this).parent().width(),a={w:e.width(),h:e.height()};t<=e.attr("prod_w")?(t=t<2?2:t,t=t>e.attr("real_w")?e.attr("real_w"):t,e.css({width:t,height:"auto"}),e.height()<2&&(t=Math.ceil(2*a.w/a.h),e.css({width:t}))):e.css({width:e.attr("prod_w"),height:"auto"}),e=null}),e.find(".blk_video").each(function(){var e=20,t=$(this).find("iframe:first"),a=$(this).parent().width();a<=parseInt(t.css("width"))?(a=a<e?e:a,a=a>t.attr("data-width")?t.attr("data-width"):a,t.css({width:a})):t.css({width:t.attr("data-width")}),t=null})}function sliderEditorExtend(e){e.prototype.reinitFotorama=function(e){var t=e.closest(".blk_section").hasClass("is_absolute"),a={};return t&&(a.height=e.closest(".blk.blk_slider").height()),setTimeout(function(){var t=e.data("fotorama");null!=t&&t.resize(a).show(t.activeIndex)}),e}}function reInitVideoIFrame(e){var t=e.hasClass("blk_video")?e:e.find(".blk_video");t.each(function(){var e=$(this).find(".video iframe:first");e.attr("src",e.attr("src"))})}function initFileFields(e,t){window._isEditor?$(document).on("click",".user_form .userfiles_btn",function(e){return e.preventDefault(),!1}):($(".user_form .userfiles_input").on("click",function(){$(this).closest(".field_wrap").find(".userfiles_btn input[type=file]").click()}),$(".user_form .userfiles_clear").on("click",function(e){e.stopPropagation();var t=$(this).closest(".field_wrap").find(".userfiles_btn input[type=file]");confirm("Удалить загруженный вами файл?")&&(t.val(null).trigger("change",e),t=null)}),$(".user_form .userfiles_btn input[type=file]").on("change",function(a){var i,n=$(this),r=n.closest(".field_wrap"),o=r.find(".userfiles_selected_text");if(n.val()){var s="Файл выбран";if(this.files&&this.files[0]){if(t>0&&this.files.length>t)return n.val(null),r=n=null,alert("Можно выбрать не более "+t+" файл"+plural(t,"а","ов","ов")),!1;for(s=[],i=0;this.files.length>i;i++){if(e>0&&this.files[i].size>e)return n.val(null),r=n=null,alert("Файл должен быть не более "+formatFileSize(e)),!1;s.push(htmlspecialchars(this.files[i].name))}s=s.join(", ")}o.text(s).attr("title",s),r.addClass("userfiles_selected")}else o.text("").attr("title",""),o.removeAttr("style"),r.removeClass("userfiles_selected");r.find(".ui_error").hide(),r=n=null}))}function includeFiles(e){function t(e){l.indexOf(e.href)==-1&&(l.push(e.href),l.length>=s.length&&FE.runAndClr("css_dynamically_loaded"),u++,i())}function a(e){e.forEach(function(e){var a=document.createElement("link");a.setAttribute("rel","stylesheet"),a.setAttribute("type","text/css"),a.setAttribute("href",e),a.onload=function(){t(a)},a.addEventListener&&a.addEventListener("load",function(){t(a)},!1),a.onreadystatechange=function(){var e=a.readyState;"loaded"!==e&&"complete"!==e||(a.onreadystatechange=null,t(a))},document.getElementsByTagName("head")[0].appendChild(a)})}function i(){if(u==p)return FE.run("all_files_dynamically_loaded"),!0}function n(){i()||o(d[c])}function r(e){for(var t in e)"css"==t?isArray(e[t])?(p+=e[t].length,e[t].forEach(function(a){s.push(e[t])})):(p++,s.push(e[t])):"js"==t?isArray(e[t])?(p+=e[t].length,e[t].forEach(function(e){d.push(e)})):(p++,d.push(e[t])):"object"==typeof e[t]&&r(e[t])}function o(e){var t=document.createElement("script");document.head.appendChild(t),t.onload=function(){c++,u++,c==d.length?i():n(e)},t.src=e}var s=[],d=[],l=[],c=0,p=0,u=0;r(e),s.length&&a(s),d.length&&o(d[c]),i()}function initAnchors(){$(document).on("click","a[href*=#]",function(e){var t=$(this).attr("href"),a=t.match(/#(.*)$/i),i=!1,n=$("#sections_list .blk_section.is_fixed:visible:first"),r=0;if(n.length&&(r=n.outerHeight()-1),null!==a&&a[1]){var o=$("#"+a[1]);if(o.length)$("html,body").stop().animate({scrollTop:o.offset().top-r},600),i=!0;else{var s=t.replace(new RegExp("^#","gi"),""),d=$("a[name="+s+"]");d.length&&($("html,body").stop().animate({scrollTop:d.offset().top-r},600),i=!0)}if(i)return e.preventDefault(),!1}})}function jsLog(e){if(userHasTag("js_log")&&window.userId){var t={userId:window.userId,url:window.location.href};window.siteId&&(t.siteId=window.siteId),e.filename&&(t.path=e.filename),e.description&&(t.description=e.description),e.error&&(t.message=e.error.toString(),"object"==typeof e.error&&e.error.stack&&(t.stack=e.error.stack)),$.ajax({url:window.baseUrl+"debug/js_log",data:t,method:"POST",async:!0})}}function sendSlackMessage(e,t,a){if(window.$){"undefined"==typeof a&&(a="Bot");var i={text:t,username:a};$.post(e,{payload:JSON.stringify(i)})}}function slackDebug(e){sendSlackMessage("https://hooks.slack.com/services/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",e)}function slackErrorDump(e,t){null!=window.error_catcher&&error_catcher.send_error(e);var a="https://hooks.slack.com/services/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",i="[JS] "+e.toString();sendSlackMessage(a,i,t)}function checkProtocolInUrl(e){var t=new RegExp("^http(s*)://");return!!t.test(e)&&2===e.split("://").length}function inputUrlProcessing(e){var t="https";return e=e.trim(),e.length>6&&checkProtocolInUrl(e)?e:e.length>3&&0==/^http/.test(e)?t+"://"+e:e}function formatMoney(e){"number"!=typeof e&&(e=parseFloat(e));var t=Math.round(e),a=e.toFixed(1),i=e.toFixed(2),n=parseFloat(a),r=parseFloat(i);return n!==r?i:t!==n?a:t.toFixed(0)}function ucfirst(e){var t=e.charAt(0).toUpperCase();return t+e.substr(1,e.length-1)}function lcfirst(e){var t=e.charAt(0).toLowerCase();return t+e.substr(1,e.length-1)}function convertUnderScoreToStudlyCaps(e){e=e.toLowerCase();for(var t=e.split("_"),a="",i=0;t.length>i;i++){var n=t[i];""!==n&&(a+=ucfirst(n))}return a}function convertUnderScoreToCamelCase(e){return e=convertUnderScoreToStudlyCaps(e),lcfirst(e)}function convertDateFromDbToIsoFormat(e){return e.replace(" ","T")+".000Z"}function F_wind(e,t){this.ops=t,this.$el=$(e),this.params={},this.hidePrevWnd=!0,this.whiteBg=!1,this.closeOutside=!1,this.isShown=!1,this.$btnClose=this.$el.find("a.wind-close"),this.$btnApply=this.$el.find(".wind-btn-apply:first"),this.$btnCancel=this.$el.find(".wind-btn-cancel:first"),this.$el.on("click","a.wind-close, .wnd-hide",this,function(e){e.preventDefault(),e.data.clickBtnClose()}),this.$btnApply.click(this,function(e){e.preventDefault(),e.data.clickBtnApply()}),this.$btnCancel.click(this,function(e){e.preventDefault(),e.data.clickBtnCancel()}),this.applyFunc=function(){return!0}}function showWind(e,t){var a=$.extend({},{width:500,title:"Заголовок",cont:""},"object"==typeof t&&t);'<div class="wind hidden bp0" id="'+e+'" tabindex="-1" style="width:'+a.w+'px;"><div class="wind-header"><a class="wind-close"><i class="icon-remove"></i></a><h3 class="fnt">'+a.title+'</h3></div><div class="wind-body">'+a.cont+'</div><div class="wind-footer"><button class="btn wind-btn-apply btn-primary">OK</button><button class="btn wind-btn-cancel btn-link">Отмена</button></div>'}function shakeWnd(e){e=$(e);var t=e.css("position");e.css("position","relative"),e.animate({left:-10},50,function(){$(this).animate({left:10},100,function(){$(this).animate({left:0},50,function(){$(this).css("position",t),t=null})})})}function FanimManager(){this.is_ready=!1,this.data={},this.visible_elements={},this.animated_blocks={},this.height_window=0,this.ready=function(){this.is_ready=!0,FE.runAndClr("animManager/ready")},this.init=function(e){var t=!1;if(window.animManager.data=e,window.animManager.height_window=window.innerHeight,!$.isEmptyObject(window.animManager.data))for(var a in window.animManager.data)t=$("#"+window.animManager.data[a].block_id),t.length>0&&(window.animManager.animated_blocks[a]=t);var i=!1;$(window).on("resize",function(e){i===!1&&(i=setTimeout(function(){i=!1,window.animManager.h=window.innerHeight,window.animManager.onScroll(e)},500))}),$(document).on("scroll",function(e){window.animManager.onScroll(e)}),$("#popup_list .section_popup").on("scroll",function(e){window.animManager.onScroll(e)}),FE.add("show_section_popup",function(){window.animManager.onScroll()}),window.animManager.onScroll()},this.getAnimatedObject=function(e){var t=$("#"+e);if(0==t.length)return!1;switch(t.attr("blk_class")){case"blk_image":t=t.find("img:first");break;case"blk_form":t=t.find(".blk_form_wrap:first");break;case"blk_text":t=t.find(".blk-data:first");break;case"blk_video":t=t.find(".video_container:first");break;case"blk_slider":t=t.find(".fotorama:first");break;case"blk_button":t=t.find("a:first")}return t},this.setStyle=function(e,t,a){var i=e[0],n=window.getComputedStyle(i),r="";r=n.getPropertyValue("-webkit-animation-delay")?"-webkit-animation-delay":n.getPropertyValue("-moz-animation-delay")?"-moz-animation-delay":n.getPropertyValue("-o-animation-delay")?"-o-animation-delay":"animation-delay",i.style.setProperty(r,"0s"),r=n.getPropertyValue("-webkit-animation-duration")?"-webkit-animation-duration":n.getPropertyValue("-moz-animation-duration")?"-moz-animation-duration":n.getPropertyValue("-o-animation-duration")?"-o-animation-duration":"animation-duration",i.style.setProperty(r,a+"s")},this.setClass=function(e,t){e.hasClass(t)||e.addClass(t)},this.onScroll=function(e){var t=self.pageYOffset||document.documentElement&&document.documentElement.scrollTop||document.body&&document.body.scrollTop,a=window.animManager.height_window/100*5;window.animManager.visible_elements={};for(var i in window.animManager.animated_blocks){var n=window.animManager.animated_blocks[i],r=window.animManager.getAnimatedObject(window.animManager.data[i].block_id);n!==!1&&r!==!1&&(r.closest(".blk_box_slider_self").length>0?(window.animManager.setClass(r,window.animManager.data[i].animation_type),n.removeClass("is_animated_block")):r.offset().top<=t+window.animManager.height_window-a&&r.offset().top+r.outerHeight()>=t+a&&(window.animManager.visible_elements[i]=n,window.animManager.startAnimation(n,r,window.animManager.data[i]),window.animManager.animated_blocks[i]=!1))}},this.startAnimation=function(e,t,a){window.animManager.setStyle(t,a.delay,a.duration);var i=function(){window.animManager.setClass(t,a.animation_type),e.removeClass("is_animated_block")};parseFloat(a.delay)>0?setTimeout(i,1e3*parseFloat(a.delay)):i()}}function ModuleButtonUp(e){this.settings_arr=[],this.$btn_wrap=$("#button_up_wrap"),this.settings_arr=$.map(e,function(e,t){return[e]}),this.drawButton(),this.bindEvent()}if(window.rnd_seed=(new Date).getTime(),!window._ua)var _ua=navigator.userAgent.toLowerCase();var browser={version:(_ua.match(/.+(?:me|ox|on|rv|it|era|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],opera:/opera/i.test(_ua),msie:/msie/i.test(_ua)&&!/opera/i.test(_ua),msie6:/msie 6/i.test(_ua)&&!/opera/i.test(_ua),msie7:/msie 7/i.test(_ua)&&!/opera/i.test(_ua),msie8:/msie 8/i.test(_ua)&&!/opera/i.test(_ua),msie9:/msie 9/i.test(_ua)&&!/opera/i.test(_ua),mozilla:/firefox/i.test(_ua),chrome:/chrome/i.test(_ua),safari:!/chrome/i.test(_ua)&&/webkit|safari|khtml/i.test(_ua),iphone:/iphone/i.test(_ua),ipod:/ipod/i.test(_ua),iphone4:/iphone.*OS 4/i.test(_ua),ipod4:/ipod.*OS 4/i.test(_ua),ipad:/ipad/i.test(_ua),android:/android/i.test(_ua),bada:/bada/i.test(_ua),mobile:/iphone|ipod|ipad|opera mini|opera mobi|iemobile|android/i.test(_ua),msie_mobile:/iemobile/i.test(_ua),safari_mobile:/iphone|ipod|ipad/i.test(_ua),opera_mobile:/opera mini|opera mobi/i.test(_ua),opera_mini:/opera mini/i.test(_ua),mac:/mac/i.test(_ua)};Array.prototype.forEach||(Array.prototype.forEach=function(e,t){for(var a=0,i=this.length;a<i;++a)e.call(t,this[a],a,this)}),Date.prototype.toISOString||(Date.prototype.toISOString=function(){function e(e){return e<10?"0"+e:e}return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"."+e(this.getUTCMilliseconds())+"Z"}),FE.add("onready","initDropdown()"),window.jQuery&&(jQuery.fn.outerHTML=function(e){return e?this.before(e).remove():jQuery("<div></div>").append(this.eq(0).clone()).html()}),$("body").popover({trigger:"hover",selector:".has_popover",placement:"top",html:"true",delay:"100"}),$(document).on("click",".btn-smart",function(){if(!$(this).data("button")){var e=$(this).attr("data-loading");$(this).button({loadingText:e?e:"Загрузка..."})}$(this).button("loading")}),$(document).on("click","form.frm_lead:not(.editor)",function(e){e.stopPropagation()}),$(document).on("click",".wrap-for-formPopover",function(e){$("#formPopover").wind("hide")}),$(document).on("submit","form.frm_lead",function(e){var id=$(this).attr("id");id||(id=$(this).attr("frm-id"));var frm=$(this),$parent=$(frm).parent(),isQuiz=$parent.hasClass("quiz-form"),quizForm;isQuiz&&(quizForm=sitesMan.quizForm(frm));var inp_track=frm.find("input.inp_track");if(inp_track.length||(inp_track=$('<input type="hidden" class="inp_track" name="inp_track" value=""/>'),inp_track.appendTo(frm)),inp_track.val(escapeRus(getCookie("bm360track"))),!frm.find("input.inp_utm").length){$('<input type="hidden" class="inp_utm" name="has_utm" value="1"/>').appendTo(frm);var params=getUrlVars();for(var k in params)$('<input type="hidden" class="inp_utm" name="'+k+'" value="'+params[k]+'"/>').appendTo(frm)}var data_mes_url=parseInt(frm.attr("data-mes-url")),ajax_cfg={frm:$(this),type:"POST",cache:!1,timeout:4e4,url:(null!==window.baseUrl.match(/lpmotor.ru\/admin\/$/)?window.baseUrl.replace(/^http(|s):/,window.location.protocol).replace(/\/$/,""):"")+$(this).attr("action")+"/frm:"+id,beforeSend:function(e,t){var a=t.frm.find("input.ui_btn, input.btn-submit");if(a.css({width:a.outerWidth()}),!a.data("button")){var i=a.attr("lang");a.button({loadingText:i&&"en"==i?"Loading...":"Загрузка...",defText:a.val()}),i=null}a.button("loading")},success:function(data){var isQuiz=frm.parent().hasClass("quiz-form");if(frm.find(".ui_has_error").removeClass("ui_has_error"),frm.find(".ui_error").hide().html(""),frm.find("input.ui_btn, input.btn-submit").button("def"),"function"==typeof data.split&&(data=JSON.parse(data)),isset(data.error)){var firstErr=!1;for(var attrId in data.error){var $attr=frm.find("#"+frm.attr("id")+"__"+attrId),$attrErr=frm.find(".ui_error[for="+frm.attr("id")+"__"+attrId+"]");if($attr.length&&($attr.addClass("ui_has_error"),!1===firstErr&&($attr.focus(),firstErr=!0,isQuiz&&quizForm))){var $steps=frm.find(".quiz"),index=$steps.index($attr.closest(".quiz"));sitesMan.toQuizStep(quizForm,index),FE.run("quiz-validate-error",{step:$steps.eq(index)})}data.error.hasOwnProperty(attrId)&&$attrErr.length&&($attrErr.show(),$attrErr.html("<div>"+data.error[attrId].join("</div><div>")+"</div>"))}}if(isset(data.exception)&&window.dbgMode&&alert(data.exception),isset(data.script))try{eval(data.script)}catch(e){window.console&&window.dbgMode&&(console.log(e),console.log("[_Ошибка JS_] "+e.stack))}if(isset(data.post_data))try{$.ajax({url:data.post_data.url,data:data.post_data.params,method:"POST",async:!0})}catch(e){window.console&&window.dbgMode&&(console.log(e),console.log("[_POST_request_error_] "+e.stack))}if(isset(data.res))if(1==data.res){reachGoalByAttr(frm,"goal-submitted");var mes=!1,f_show_msg=function(e){if(mes=e.attr("suссess-message"),mes.length||(mes="Спасибо!\\nВаша заявка принята.\\nВ ближайшее время мы с вами свяжемся!"),isset(data.lead_preview)){mes+='<div class="lead_preview"><div class="c_text">--------[ ВНИМАНИЕ ]--------</div><div class="c_text">(В предпросмотре заявка не создается)</div><div class="l_text mt1">Данные, принятые с формы:</div><ul class="l_text mb0">';for(var t in data.lead_preview)mes+="<li><b>"+data.lead_preview[t].name+"</b>: "+(null===data.lead_preview[t].val?"":data.lead_preview[t].val)+"</li>";mes+="</ul></div>"}};switch(data_mes_url){case 1:f_show_msg(frm);break;case 2:var loc=frm.attr("data-goto-url");if(loc.length){/^http(|s):\/\//.test(loc)!==!0&&(loc="http://"+loc);var inp;return-1!==loc.indexOf("{name}")&&(inp=frm.find(".field.fname:first input.inp"),inp.length&&(loc=loc.replace("{name}",encodeURIComponent(inp.val())))),-1!==loc.indexOf("{email}")&&(inp=frm.find(".field.femail:first input.inp"),inp.length&&(loc=loc.replace("{email}",encodeURIComponent(inp.val())))),-1!==loc.indexOf("{phone}")&&(inp=frm.find(".field.fphone:first input.inp"),inp.length&&(loc=loc.replace("{phone}",encodeURIComponent(inp.val())))),-1!==loc.indexOf("{order_id}")&&data.id_lead&&(loc=loc.replace("{order_id}",data.id_lead)),void(window.location.href=loc)}loc=null;break;case 3:var frm_id=frm.attr("frm-id"),lead_id=data.id_lead,key=data.key;if($("#ymis_"+frm_id).length>0){var c_ops={id:"j_lead_confirm",html:!0,width:null,okText:"Яндекс.Деньги",cancelText:"Банковская карта",btnWidth:120,okClass:"n-btn n-btn-success btn-round",cancelClass:"n-btn n-btn-success btn-round",onOk:function(){ymis_manager.submitLeadForm(frm_id,lead_id,key,"PC")},onCancel:function(){ymis_manager.submitLeadForm(frm_id,lead_id,key,"AC")},headerText:!1,showClose:!0};jConfirm("Выберите способ оплаты",c_ops,!0),$("#j_lead_confirm").find("#jConfirmOk").removeClass("ibtn wind-btn-apply")}else f_show_msg(frm);break;case 4:var robokassaForm=$("#robokassa_"+frm.attr("frm-id"));robokassaForm.length>0?(robokassaForm.find("input[name=InvId]").val(data.id_lead),robokassaForm.find("input[name=SignatureValue]").val(data.signature),robokassaForm.submit()):(consoleDbg(data),f_show_msg(frm));break;case 5:data.ya_kassa_res&&data.ya_kassa_res.confirmation_url?window.location.href=data.ya_kassa_res.confirmation_url:(consoleDbg(data.ya_kassa_res),f_show_msg(frm));break;case 6:data.pay_pal_res&&data.pay_pal_res.approval_link?window.location.href=data.pay_pal_res.approval_link:(consoleDbg(data.pay_pal_res),f_show_msg(frm));break;default:console.log("FORM has action type = "+data_mes_url+" (it is not defined)")}isQuiz&&quizForm&&sitesMan.toQuizStep(quizForm,0),frm.find("http://s.lpmcdn.com/web/build/pages/input.inp,textarea.inp").val(""),frm.find("input[type=checkbox]").prop("checked",!1),frm.find(".fradio input:first").prop("checked",!0),frm.find(".fselect option:first").prop("selected","selected"),frm.find("input[type=file]").val(null).trigger("change",e);var w=frm.closest(".wind");if(w.length&&w.wind("hide"),w=null,!1!==mes){if(window.jAlert){var wnd_width="undefined"==typeof adapterManager||adapterManager.isPC()?400:340;$("#wind_container").addClass("j_alert"),jAlert(mes.replace(/\\n/g,"<br/>"),{id:"j_lead_alert",showCloseBtn:!0,btnCls:"btn",width:wnd_width,btnWidth:"auto",hideOnBlackoutClick:!0,html:!0,mobileAdapt:isQuiz&&!quizMobileView.isMobileInPreview(),onOk:function(){$("#wind_container").removeClass("j_alert")}})}else alert(mes.replace(/\\n/g,"\n"));mes=null}}else if(data.show_alert)switch(data.show_alert){case"empty_data":alert("Нужно заполнить хотя бы одно поле");break;default:alert("Error: "+data.show_alert)}window.dbgMode&&console.log(data)},error:function(e,t,a){switch(console.log(t),t){case"timeout":alert("Ошибка! Нет связи с сервером. Проверьте подключение к интернету и попробуйте снова.");break;case"error":case"parsererror":alert("Извините, на сервере возникла ошибка!\n\nПожалуйста, напишите нам в тех-поддержку support@lpmotor.ru"),window.dbgMode&&(console.log(e),console.log(a))}frm.find("input.ui_btn, input.btn-submit").button("def")}};if(frm.find("input[type=file]").length>0){if(!window.FormData)return alert("Ошибка № 2876 Ваш браузер не поддерживает объект FormData, попробуйте воспользоваться современной версией браузера"),!1;ajax_cfg.data=new FormData(this),ajax_cfg.processData=!1,ajax_cfg.contentType=!1}else ajax_cfg.dataType="json",ajax_cfg.data=$(this).serialize();return 6==data_mes_url&&lockScreen("Сейчас произойдет переход к оплате",{show_animation:!0}),$.ajax(ajax_cfg),id=null,!1}),window._eh={step:20,speed:300,$container:!1,$body:!1,$wnd:!1,bodyWidth:0,$img:null,$newImg:null,curSize:null,origSize:null,wndSize:null,newSize:null},window._lpcid_hosts=["http://lpmotor.ru/","http://lpmotor.org/","http://bm360.ru/","https://admin.lpmotor.ru"],window.userHasTag=function(e){return"undefined"!=typeof window.__user_tags&&"undefined"!=typeof window.__user_tags[e]},window.userAddTag=function(e,t){"undefined"!=typeof window.__user_tags&&"undefined"==typeof window.__user_tags[e]&&window.$&&$.ajax({url:baseUrl+"tests/ajax/do:add_tag",data:{tag:e},dataType:"json",method:"post",_funcParams:{callback:t||!1},success:function(t){var a=!1;t.res&&1==t.res&&t.cnt&&t.cnt>0&&(window.__user_tags[e]=1,a=!0),"function"==typeof this._funcParams.callback&&this._funcParams.callback.apply(this,[a,t])}})},function(e){function t(t){return u=lockScreen("Секундочку...",{show_animation:!0}),$.get("http://"+e.baseDomain+"/"+window.siteId+"/api/popup",{popup_id:t},"JSON")}function a(e,t){var a=$(e);return c.append(a),p[t]=a,a}function i(e){console.error("Error num: [#4481]. Не удалось получить всплывающую секцию. Сервер вернул: ",e)}function n(e){var t,a=p[e],i=$("#sections_list").find(" .blk_section.is_fixed"),n=$("body"),r=n.width();n.addClass("open_popup"),t=n.width()-r,n.css("margin-right",t),$("body>.navbar>.navbar-inner").css("padding-right",t),"undefined"!=typeof window.module_geotarget&&window.module_geotarget.city.length&&a.find(".geotarget_module").text(window.module_geotarget.city).removeClass("hidden"),
i.length&&(window.active_fixed_sections=i,$.each(i,function(){$(this).css({"z-index":5})})),a.addClass("open"),a.hasClass("initSlick")||(a.find(".blk_box_slider_self").each(function(){var e=$(this);initSlick(e)}),a.addClass("initSlick")),FE.run("show_section_popup",{section_id:e})}function r(e){try{var t=JSON.parse(e)}catch(e){return(new $.Deferred).reject(e)}return t.data?t.data:(new $.Deferred).reject(e)}function o(e){e.find(".blk_yandex_map").each(function(){var e=$(this).attr("id"),t="init_ymap_"+e;return window[t]?void window[t]():void console.error("Функция "+t+" не была найдена в window. [#4502]")})}function s(e){e.find(".is_animated_block").each(function(){window.animManager.animated_blocks[$(this).attr("id")]=$(this)})}function d(d){var l=function(){e._isEditor||$("#"+d).find(".blk.blk_video .video.autoplay iframe:first").each(function(){e.playVideo($(this))})};isset(p[d])?(n(d),l()):t(d).then(r).then(function(e){var t=a(e,d);return o(t),s(t),window.adapterManager.initFotorama(),unlockScreen(u),u=null,sitesMan.initQuiz(t,!0),d},i).then(n).then(l)}function l(e){var t=$("#"+e);t.length||console.error("Не найдена секция #"+e+". Ошибка [#4482]"),p[e]=t}var c=$("#popup_list"),p={},u=null;e.stopAutoPlayVideo=function(e){e.attr("src",""),window.speedUpVideoLoadIsEnabled&&e.closest(".blk").removeClass("video--play")},e.playVideo=function(t){t.attr("src",t.attr("src-temp")),e.speedUpVideoLoadIsEnabled&&t.closest(".blk").addClass("video--play")},c.find(".blk_section").each(function(){p[$(this).attr("id")]=$(this)}),e.showSectionPopup=d,e.registerPopup=l}(window),function(e){FE.add("onready",function(){e.speedUpVideoLoadIsEnabled&&($(document).on("click",".video__overlay",function(){e._isEditor||e.playVideo($(this).closest(".blk").find("iframe:first"))}),$("#sections_list .blk.blk_video:visible .video.autoplay iframe:first").each(function(){e._isEditor||e.playVideo($(this))}))})}(window),function(e){"use strict";function t(t){e(i).each(function(){FE.run("hide_custom_dropdown",t,{$btn:e(this),$wrap:a(e(this)).removeClass("open")})})}function a(e){return e.parent()}var i=".custom-dropdown-btn",n="click.custom-dropdown.data-api",r="keydown.custom-dropdown.data-api",o=function(t){var a=e(t).on(n,this.toggle);e("html").on(n,function(e){FE.run("hide_custom_dropdown",e,{$btn:a,$wrap:a.parent().removeClass("open")})})};o.prototype={constructor:o,toggle:function(i){var n,r,o=e(this);if(!o.is(".disabled, :disabled"))return n=a(o),r=n.hasClass("open"),t(i),r||("ontouchstart"in document.documentElement,FE.run("show_custom_dropdown",i,{$btn:o,$wrap:n.toggleClass("open")})),o.focus(),!1},keydown:function(t){var n,r,o;if(/(38|40|27)/.test(t.keyCode)&&(n=e(this),t.preventDefault(),t.stopPropagation(),!n.is(".disabled, :disabled")))return r=a(n),o=r.hasClass("open"),!o||o&&27==t.keyCode?(27==t.which&&r.find(i).focus(),n.click()):void 0}};var s=e.fn.customDropdown;e.fn.customDropdown=function(t){return this.each(function(){var a=e(this),i=a.data("customDropdown");i||a.data("customDropdown",i=new o(this)),"string"==typeof t&&i[t].call(a)})},e.fn.customDropdown.Constructor=o,e.fn.customDropdown.noConflict=function(){return e.fn.customDropdown=s,this},e(document).on(n,t).on(n,".custom-dropdown-menu",function(e){e.stopPropagation()}).on(n,i,o.prototype.toggle).on(r,i,o.prototype.keydown)}(window.jQuery),function(){$("#popup_list").on("click",".blk_section.section_popup.open",function(e){if("click"==e.type&&$(e.target).hasClass("section_popup"))return hideSectionPopup($(e.currentTarget).attr("id")),!1})}(),function(){var e=function(){var e=$("#gift-for-user img");if(e.length>0){var t=e.attr("classes-animate");e.addClass(t);var a=function(){e.removeClass(t)};setTimeout(a,1e3)}};$("#gift-for-user").length>0&&setInterval(e,3e3)}(),Math.radians=function(e){return e*Math.PI/180},Math.degrees=function(e){return 180*e/Math.PI},function(){var e=$(".widgets__all-sites");e.length&&e.on("click",function(){window.sessionStorage.clear("widgets/siteId")})}(),function(e){function t(t,a,i){var n=new $.Deferred;return FE.add("__lpmExtensions/"+a+"/included",function(){e.__lpmExtensions.appendHtml(t.res.html),$.when(e.__lpmExtensions.run(a,i)).then(function(e){n.resolve(e)})}),includeFiles(t.res),n}e.__lpmExtensions={isInited:!1,get:function(a,i){var n=1,r=i?i:e.siteId;return e.dbgMode&&(n=(new Date).getTime()),lockScreen("Секундочку...",{show_animation:!0}),$.get(window.baseUrl+r+"/settings/ajax/frm:get_extension",{v:n,exName:a,includeMain:intval(0==intval(isset(e.__lpmExtensions)&&e.__lpmExtensions.isInited))}).then(function(e){return t(JSON.parse(e),a,r)})}}}(window),function(){userHasTag("js_log")&&(console.log("init: Error Event Listener"),window.addEventListener("error",jsLog))}(),function(e){var t,a=$("body"),i=$("#formPopover"),n=function(){function e(){this.setMobileView=function(){a=t.attr("content"),t.attr("content",i)},this.rollbackView=function(){t.attr("content",a)}}var t=$('head meta[name="viewport"]'),a="",i="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=0";return e}(),r=new n,o=function(){function e(){n=r.css("width"),r.css("width","100%")}function t(){r.css("width",n)}function a(a){r=a,o=r.is(".wind")?r:r.closest(".wind"),this.resetFormMinWidth=function(){i=r.css("minWidth"),r.css("minWidth",0)},this.rollbackFormMinWidth=function(){r.css("minWidth",i)},this.getElement$=function(){return a},this.adaptWind=function(){e(),r.addClass(s)},this.rollbackWind=function(){t(),r.removeClass(s)},this.adaptInPreview=function(){o.addClass(d)},this.rollbackInPreview=function(){o.removeClass(d)}}var i,n,r,o,s="mobile-view",d="preview-adapt";return a}(),s=function(){function e(e){var a,i=e.step;n=i.find(".error_wrapper"),a=n.find(".ui_error"),i.hasClass("fname")||i.hasClass("fselect")||i.hasClass("femail")||i.hasClass("fphone")||(o=!0,r=!1,"none"==a.css("display")&&a.css("display","flex"),quizMobileView.isMobile()?n.css("bottom",t.getElement$().find(".wind-footer").outerHeight()):(n.css("top",p.getVisiblePart()),r=1),n.addClass("floated-error").fadeIn(400,function(){setTimeout(function(){n.fadeOut(400,function(){n.removeClass("floated-error"),o=!1})},3500)}))}function a(){this.subscribeOnEvent=function(){FE.add(i,e)},this.changePosition=function(e){r&&o&&n.css("top",e)},this.unsubscribe=function(){FE.clr(i)}}var i="quiz-validate-error",n=$(),r=!1,o=!1;return a}(),d=new s,l=function(){function e(){quizMobileView.isMobile()&&(a.removeClass("quiz-mobile-view"),r.rollbackView(),t.rollbackFormMinWidth()),quizMobileView.isMobileInPreview()&&t.rollbackInPreview(),d.unsubscribe()}function n(){quizMobileView.isMobile()&&(a.removeClass("quiz-mobile-view"),r.rollbackView(),t.rollbackWind())}function s(e,t){c.indexOf(e.attr("id"))===-1&&(e.wind("setAfterCloseFunc",t),c.push(e.attr("id")))}function l(){this.toQuizView=function(n){t=new o(n),this.isMobile()&&(r.setMobileView(),a.addClass("quiz-mobile-view"),t.resetFormMinWidth(),this.isMobileInPreview()&&t.adaptInPreview()),d.subscribeOnEvent(),p.initialize(),s(i,e)},this.adaptWind=function(e){this.isMobile()&&(t=new o(e),t.adaptWind(),r.setMobileView(),a.addClass("quiz-mobile-view"),s(e,n))},this.isMobile=function(){return browser.mobile||this.isMobileInPreview()},this.isMobileInPreview=function(){return adapterManager.isPreview()&&!adapterManager.isPC()},this.getSmartHeader=function(){return p}}var c=[];return l}(),c=function(){function e(){s=$(this).scrollTop(),s>o?a():i(),d.changePosition(p.getVisiblePart()),o=s}function a(){l>0?(l-=s-o,r.css({top:-(u-l)})):l=0,c=s}function i(){l+=o-s,l>u&&(l=u),r.css({top:l<=u?-(u-l):0}),0==s?(c=0,r.removeClass("shadow")):c>u&&r.addClass("shadow")}function n(){this.initialize=function(){var a=t.getElement$(),i=a.attr("id");h.indexOf(i)===-1&&(r=a.find(".wind-header"),l=u=r.outerHeight()+f,a.find(".wind-body").on("scroll",e),h.push(i))},this.getVisiblePart=function(){return l},this.recalcHeaderHeight=function(){l=u=r.outerHeight()+f}}var r,o=0,s=0,l=0,c=0,u=0,f=4,h=[];return n}(),p=new c;e.quizMobileView=new l}(window),window._wind_cnt=0,F_wind.prototype.toggle=function(){return this[this.isShown?"hide":"show"]()},F_wind.prototype.show=function(){if(this.ops.showFunc(this)){window._wind_cnt<=0&&($("#wind_container").show(),window._wind_cnt<0&&(window._wind_cnt=0));var e=this.$el.attr("id");this.$el.parent().hasClass("wind-wrap")?this.$wrap||(this.$wrap=this.$el.closest(".wind-wrap")):(this.$el.wrap('<div class="wind-wrap hidden'+(this.whiteBg?" wind-wrap-white":"")+(e?" wrap-for-"+e:"")+'"></div>'),this.$el.removeClass("hidden"),this.$wrap=this.$el.parent()),this.$wrap.css({"z-index":window._wind_cnt+1}),this.$wrap.removeClass("hidden"),this.isShown=!0,this.$el.trigger("show");var t=$("body").width(),a=null;if($("html").addClass("wind_opened"),a=$("body").width()-t,$("body").css("margin-right",a),$("body>.navbar>.navbar-inner").css("padding-right",a),this.ops.afterShowFunc(this),window.lpm_hints){var i=window.lpm_hints.getHintsManager();if(i&&i.currentDisplayedHint){var n=i.currentDisplayedHint;n&&n.settings&&n.settings.name&&setTimeout(function(){i.offHint(i.currentDisplayedHint)},500)}}this.$el.hasClass("wind--close-outside")&&(this.$wrap.on("click",this.clickOutside),this.closeOutside=!0),t=a=null,window._wind_cnt++}},F_wind.prototype.hide=function(){window._wind_cnt>0?window._wind_cnt--:window._wind_cnt=0,this.$wrap&&this.$wrap.addClass("hidden"),0==$("#wind_container > div:visible").length&&$("#wind_container").hide(),this.isShown=!1,this.$el.trigger("hide"),$("body").css("margin-right",0),$("body>.navbar>.navbar-inner").css("padding-right",0),$("html").removeClass("wind_opened"),this.closeOutside&&this.$wrap.off("click",this.clickOutside),this.ops.afterCloseFunc(this)},F_wind.prototype.setHidePrevWnd=function(e){this.hidePrevWnd=!!e},F_wind.prototype.setWhiteBg=function(e){this.whiteBg=!!e},F_wind.prototype.setApplyFunc=function(e){"function"==typeof e&&(this.ops.applyFunc=e)},F_wind.prototype.setCancelFunc=function(e){"function"==typeof e&&(this.ops.cancelFunc=e)},F_wind.prototype.setCloseFunc=function(e){"function"==typeof e?this.ops.closeFunc=e:this.ops.closeFunc=null},F_wind.prototype.setAfterCloseFunc=function(e){"function"==typeof e&&(this.ops.afterCloseFunc=e)},F_wind.prototype.setShowFunc=function(e){"function"==typeof e&&(this.ops.showFunc=e)},F_wind.prototype.setAfterShowFunc=function(e){"function"==typeof e&&(this.ops.afterShowFunc=e)},F_wind.prototype.setParams=function(e){this.params=e},F_wind.prototype.clickBtnApply=function(){!1!==this.ops.applyFunc(this)&&this.hide()},F_wind.prototype.clickBtnClose=function(){"function"==typeof this.ops.closeFunc?!1!==this.ops.closeFunc(this)&&this.hide():this.clickBtnCancel()},F_wind.prototype.clickOutside=function(e){return 0!==$(e.target).closest(".wind").length||void $(this).children(".wind").wind("clickBtnClose")},F_wind.prototype.clickBtnCancel=function(){!1!==this.ops.cancelFunc(this)&&this.hide()},jQuery.fn.wind=function(e){var t=$(this),a=$.extend({},$.fn.wind.defaults,"object"==typeof e&&e),i=t.data("wind");return i||t.data("wind",i=new F_wind(this,a)),"string"==typeof e?arguments[1]?i[e](arguments[1]):i[e]():a.show&&i.show(),t=i=a=null,this},jQuery.fn.wind.defaults={show:!1,container:$("body > #wind_container"),applyFunc:function(){return!0},cancelFunc:function(){return!0},closeFunc:null,showFunc:function(){return!0},afterCloseFunc:function(){},afterShowFunc:function(){}},fotoramaVersion="4.6.4",function(e,t,a,i,n){"use strict";function r(e){var t="bez_"+i.makeArray(arguments).join("_").replace(".","p");if("function"!=typeof i.easing[t]){var a=function(e,t){var a=[null,null],i=[null,null],n=[null,null],r=function(r,o){return n[o]=3*e[o],i[o]=3*(t[o]-e[o])-n[o],a[o]=1-n[o]-i[o],r*(n[o]+r*(i[o]+r*a[o]))},o=function(e){return n[0]+e*(2*i[0]+3*a[0]*e)},s=function(e){for(var t,a=e,i=0;++i<14&&(t=r(a,0)-e,!(Math.abs(t)<.001));)a-=t/o(a);return a};return function(e){return r(s(e),1)}};i.easing[t]=function(t,i,n,r,o){return r*a([e[0],e[1]],[e[2],e[3]])(i/o)+n}}return t}function o(){}function s(e,t,a){return Math.max(isNaN(t)?-1/0:t,Math.min(isNaN(a)?1/0:a,e))}function d(e){return e.match(/ma/)&&e.match(/-?\d+(?!d)/g)[e.match(/3d/)?12:4]}function l(e){return zt?+d(e.css("transform")):+e.css("left").replace("px","")}function c(e){var t={};return zt?t.transform="translate3d("+e+"px,0,0)":t.left=e,t}function p(e){return{"transition-duration":e+"ms"}}function u(e,t){return isNaN(e)?t:e}function f(e,t){return u(+String(e).replace(t||"px",""))}function h(e){return/%$/.test(e)?f(e,"%"):n}function _(e,t){return u(h(e)/100*t,f(e))}function m(e){return(!isNaN(f(e))||!isNaN(f(e,"%")))&&e}function g(e,t,a,i){return(e-(i||0))*(t+(a||0))}function v(e,t,a,i){return-Math.round(e/(t+(a||0))-(i||0))}function w(e){var t=e.data();if(!t.tEnd){var a=e[0],i={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",msTransition:"MSTransitionEnd",transition:"transitionend"};V(a,i[bt.prefixed("transition")],function(e){t.tProp&&e.propertyName.match(t.tProp)&&t.onEndFn()}),t.tEnd=!0}}function b(e,t,a,i){var n,r=e.data();r&&(r.onEndFn=function(){n||(n=!0,clearTimeout(r.tT),a())},r.tProp=t,clearTimeout(r.tT),r.tT=setTimeout(function(){r.onEndFn()},1.5*i),w(e))}function y(e,t){if(e.length){var a=e.data();zt?(e.css(p(0)),a.onEndFn=o,clearTimeout(a.tT)):e.stop();var i=k(t,function(){return l(e)});return e.css(c(i)),i}}function k(){for(var e,t=0,a=arguments.length;a>t&&(e=t?arguments[t]():arguments[t],"number"!=typeof e);t++);return e}function $(e,t){return Math.round(e+(t-e)/1.5)}function M(){return M.p=M.p||("https:"===a.protocol?"https://":"http://"),M.p}function x(e){var a=t.createElement("a");return a.href=e,a}function C(e,t){if("string"!=typeof e)return e;e=x(e);var a,i;if(e.host.match(/youtube\.com/)&&e.search){if(a=e.search.split("v=")[1]){var n=a.indexOf("&");-1!==n&&(a=a.substring(0,n)),i="youtube"}}else e.host.match(/youtube\.com|youtu\.be/)?(a=e.pathname.replace(/^\/(embed\/|v\/)?/,"").replace(/\/.*/,""),i="youtube"):e.host.match(/vimeo\.com/)&&(i="vimeo",a=e.pathname.replace(/^\/(video\/)?/,"").replace(/\/.*/,""));return a&&i||!t||(a=e.href,i="custom"),!!a&&{id:a,type:i,s:e.search.replace(/^\?/,""),p:M()}}function S(e,t,a){var n,r,o=e.video;return"youtube"===o.type?(r=M()+"img.youtube.com/vi/"+o.id+"/default.jpg",n=r.replace(/\/default.jpg$/,"hqdefault.jpg"/*tpa=http://s.lpmcdn.com/hqdefault.jpg*/),e.thumbsReady=!0):"vimeo"===o.type?i.ajax({url:M()+"vimeo.com/api/v2/video/"+o.id+".json",dataType:"jsonp",success:function(i){e.thumbsReady=!0,T(t,{img:i[0].thumbnail_large,thumb:i[0].thumbnail_small},e.i,a)}}):e.thumbsReady=!0,{img:n,thumb:r}}function T(e,t,a,n){for(var r=0,o=e.length;o>r;r++){var s=e[r];if(s.i===a&&s.thumbsReady){var d={videoReady:!0};d[Gt]=d[Jt]=d[Kt]=!1,n.splice(r,1,i.extend({},s,d,t));break}}}function E(e){function t(e,t,n){var r=e.children("img").eq(0),o=e.attr("href"),s=e.attr("src"),d=r.attr("src"),l=t.video,c=!!n&&C(o,l===!0);c?o=!1:c=l,a(e,r,i.extend(t,{video:c,img:t.img||o||s||d,thumb:t.thumb||d||s||o}))}function a(e,t,a){var n=a.thumb&&a.img!==a.thumb,r=f(a.width||e.attr("width")),o=f(a.height||e.attr("height"));i.extend(a,{width:r,height:o,thumbratio:q(a.thumbratio||f(a.thumbwidth||t&&t.attr("width")||n||r)/f(a.thumbheight||t&&t.attr("height")||n||o))})}var n=[];return e.children().each(function(){var e=i(this),r=H(i.extend(e.data(),{id:e.attr("id")}));if(e.is("a, img"))t(e,r,!0);else{if(e.is(":empty"))return;a(e,null,i.extend(r,{html:this,_html:e.html()}))}n.push(r)}),n}function I(e){return 0===e.offsetWidth&&0===e.offsetHeight}function P(e){return!i.contains(t.documentElement,e)}function A(e,t,a,i){return A.i||(A.i=1,A.ii=[!0]),i=i||A.i,"undefined"==typeof A.ii[i]&&(A.ii[i]=!0),e()?t():A.ii[i]&&setTimeout(function(){A.ii[i]&&A(e,t,a,i)},a||100),A.i++}function D(e){a.replace(a.protocol+"//"+a.host+a.pathname.replace(/^\/?/,"/")+a.search+"#"+e)}function z(e,t,a,i){var n=e.data(),r=n.measures;if(r&&(!n.l||n.l.W!==r.width||n.l.H!==r.height||n.l.r!==r.ratio||n.l.w!==t.w||n.l.h!==t.h||n.l.m!==a||n.l.p!==i)){var o=r.width,d=r.height,l=t.w/t.h,c=r.ratio>=l,p="scaledown"===a,u="contain"===a,f="cover"===a,h=X(i);c&&(p||u)||!c&&f?(o=s(t.w,0,p?o:1/0),d=o/r.ratio):(c&&f||!c&&(p||u))&&(d=s(t.h,0,p?d:1/0),o=d*r.ratio),e.css({width:o,height:d,left:_(h.x,t.w-o),top:_(h.y,t.h-d)}),n.l={W:r.width,H:r.height,r:r.ratio,w:t.w,h:t.h,m:a,p:i}}return!0}function B(e,t){var a=e[0];a.styleSheet?a.styleSheet.cssText=t:e.html(t)}function F(e,t,a){return t!==a&&(t>=e?"left":e>=a?"right":"left right")}function O(e,t,a,i){if(!a)return!1;if(!isNaN(e))return e-(i?0:1);for(var n,r=0,o=t.length;o>r;r++){var s=t[r];if(s.id===e){n=r;break}}return n}function L(e,t,a){a=a||{},e.each(function(){var e,n=i(this),r=n.data();r.clickOn||(r.clickOn=!0,i.extend(ae(n,{onStart:function(t){e=t,(a.onStart||o).call(this,t)},onMove:a.onMove||o,onTouchEnd:a.onTouchEnd||o,onEnd:function(a){a.moved||t.call(this,e)}}),{noMove:!0}))})}function j(e,t){return'<div class="'+e+'">'+(t||"")+"</div>"}function N(e){for(var t=e.length;t;){var a=Math.floor(Math.random()*t--),i=e[t];e[t]=e[a],e[a]=i}return e}function R(e){return"[object Array]"==Object.prototype.toString.call(e)&&i.map(e,function(e){return i.extend({},e)})}function U(e,t,a){e.scrollLeft(t||0).scrollTop(a||0)}function H(e){if(e){var t={};return i.each(e,function(e,a){t[e.toLowerCase()]=a}),t}}function q(e){if(e){var t=+e;return isNaN(t)?(t=e.split("/"),+t[0]/+t[1]||n):t}}function V(e,t,a,i){t&&(e.addEventListener?e.addEventListener(t,a,!!i):e.attachEvent("on"+t,a))}function W(e){return!!e.getAttribute("disabled")}function Y(e){return{tabindex:-1*e+"",disabled:e}}function Q(e,t){V(e,"keyup",function(a){W(e)||13==a.keyCode&&t.call(e,a)})}function G(e,t){V(e,"focus",e.onfocusin=function(a){t.call(e,a)},!0)}function K(e,t){e.preventDefault?e.preventDefault():e.returnValue=!1,t&&e.stopPropagation&&e.stopPropagation()}function J(e){return e?">":"<"}function X(e){return e=(e+"").split(/\s+/),{x:m(e[0])||ta,y:m(e[1])||ta}}function Z(e,t){var a=e.data(),n=Math.round(t.pos),r=function(){a.sliding=!1,(t.onEnd||o)()};"undefined"!=typeof t.overPos&&t.overPos!==t.pos&&(n=t.overPos,r=function(){Z(e,i.extend({},t,{overPos:t.pos,time:Math.max(Ut,t.time/2)}))});var s=i.extend(c(n),t.width&&{width:t.width});a.sliding=!0,zt?(e.css(i.extend(p(t.time),s)),t.time>10?b(e,"transform",r,t.time):r()):e.stop().animate(s,t.time,Zt,r)}function ee(e,t,a,n,r,s){var d="undefined"!=typeof s;if(d||(r.push(arguments),Array.prototype.push.call(arguments,r.length),!(r.length>1))){e=e||i(e),t=t||i(t);var l=e[0],c=t[0],p="crossfade"===n.method,u=function(){if(!u.done){u.done=!0;var e=(d||r.shift())&&r.shift();e&&ee.apply(this,e),(n.onEnd||o)(!!e)}},f=n.time/(s||1);a.removeClass(He+" "+Ue),e.stop().addClass(He),t.stop().addClass(Ue),p&&c&&e.fadeTo(0,0),e.fadeTo(p?f:0,1,p&&u),t.fadeTo(f,0,u),l&&p||c||u()}}function te(e){var t=(e.touches||[])[0]||e;e._x=t.pageX,e._y=t.clientY,e._now=i.now()}function ae(e,a){function n(e){return u=i(e.target),b.checked=_=m=v=!1,c||b.flow||e.touches&&e.touches.length>1||e.which>1||na&&na.type!==e.type&&oa||(_=a.select&&u.is(a.select,w))?_:(h="touchstart"===e.type,m=u.is("a, a *",w),f=b.control,g=b.noMove||b.noSwipe||f?16:b.snap?0:4,te(e),p=na=e,ra=e.type.replace(/down|start/,"move").replace(/Down/,"Move"),(a.onStart||o).call(w,e,{control:f,$target:u}),c=b.flow=!0,void((!h||b.go)&&K(e)))}function r(e){if(e.touches&&e.touches.length>1||jt&&!e.isPrimary||ra!==e.type||!c)return c&&s(),void(a.onTouchEnd||o)();te(e);var t=Math.abs(e._x-p._x),i=Math.abs(e._y-p._y),n=t-i,r=(b.go||b.x||n>=0)&&!b.noSwipe,d=0>n;h&&!b.checked?(c=r)&&K(e):(K(e),(a.onMove||o).call(w,e,{touch:h})),!v&&Math.sqrt(Math.pow(t,2)+Math.pow(i,2))>g&&(v=!0),b.checked=b.checked||r||d}function s(e){(a.onTouchEnd||o)();var t=c;b.control=c=!1,t&&(b.flow=!1),!t||m&&!b.checked||(e&&K(e),oa=!0,clearTimeout(sa),sa=setTimeout(function(){oa=!1},1e3),(a.onEnd||o).call(w,{moved:v,$target:u,control:f,touch:h,startEvent:p,aborted:!e||"MSPointerCancel"===e.type}))}function d(){b.flow||setTimeout(function(){b.flow=!0},10)}function l(){b.flow&&setTimeout(function(){b.flow=!1},Rt)}var c,p,u,f,h,_,m,g,v,w=e[0],b={};return jt?(V(w,"MSPointerDown",n),V(t,"MSPointerMove",r),V(t,"MSPointerCancel",s),V(t,"MSPointerUp",s)):(V(w,"touchstart",n),V(w,"touchmove",r),V(w,"touchend",s),V(t,"touchstart",d),V(t,"touchend",l),V(t,"touchcancel",l),It.on("scroll",l),e.on("mousedown",n),Pt.on("mousemove",r).on("mouseup",s)),e.on("click","a",function(e){b.checked&&K(e)}),b}function ie(e,t){function a(a,i){C=!0,l=p=a._x,m=a._now,_=[[m,l]],u=f=E.noMove||i?0:y(e,(t.getPos||o)()),(t.onStart||o).call(S,a)}function n(e,t){v=E.min,w=E.max,b=E.snap,k=e.altKey,C=x=!1,M=t.control,M||T.sliding||a(e)}function r(i,n){E.noSwipe||(C||a(i),p=i._x,_.push([i._now,p]),f=u-(l-p),h=F(f,v,w),v>=f?f=$(f,v):f>=w&&(f=$(f,w)),E.noMove||(e.css(c(f)),x||(x=!0,n.touch||jt||e.addClass(nt)),(t.onMove||o).call(S,i,{pos:f,edge:h})))}function d(n){if(!E.noSwipe||!n.moved){C||a(n.startEvent,!0),n.touch||jt||e.removeClass(nt),g=i.now();for(var r,d,l,c,h,m,y,$,M,x=g-Rt,T=null,I=Ut,P=t.friction,A=_.length-1;A>=0;A--){if(r=_[A][0],d=Math.abs(r-x),null===T||l>d)T=r,c=_[A][1];else if(T===x||d>l)break;l=d}y=s(f,v,w);var D=c-p,z=D>=0,B=g-T,F=B>Rt,O=!F&&f!==u&&y===f;b&&(y=s(Math[O?z?"floor":"ceil":"round"](f/b)*b,v,w),v=w=y),O&&(b||y===f)&&(M=-(D/B),I*=s(Math.abs(M),t.timeLow,t.timeHigh),h=Math.round(f+M*I/P),b||(y=h),(!z&&h>w||z&&v>h)&&(m=z?v:w,$=h-m,b||(y=m),$=s(y+.03*$,m-50,m+50),I=Math.abs((f-$)/(M/P)))),I*=k?10:1,(t.onEnd||o).call(S,i.extend(n,{moved:n.moved||F&&b,pos:f,newPos:y,overPos:$,time:I}))}}var l,p,u,f,h,_,m,g,v,w,b,k,M,x,C,S=e[0],T=e.data(),E={};return E=i.extend(ae(t.$wrap,i.extend({},t,{onStart:n,onMove:r,onEnd:d})),E)}function ne(e,t){var a,n,r,s=e[0],d={prevent:{}};return V(s,Nt,function(e){var s=e.wheelDeltaY||-1*e.deltaY||0,l=e.wheelDeltaX||-1*e.deltaX||0,c=Math.abs(l)&&!Math.abs(s),p=J(0>l),u=n===p,f=i.now(),h=Rt>f-r;n=p,r=f,c&&d.ok&&(!d.prevent[p]||a)&&(K(e,!0),a&&u&&h||(t.shift&&(a=!0,clearTimeout(d.t),d.t=setTimeout(function(){a=!1},Ht)),(t.onEnd||o)(e,t.shift?p:l)))}),d}function re(){i.each(i.Fotorama.instances,function(e,t){t.index=e})}function oe(e){i.Fotorama.instances.push(e),re()}function se(e){i.Fotorama.instances.splice(e.index,1),re()}var de="fotorama",le="fullscreen",ce=de+"__wrap",pe=ce+"--css2",ue=ce+"--css3",fe=ce+"--video",he=ce+"--fade",_e=ce+"--slide",me=ce+"--no-controls",ge=ce+"--no-shadows",ve=ce+"--pan-y",we=ce+"--rtl",be=ce+"--only-active",ye=ce+"--no-captions",ke=ce+"--toggle-arrows",$e=de+"__stage",Me=$e+"__frame",xe=Me+"--video",Ce=$e+"__shaft",Se=de+"__grab",Te=de+"__pointer",Ee=de+"__arr",Ie=Ee+"--disabled",Pe=Ee+"--prev",Ae=Ee+"--next",De=de+"__nav",ze=De+"-wrap",Be=De+"__shaft",Fe=De+"--dots",Oe=De+"--thumbs",Le=De+"__frame",je=Le+"--dot",Ne=Le+"--thumb",Re=de+"__fade",Ue=Re+"-front",He=Re+"-rear",qe=de+"__shadow",Ve=qe+"s",We=Ve+"--left",Ye=Ve+"--right",Qe=de+"__active",Ge=de+"__select",Ke=de+"--hidden",Je=de+"--fullscreen",Xe=de+"__fullscreen-icon",Ze=de+"__error",et=de+"__loading",tt=de+"__loaded",at=tt+"--full",it=tt+"--img",nt=de+"__grabbing",rt=de+"__img",ot=rt+"--full",st=de+"__dot",dt=de+"__thumb",lt=dt+"-border",ct=de+"__html",pt=de+"__video",ut=pt+"-play",ft=pt+"-close",ht=de+"__caption",_t=de+"__caption__wrap",mt=de+"__spinner",gt='" tabindex="0" role="button',vt=i&&i.fn.jquery.split(".");if(!vt||vt[0]<1||1==vt[0]&&vt[1]<8)throw"Fotorama requires jQuery 1.8 or later and will not run without it.";var wt={},bt=function(e,t,a){function i(e){g.cssText=e}function n(e,t){return typeof e===t}function r(e,t){return!!~(""+e).indexOf(t)}function o(e,t){for(var i in e){var n=e[i];if(!r(n,"-")&&g[n]!==a)return"pfx"!=t||n}return!1}function s(e,t,i){for(var r in e){var o=t[e[r]];if(o!==a)return i===!1?e[r]:n(o,"function")?o.bind(i||t):o}return!1}function d(e,t,a){var i=e.charAt(0).toUpperCase()+e.slice(1),r=(e+" "+b.join(i+" ")+i).split(" ");return n(t,"string")||n(t,"undefined")?o(r,t):(r=(e+" "+y.join(i+" ")+i).split(" "),s(r,t,a))}var l,c,p,u="2.6.2",f={},h=t.documentElement,_="modernizr",m=t.createElement(_),g=m.style,v=({}.toString," -webkit- -moz- -o- -ms- ".split(" ")),w="Webkit Moz O ms",b=w.split(" "),y=w.toLowerCase().split(" "),k={},$=[],M=$.slice,x=function(e,a,i,n){var r,o,s,d,l=t.createElement("div"),c=t.body,p=c||t.createElement("body");if(parseInt(i,10))for(;i--;)s=t.createElement("div"),s.id=n?n[i]:_+(i+1),l.appendChild(s);return r=["&#173;",'<style id="s',_,'">',e,"</style>"].join(""),l.id=_,(c?l:p).innerHTML+=r,p.appendChild(l),c||(p.style.background="",p.style.overflow="hidden",d=h.style.overflow,h.style.overflow="hidden",h.appendChild(p)),o=a(l,e),c?l.parentNode.removeChild(l):(p.parentNode.removeChild(p),h.style.overflow=d),!!o},C={}.hasOwnProperty;p=n(C,"undefined")||n(C.call,"undefined")?function(e,t){return t in e&&n(e.constructor.prototype[t],"undefined")}:function(e,t){return C.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var a=M.call(arguments,1),i=function(){if(this instanceof i){var n=function(){};n.prototype=t.prototype;var r=new n,o=t.apply(r,a.concat(M.call(arguments)));return Object(o)===o?o:r}return t.apply(e,a.concat(M.call(arguments)))};return i}),k.csstransforms3d=function(){var e=!!d("perspective");return e};for(var S in k)p(k,S)&&(c=S.toLowerCase(),f[c]=k[S](),$.push((f[c]?"":"no-")+c));return f.addTest=function(e,t){if("object"==typeof e)for(var i in e)p(e,i)&&f.addTest(i,e[i]);else{if(e=e.toLowerCase(),f[e]!==a)return f;t="function"==typeof t?t():t,"undefined"!=typeof enableClasses&&enableClasses&&(h.className+=" "+(t?"":"no-")+e),f[e]=t}return f},i(""),m=l=null,f._version=u,f._prefixes=v,f._domPrefixes=y,f._cssomPrefixes=b,f.testProp=function(e){return o([e])},f.testAllProps=d,f.testStyles=x,f.prefixed=function(e,t,a){return t?d(e,t,a):d(e,"pfx")},f}(e,t),yt={ok:!1,is:function(){return!1},request:function(){},cancel:function(){},event:"",prefix:""},kt="webkit moz o ms khtml".split(" ");if("undefined"!=typeof t.cancelFullScreen)yt.ok=!0;else for(var $t=0,Mt=kt.length;Mt>$t;$t++)if(yt.prefix=kt[$t],"undefined"!=typeof t[yt.prefix+"CancelFullScreen"]){yt.ok=!0;break}yt.ok&&(yt.event=yt.prefix+"fullscreenchange",yt.is=function(){switch(this.prefix){case"":return t.fullScreen;case"webkit":return t.webkitIsFullScreen;default:return t[this.prefix+"FullScreen"]}},yt.request=function(e){return""===this.prefix?e.requestFullScreen():e[this.prefix+"RequestFullScreen"]()},yt.cancel=function(){return""===this.prefix?t.cancelFullScreen():t[this.prefix+"CancelFullScreen"]()});var xt,Ct={lines:12,length:5,width:2,radius:7,corners:1,rotate:15,color:"rgba(128, 128, 128, .75)",hwaccel:!0},St={top:"auto",left:"auto",className:""};!function(e,t){xt=t()}(this,function(){function e(e,a){var i,n=t.createElement(e||"div");for(i in a)n[i]=a[i];return n}function a(e){for(var t=1,a=arguments.length;a>t;t++)e.appendChild(arguments[t]);return e}function i(e,t,a,i){var n=["opacity",t,~~(100*e),a,i].join("-"),r=.01+a/i*100,o=Math.max(1-(1-e)/t*(100-r),e),s=u.substring(0,u.indexOf("Animation")).toLowerCase(),d=s&&"-"+s+"-"||"";return h[n]||(_.insertRule("@"+d+"keyframes "+n+"{0%{opacity:"+o+"}"+r+"%{opacity:"+e+"}"+(r+.01)+"%{opacity:1}"+(r+t)%100+"%{opacity:"+e+"}100%{opacity:"+o+"}}",_.cssRules.length),h[n]=1),n}function r(e,t){var a,i,r=e.style;for(t=t.charAt(0).toUpperCase()+t.slice(1),i=0;i<f.length;i++)if(a=f[i]+t,r[a]!==n)return a;return r[t]!==n?t:void 0}function o(e,t){for(var a in t)e.style[r(e,a)||a]=t[a];return e}function s(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)e[i]===n&&(e[i]=a[i])}return e}function d(e){for(var t={x:e.offsetLeft,y:e.offsetTop};e=e.offsetParent;)t.x+=e.offsetLeft,t.y+=e.offsetTop;return t}function l(e,t){return"string"==typeof e?e:e[t%e.length]}function c(e){return"undefined"==typeof this?new c(e):void(this.opts=s(e||{},c.defaults,m))}function p(){function t(t,a){return e("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',a)}_.addRule(".spin-vml","behavior:url(#default#VML)"),c.prototype.lines=function(e,i){function n(){return o(t("group",{coordsize:c+" "+c,coordorigin:-d+" "+-d}),{width:c,height:c})}function r(e,r,s){a(u,a(o(n(),{rotation:360/i.lines*e+"deg",left:~~r}),a(o(t("roundrect",{arcsize:i.corners}),{width:d,height:i.width,left:i.radius,top:-i.width>>1,filter:s}),t("fill",{color:l(i.color,e),opacity:i.opacity}),t("stroke",{opacity:0}))))}var s,d=i.length+i.width,c=2*d,p=2*-(i.width+i.length)+"px",u=o(n(),{position:"absolute",top:p,left:p});if(i.shadow)for(s=1;s<=i.lines;s++)r(s,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(s=1;s<=i.lines;s++)r(s);return a(e,u)},c.prototype.opacity=function(e,t,a,i){var n=e.firstChild;i=i.shadow&&i.lines||0,n&&t+i<n.childNodes.length&&(n=n.childNodes[t+i],n=n&&n.firstChild,n=n&&n.firstChild,n&&(n.opacity=a))}}var u,f=["webkit","Moz","ms","O"],h={},_=function(){var i=e("style",{type:"text/css"});return a(t.getElementsByTagName("head")[0],i),i.sheet||i.styleSheet}(),m={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};c.defaults={},s(c.prototype,{spin:function(t){this.stop();var a,i,n=this,r=n.opts,s=n.el=o(e(0,{className:r.className}),{position:r.position,width:0,zIndex:r.zIndex}),l=r.radius+r.length+r.width;if(t&&(t.insertBefore(s,t.firstChild||null),i=d(t),a=d(s),o(s,{left:("auto"==r.left?i.x-a.x+(t.offsetWidth>>1):parseInt(r.left,10)+l)+"px",top:("auto"==r.top?i.y-a.y+(t.offsetHeight>>1):parseInt(r.top,10)+l)+"px"})),s.setAttribute("role","progressbar"),n.lines(s,n.opts),!u){var c,p=0,f=(r.lines-1)*(1-r.direction)/2,h=r.fps,_=h/r.speed,m=(1-r.opacity)/(_*r.trail/100),g=_/r.lines;!function e(){p++;for(var t=0;t<r.lines;t++)c=Math.max(1-(p+(r.lines-t)*g)%_*m,r.opacity),n.opacity(s,t*r.direction+f,c,r);n.timeout=n.el&&setTimeout(e,~~(1e3/h))}()}return n},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=n),this},lines:function(t,n){function r(t,a){return o(e(),{position:"absolute",width:n.length+n.width+"px",height:n.width+"px",background:t,boxShadow:a,transformOrigin:"left",transform:"rotate("+~~(360/n.lines*d+n.rotate)+"deg) translate("+n.radius+"px,0)",borderRadius:(n.corners*n.width>>1)+"px"})}for(var s,d=0,c=(n.lines-1)*(1-n.direction)/2;d<n.lines;d++)s=o(e(),{position:"absolute",top:1+~(n.width/2)+"px",transform:n.hwaccel?"translate3d(0,0,0)":"",opacity:n.opacity,animation:u&&i(n.opacity,n.trail,c+d*n.direction,n.lines)+" "+1/n.speed+"s linear infinite"}),n.shadow&&a(s,o(r("#000","0 0 4px #000"),{top:"2px"})),a(t,a(s,r(l(n.color,d),"0 0 1px rgba(0,0,0,.1)")));return t},opacity:function(e,t,a){t<e.childNodes.length&&(e.childNodes[t].style.opacity=a)}});var g=o(e("group"),{behavior:"url(#default#VML)"});return!r(g,"transform")&&g.adj?p():u=r(g,"animation"),c});var Tt,Et,It=i(e),Pt=i(t),At="quirks"===a.hash.replace("#",""),Dt=bt.csstransforms3d,zt=Dt&&!At,Bt=Dt||"CSS1Compat"===t.compatMode,Ft=yt.ok,Ot=navigator.userAgent.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone/i),Lt=!zt||Ot,jt=navigator.msPointerEnabled,Nt="onwheel"in t.createElement("div")?"wheel":t.onmousewheel!==n?"mousewheel":"DOMMouseScroll",Rt=250,Ut=300,Ht=1400,qt=5e3,Vt=2,Wt=64,Yt=500,Qt=333,Gt="$stageFrame",Kt="$navDotFrame",Jt="$navThumbFrame",Xt="auto",Zt=r([.1,0,.25,1]),ea=99999,ta="50%",aa={width:null,minwidth:null,maxwidth:"100%",height:null,minheight:null,maxheight:null,ratio:null,margin:Vt,glimpse:0,fit:"contain",position:ta,thumbposition:ta,nav:"dots",navposition:"bottom",navwidth:null,thumbwidth:Wt,thumbheight:Wt,thumbmargin:Vt,thumbborderwidth:Vt,thumbfit:"cover",allowfullscreen:!1,transition:"slide",clicktransition:null,transitionduration:Ut,captions:!0,hash:!1,startindex:0,
loop:!1,autoplay:!1,stopautoplayontouch:!0,keyboard:!1,arrows:!0,click:!0,swipe:!0,trackpad:!1,enableifsingleframe:!1,controlsonstart:!0,shuffle:!1,direction:"ltr",shadows:!0,spinner:null},ia={left:!0,right:!0,down:!1,up:!1,space:!1,home:!1,end:!1};A.stop=function(e){A.ii[e]=!1};var na,ra,oa,sa;jQuery.Fotorama=function(e,n){function r(){i.each(Ma,function(e,t){if(!t.i){t.i=ui++;var a=C(t.video,!0);if(a){var i={};t.video=a,t.img||t.thumb?t.thumbsReady=!0:i=S(t,Ma,di),T(Ma,{img:i.img,thumb:i.thumb},t.i,di)}}})}function o(e){return Ja[e]||di.fullScreen}function d(e){var t="keydown."+de,a=de+li,i="keydown."+a,r="resize."+a+" orientationchange."+a;e?(Pt.on(i,function(e){var t,a;Ta&&27===e.keyCode?(t=!0,ua(Ta,!0,!0)):(di.fullScreen||n.keyboard&&!di.index)&&(27===e.keyCode?(t=!0,di.cancelFullScreen()):e.shiftKey&&32===e.keyCode&&o("space")||37===e.keyCode&&o("left")||38===e.keyCode&&o("up")?a="<":32===e.keyCode&&o("space")||39===e.keyCode&&o("right")||40===e.keyCode&&o("down")?a=">":36===e.keyCode&&o("home")?a="<<":35===e.keyCode&&o("end")&&(a=">>")),(t||a)&&K(e),a&&di.show({index:a,slow:e.altKey,user:!0})}),di.index||Pt.off(t).on(t,"textarea, input, select",function(e){!Et.hasClass(le)&&e.stopPropagation()}),It.on(r,di.resize)):(Pt.off(i),It.off(r))}function l(t){t!==l.f&&(t?(e.html("").addClass(de+" "+ci).append(mi).before(hi).before(_i),oe(di)):(mi.detach(),hi.detach(),_i.detach(),e.html(fi.urtext).removeClass(ci),se(di)),d(t),l.f=t)}function u(){Ma=di.data=Ma||R(n.data)||E(e),xa=di.size=Ma.length,!$a.ok&&n.shuffle&&N(Ma),r(),Bi=M(Bi),xa&&l(!0)}function h(){var e=2>xa&&!n.enableifsingleframe||Ta;Li.noMove=e||qa,Li.noSwipe=e||!n.swipe,!Qa&&vi.toggleClass(Se,!n.click&&!Li.noMove&&!Li.noSwipe),jt&&mi.toggleClass(ve,!Li.noSwipe)}function w(e){e===!0&&(e=""),n.autoplay=Math.max(+e||qt,1.5*Ya)}function b(){function e(e,a){t[e?"add":"remove"].push(a)}di.options=n=H(n),qa="crossfade"===n.transition||"dissolve"===n.transition,La=n.loop&&(xa>2||qa&&(!Qa||"slide"!==Qa)),Ya=+n.transitionduration||Ut,Ka="rtl"===n.direction,Ja=i.extend({},n.keyboard&&ia,n.keyboard);var t={add:[],remove:[]};xa>1||n.enableifsingleframe?(ja=n.nav,Ra="top"===n.navposition,t.remove.push(Ge),ki.toggle(!!n.arrows)):(ja=!1,ki.hide()),He(),Sa=new xt(i.extend(Ct,n.spinner,St,{direction:Ka?-1:1})),At(),Dt(),n.autoplay&&w(n.autoplay),Va=f(n.thumbwidth)||Wt,Wa=f(n.thumbheight)||Wt,ji.ok=Ri.ok=n.trackpad&&!Lt,h(),na(n,[Oi]),Na="thumbs"===ja,Na?(pt(xa,"navThumb"),Ca=Si,si=Jt,B(hi,i.Fotorama.jst.style({w:Va,h:Wa,b:n.thumbborderwidth,m:n.thumbmargin,s:li,q:!Bt})),Mi.addClass(Oe).removeClass(Fe)):"dots"===ja?(pt(xa,"navDot"),Ca=Ci,si=Kt,Mi.addClass(Fe).removeClass(Oe)):(ja=!1,Mi.removeClass(Oe+" "+Fe)),ja&&(Ra?$i.insertBefore(gi):$i.insertAfter(gi),kt.nav=!1,kt(Ca,xi,"nav")),Ua=n.allowfullscreen,Ua?(Ei.prependTo(gi),Ha=Ft&&"native"===Ua):(Ei.detach(),Ha=!1),e(qa,he),e(!qa,_e),e(!n.captions,ye),e(Ka,we),e("always"!==n.arrows,ke),Ga=n.shadows&&!Lt,e(!Ga,ge),mi.addClass(t.add.join(" ")).removeClass(t.remove.join(" ")),Fi=i.extend({},n)}function $(e){return 0>e?(xa+e%xa)%xa:e>=xa?e%xa:e}function M(e){return s(e,0,xa-1)}function x(e){return La?$(e):M(e)}function I(e){return!!(e>0||La)&&e-1}function W(e){return!!(xa-1>e||La)&&e+1}function X(){Li.min=La?-1/0:-g(xa-1,Oi.w,n.margin,Pa),Li.max=La?1/0:-g(0,Oi.w,n.margin,Pa),Li.snap=Oi.w+n.margin}function te(){Ni.min=Math.min(0,Oi.nw-xi.width()),Ni.max=0,xi.toggleClass(Se,!(Ni.noMove=Ni.min===Ni.max))}function ae(e,t,a){if("number"==typeof e){e=new Array(e);var n=!0}return i.each(e,function(e,i){if(n&&(i=e),"number"==typeof i){var r=Ma[$(i)];if(r){var o="$"+t+"Frame",s=r[o];a.call(this,e,i,r,s,o,s&&s.data())}}})}function re(e,t,a,i){(!Xa||"*"===Xa&&i===Oa)&&(e=m(n.width)||m(e)||Yt,t=m(n.height)||m(t)||Qt,di.resize({width:e,ratio:n.ratio||a||e/t},0,i!==Oa&&"*"))}function Re(e,t,a,r,o,s){ae(e,t,function(e,d,l,c,p,u){function f(e){var t=$(d);ra(e,{index:t,src:k,frame:Ma[t]})}function h(){w.remove(),i.Fotorama.cache[k]="error",l.html&&"stage"===t||!M||M===k?(!k||l.html||g?"stage"===t&&(c.trigger("f:load").removeClass(et+" "+Ze).addClass(tt),f("load"),re()):(c.trigger("f:error").removeClass(et).addClass(Ze),f("error")),u.state="error",!(xa>1&&Ma[d]===l)||l.html||l.deleted||l.video||g||(l.deleted=!0,di.splice(d,1))):(l[y]=k=M,Re([d],t,a,r,o,!0))}function _(){i.Fotorama.measures[k]=b.measures=i.Fotorama.measures[k]||{width:v.width,height:v.height,ratio:v.width/v.height},re(b.measures.width,b.measures.height,b.measures.ratio,d),w.off("load error").addClass(rt+(g?" "+ot:"")).prependTo(c),z(w,(i.isFunction(a)?a():a)||Oi,r||l.fit||n.fit,o||l.position||n.position),i.Fotorama.cache[k]=u.state="loaded",setTimeout(function(){c.trigger("f:load").removeClass(et+" "+Ze).addClass(tt+" "+(g?at:it)),"stage"===t?f("load"):(l.thumbratio===Xt||!l.thumbratio&&n.thumbratio===Xt)&&(l.thumbratio=b.measures.ratio,ya())},0)}function m(){var e=10;A(function(){return!ri||!e--&&!Lt},function(){_()})}if(c){var g=di.fullScreen&&l.full&&l.full!==l.img&&!u.$full&&"stage"===t;if(!u.$img||s||g){var v=new Image,w=i(v),b=w.data();u[g?"$full":"$img"]=w;var y="stage"===t?g?"full":"img":"thumb",k=l[y],M=g?null:l["stage"===t?"thumb":"img"];if("navThumb"===t&&(c=u.$wrap),!k)return void h();i.Fotorama.cache[k]?!function e(){"error"===i.Fotorama.cache[k]?h():"loaded"===i.Fotorama.cache[k]?setTimeout(m,0):setTimeout(e,100)}():(i.Fotorama.cache[k]="*",w.on("load",m).on("error",h)),u.state="",v.src=k}}})}function Ue(e){zi.append(Sa.spin().el).appendTo(e)}function He(){zi.detach(),Sa&&Sa.stop()}function qe(){var e=Ea[Gt];e&&!e.data().state&&(Ue(e),e.on("f:load f:error",function(){e.off("f:load f:error"),He()}))}function nt(e){Q(e,va),G(e,function(){setTimeout(function(){U(Mi)},0),Ht({time:Ya,guessIndex:i(this).data().eq,minMax:Ni})})}function pt(e,t){ae(e,t,function(e,a,n,r,o,s){if(!r){r=n[o]=mi[o].clone(),s=r.data(),s.data=n;var d=r[0];"stage"===t?(n.html&&i('<div class="'+ct+'"></div>').append(n._html?i(n.html).removeAttr("id").html(n._html):n.html).appendTo(r),n.caption&&i(j(ht,j(_t,n.caption))).appendTo(r),n.video&&r.addClass(xe).append(Pi.clone()),G(d,function(){setTimeout(function(){U(gi)},0),_a({index:s.eq,user:!0})}),wi=wi.add(r)):"navDot"===t?(nt(d),Ci=Ci.add(r)):"navThumb"===t&&(nt(d),s.$wrap=r.children(":first"),Si=Si.add(r),n.video&&s.$wrap.append(Pi.clone()))}})}function vt(e,t,a,i){return e&&e.length&&z(e,t,a,i)}function wt(e){ae(e,"stage",function(e,t,a,r,o,s){if(r){var d=$(t),l=a.fit||n.fit,c=a.position||n.position;s.eq=d,Hi[Gt][d]=r.css(i.extend({left:qa?0:g(t,Oi.w,n.margin,Pa)},qa&&p(0))),P(r[0])&&(r.appendTo(vi),ua(a.$video)),vt(s.$img,Oi,l,c),vt(s.$full,Oi,l,c)}})}function bt(e,t){if("thumbs"===ja&&!isNaN(e)){var a=-e,r=-e+Oi.nw;Si.each(function(){var e=i(this),o=e.data(),s=o.eq,d=function(){return{h:Wa,w:o.w}},l=d(),c=Ma[s]||{},p=c.thumbfit||n.thumbfit,u=c.thumbposition||n.thumbposition;l.w=o.w,o.l+o.w<a||o.l>r||vt(o.$img,l,p,u)||t&&Re([s],"navThumb",d,p,u)})}}function kt(e,t,a){if(!kt[a]){var r="nav"===a&&Na,o=0;t.append(e.filter(function(){for(var e,t=i(this),a=t.data(),n=0,r=Ma.length;r>n;n++)if(a.data===Ma[n]){e=!0,a.eq=n;break}return e||t.remove()&&!1}).sort(function(e,t){return i(e).data().eq-i(t).data().eq}).each(function(){if(r){var e=i(this),t=e.data(),a=Math.round(Wa*t.data.thumbratio)||Va;t.l=o,t.w=a,e.css({width:a}),o+=a+n.thumbmargin}})),kt[a]=!0}}function $t(e){return e-qi>Oi.w/3}function Mt(e){return!(La||Bi+e&&Bi-xa+e||Ta)}function At(){var e=Mt(0),t=Mt(1);bi.toggleClass(Ie,e).attr(Y(e)),yi.toggleClass(Ie,t).attr(Y(t))}function Dt(){ji.ok&&(ji.prevent={"<":Mt(0),">":Mt(1)})}function Ot(e){var t,a,i=e.data();return Na?(t=i.l,a=i.w):(t=e.position().left,a=e.width()),{c:t+a/2,min:-t+10*n.thumbmargin,max:-t+Oi.w-a-10*n.thumbmargin}}function Nt(e){var t=Ea[si].data();Z(Ti,{time:1.2*e,pos:t.l,width:t.w-2*n.thumbborderwidth})}function Ht(e){var t=Ma[e.guessIndex][si];if(t){var a=Ni.min!==Ni.max,i=e.minMax||a&&Ot(Ea[si]),n=a&&(e.keep&&Ht.l?Ht.l:s((e.coo||Oi.nw/2)-Ot(t).c,i.min,i.max)),r=a&&s(n,Ni.min,Ni.max),o=1.1*e.time;Z(xi,{time:o,pos:r||0,onEnd:function(){bt(r,!0)}}),pa(Mi,F(r,Ni.min,Ni.max)),Ht.l=n}}function Vt(){Zt(si),Ui[si].push(Ea[si].addClass(Qe))}function Zt(e){for(var t=Ui[e];t.length;)t.shift().removeClass(Qe)}function ta(e){var t=Hi[e];i.each(Ia,function(e,a){delete t[$(a)]}),i.each(t,function(e,a){delete t[e],a.detach()})}function aa(e){Pa=Aa=Bi;var t=Ea[Gt];t&&(Zt(Gt),Ui[Gt].push(t.addClass(Qe)),e||di.show.onEnd(!0),y(vi,0,!0),ta(Gt),wt(Ia),X(),te())}function na(e,t){e&&i.each(t,function(t,a){a&&i.extend(a,{width:e.width||a.width,height:e.height,minwidth:e.minwidth,maxwidth:e.maxwidth,minheight:e.minheight,maxheight:e.maxheight,ratio:q(e.ratio)})})}function ra(t,a){e.trigger(de+":"+t,[di,a])}function oa(){clearTimeout(sa.t),ri=1,n.stopautoplayontouch?di.stopAutoplay():ai=!0}function sa(){ri&&(n.stopautoplayontouch||(da(),la()),sa.t=setTimeout(function(){ri=0},Ut+Rt))}function da(){ai=!(!Ta&&!ii)}function la(){if(clearTimeout(la.t),A.stop(la.w),!n.autoplay||ai)return void(di.autoplay&&(di.autoplay=!1,ra("stopautoplay")));di.autoplay||(di.autoplay=!0,ra("startautoplay"));var e=Bi,t=Ea[Gt].data();la.w=A(function(){return t.state||e!==Bi},function(){la.t=setTimeout(function(){if(!ai&&e===Bi){var t=Fa,a=Ma[t][Gt].data();la.w=A(function(){return a.state||t!==Fa},function(){ai||t!==Fa||di.show(La?J(!Ka):Fa)})}},n.autoplay)})}function ca(){di.fullScreen&&(di.fullScreen=!1,Ft&&yt.cancel(pi),Et.removeClass(le),Tt.removeClass(le),e.removeClass(Je).insertAfter(_i),Oi=i.extend({},ni),ua(Ta,!0,!0),ga("x",!1),di.resize(),Re(Ia,"stage"),U(It,ei,Za),ra("fullscreenexit"))}function pa(e,t){Ga&&(e.removeClass(We+" "+Ye),t&&!Ta&&e.addClass(t.replace(/^|\s/g," "+Ve+"--")))}function ua(e,t,a){t&&(mi.removeClass(fe),Ta=!1,h()),e&&e!==Ta&&(e.remove(),ra("unloadvideo")),a&&(da(),la())}function fa(e){mi.toggleClass(me,e)}function ha(e){if(!Li.flow){var t=e?e.pageX:ha.x,a=t&&!Mt($t(t))&&n.click;ha.p!==a&&gi.toggleClass(Te,a)&&(ha.p=a,ha.x=t)}}function _a(e){clearTimeout(_a.t),n.clicktransition&&n.clicktransition!==n.transition?setTimeout(function(){var t=n.transition;di.setOptions({transition:n.clicktransition}),Qa=t,_a.t=setTimeout(function(){di.show(e)},10)},0):di.show(e)}function ma(e,t){var a=e.target,r=i(a);r.hasClass(ut)?di.playVideo():a===Ii?di.toggleFullScreen():Ta?a===Di&&ua(Ta,!0,!0):t?fa():n.click&&_a({index:e.shiftKey||J($t(e._x)),slow:e.altKey,user:!0})}function ga(e,t){Li[e]=Ni[e]=t}function va(e){var t=i(this).data().eq;_a({index:t,slow:e.altKey,user:!0,coo:e._x-Mi.offset().left})}function wa(e){_a({index:ki.index(this)?">":"<",slow:e.altKey,user:!0})}function ba(e){G(e,function(){setTimeout(function(){U(gi)},0),fa(!1)})}function ya(){if(u(),b(),!ya.i){ya.i=!0;var e=n.startindex;(e||n.hash&&a.hash)&&(Oa=O(e||a.hash.replace(/^#/,""),Ma,0===di.index||e,e)),Bi=Pa=Aa=Da=Oa=x(Oa)||0}if(xa){if(ka())return;Ta&&ua(Ta,!0),Ia=[],ta(Gt),ya.ok=!0,di.show({index:Bi,time:0}),di.resize()}else di.destroy()}function ka(){return!ka.f===Ka?(ka.f=Ka,Bi=xa-1-Bi,di.reverse(),!0):void 0}function $a(){$a.ok||($a.ok=!0,ra("ready"))}Tt=i("html"),Et=i("body");var Ma,xa,Ca,Sa,Ta,Ea,Ia,Pa,Aa,Da,za,Ba,Fa,Oa,La,ja,Na,Ra,Ua,Ha,qa,Va,Wa,Ya,Qa,Ga,Ka,Ja,Xa,Za,ei,ti,ai,ii,ni,ri,oi,si,di=this,li=i.now(),ci=de+li,pi=e[0],ui=1,fi=e.data(),hi=i("<style></style>"),_i=i(j(Ke)),mi=i(j(ce)),gi=i(j($e)).appendTo(mi),vi=(gi[0],i(j(Ce)).appendTo(gi)),wi=i(),bi=i(j(Ee+" "+Pe+gt)),yi=i(j(Ee+" "+Ae+gt)),ki=bi.add(yi).appendTo(gi),$i=i(j(ze)),Mi=i(j(De)).appendTo($i),xi=i(j(Be)).appendTo(Mi),Ci=i(),Si=i(),Ti=(vi.data(),xi.data(),i(j(lt)).appendTo(xi)),Ei=i(j(Xe+gt)),Ii=Ei[0],Pi=i(j(ut)),Ai=i(j(ft)).appendTo(gi),Di=Ai[0],zi=i(j(mt)),Bi=!1,Fi={},Oi={},Li={},ji={},Ni={},Ri={},Ui={},Hi={},qi=0,Vi=[];mi[Gt]=i(j(Me)),mi[Jt]=i(j(Le+" "+Ne+gt,j(dt))),mi[Kt]=i(j(Le+" "+je+gt,j(st))),Ui[Gt]=[],Ui[Jt]=[],Ui[Kt]=[],Hi[Gt]={},mi.addClass(zt?ue:pe).toggleClass(me,!n.controlsonstart),fi.fotorama=this,di.startAutoplay=function(e){return di.autoplay?this:(ai=ii=!1,w(e||n.autoplay),la(),this)},di.stopAutoplay=function(){return di.autoplay&&(ai=ii=!0,la()),this},di.show=function(e){var t;"object"!=typeof e?(t=e,e={}):t=e.index,t=">"===t?Aa+1:"<"===t?Aa-1:"<<"===t?0:">>"===t?xa-1:t,t=isNaN(t)?O(t,Ma,!0):t,t="undefined"==typeof t?Bi||0:t,di.activeIndex=Bi=x(t),za=I(Bi),Ba=W(Bi),Fa=$(Bi+(Ka?-1:1)),Ia=[Bi,za,Ba],Aa=La?t:Bi;var a=Math.abs(Da-Aa),i=k(e.time,function(){return Math.min(Ya*(1+(a-1)/12),2*Ya)}),r=e.overPos;e.slow&&(i*=10);var o=Ea;di.activeFrame=Ea=Ma[Bi];var d=o===Ea&&!e.user;ua(Ta,Ea.i!==Ma[$(Pa)].i),pt(Ia,"stage"),wt(Lt?[Aa]:[Aa,I(Aa),W(Aa)]),ga("go",!0),d||ra("show",{user:e.user,time:i}),ai=!0;var l=di.show.onEnd=function(t){if(!l.ok){if(l.ok=!0,t||aa(!0),d||ra("showend",{user:e.user}),!t&&Qa&&Qa!==n.transition)return di.setOptions({transition:Qa}),void(Qa=!1);qe(),Re(Ia,"stage"),ga("go",!1),Dt(),ha(),da(),la()}};if(qa){var c=Ea[Gt],p=Bi!==Da?Ma[Da][Gt]:null;ee(c,p,wi,{time:i,method:n.transition,onEnd:l},Vi)}else Z(vi,{pos:-g(Aa,Oi.w,n.margin,Pa),overPos:r,time:i,onEnd:l});if(At(),ja){Vt();var u=M(Bi+s(Aa-Da,-1,1));Ht({time:i,coo:u!==Bi&&e.coo,guessIndex:"undefined"!=typeof e.coo?u:Bi,keep:d}),Na&&Nt(i)}return ti="undefined"!=typeof Da&&Da!==Bi,Da=Bi,n.hash&&ti&&!di.eq&&D(Ea.id||Bi+1),this},di.requestFullScreen=function(){return Ua&&!di.fullScreen&&(Za=It.scrollTop(),ei=It.scrollLeft(),U(It),ga("x",!0),ni=i.extend({},Oi),e.addClass(Je).appendTo(Et.addClass(le)),Tt.addClass(le),ua(Ta,!0,!0),di.fullScreen=!0,Ha&&yt.request(pi),di.resize(),Re(Ia,"stage"),qe(),ra("fullscreenenter")),this},di.cancelFullScreen=function(){return Ha&&yt.is()?yt.cancel(t):ca(),this},di.toggleFullScreen=function(){return di[(di.fullScreen?"cancel":"request")+"FullScreen"]()},V(t,yt.event,function(){!Ma||yt.is()||Ta||ca()}),di.resize=function(e){if(!Ma)return this;var t=arguments[1]||0,a=arguments[2];na(di.fullScreen?{width:"100%",maxwidth:null,minwidth:null,height:"100%",maxheight:null,minheight:null}:H(e),[Oi,a||di.fullScreen||n]);var i=Oi.width,r=Oi.height,o=Oi.ratio,d=It.height()-(ja?Mi.height():0);return m(i)&&(mi.addClass(be).css({width:i,minWidth:Oi.minwidth||0,maxWidth:Oi.maxwidth||ea}),i=Oi.W=Oi.w=mi.width(),Oi.nw=ja&&_(n.navwidth,i)||i,n.glimpse&&(Oi.w-=Math.round(2*(_(n.glimpse,i)||0))),vi.css({width:Oi.w,marginLeft:(Oi.W-Oi.w)/2}),r=_(r,d),r=r||o&&i/o,r&&(i=Math.round(i),r=Oi.h=Math.round(s(r,_(Oi.minheight,d),_(Oi.maxheight,d))),gi.stop().animate({width:i,height:r},t,function(){mi.removeClass(be)}),aa(),ja&&(Mi.stop().animate({width:Oi.nw},t),Ht({guessIndex:Bi,time:t,keep:!0}),Na&&kt.nav&&Nt(t)),Xa=a||!0,$a())),qi=gi.offset().left,this},di.setOptions=function(e){return i.extend(n,e),ya(),this},di.shuffle=function(){return Ma&&N(Ma)&&ya(),this},di.destroy=function(){return di.cancelFullScreen(),di.stopAutoplay(),Ma=di.data=null,l(),Ia=[],ta(Gt),ya.ok=!1,this},di.playVideo=function(){var e=Ea,t=e.video,a=Bi;return"object"==typeof t&&e.videoReady&&(Ha&&di.fullScreen&&di.cancelFullScreen(),A(function(){return!yt.is()||a!==Bi},function(){a===Bi&&(e.$video=e.$video||i(i.Fotorama.jst.video(t)),e.$video.appendTo(e[Gt]),mi.addClass(fe),Ta=e.$video,h(),ki.blur(),Ei.blur(),ra("loadvideo"))})),this},di.stopVideo=function(){return ua(Ta,!0,!0),this},gi.on("mousemove",ha),Li=ie(vi,{onStart:oa,onMove:function(e,t){pa(gi,t.edge)},onTouchEnd:sa,onEnd:function(e){pa(gi);var t=(jt&&!oi||e.touch)&&n.arrows&&"always"!==n.arrows;if(e.moved||t&&e.pos!==e.newPos&&!e.control){var a=v(e.newPos,Oi.w,n.margin,Pa);di.show({index:a,time:qa?Ya:e.time,overPos:e.overPos,user:!0})}else e.aborted||e.control||ma(e.startEvent,t)},timeLow:1,timeHigh:1,friction:2,select:"."+Ge+", ."+Ge+" *",$wrap:gi}),Ni=ie(xi,{onStart:oa,onMove:function(e,t){pa(Mi,t.edge)},onTouchEnd:sa,onEnd:function(e){function t(){Ht.l=e.newPos,da(),la(),bt(e.newPos,!0)}if(e.moved)e.pos!==e.newPos?(ai=!0,Z(xi,{time:e.time,pos:e.newPos,overPos:e.overPos,onEnd:t}),bt(e.newPos),Ga&&pa(Mi,F(e.newPos,Ni.min,Ni.max))):t();else{var a=e.$target.closest("."+Le,xi)[0];a&&va.call(a,e.startEvent)}},timeLow:.5,timeHigh:2,friction:5,$wrap:Mi}),ji=ne(gi,{shift:!0,onEnd:function(e,t){oa(),sa(),di.show({index:t,slow:e.altKey})}}),Ri=ne(Mi,{onEnd:function(e,t){oa(),sa();var a=y(xi)+.25*t;xi.css(c(s(a,Ni.min,Ni.max))),Ga&&pa(Mi,F(a,Ni.min,Ni.max)),Ri.prevent={"<":a>=Ni.max,">":a<=Ni.min},clearTimeout(Ri.t),Ri.t=setTimeout(function(){Ht.l=a,bt(a,!0)},Rt),bt(a)}}),mi.hover(function(){setTimeout(function(){ri||fa(!(oi=!0))},0)},function(){oi&&fa(!(oi=!1))}),L(ki,function(e){K(e),wa.call(this,e)},{onStart:function(){oa(),Li.control=!0},onTouchEnd:sa}),ki.each(function(){Q(this,function(e){wa.call(this,e)}),ba(this)}),Q(Ii,di.toggleFullScreen),ba(Ii),i.each("load push pop shift unshift reverse sort splice".split(" "),function(e,t){di[t]=function(){return Ma=Ma||[],"load"!==t?Array.prototype[t].apply(Ma,arguments):arguments[0]&&"object"==typeof arguments[0]&&arguments[0].length&&(Ma=R(arguments[0])),ya(),di}}),ya()},i.fn.fotorama=function(t){return this.each(function(){var a=this,n=i(this),r=n.data(),o=r.fotorama;o?o.setOptions(t,!0):A(function(){return!I(a)},function(){r.urtext=n.html(),new i.Fotorama(n,i.extend({},aa,e.fotoramaDefaults,t,r))})})},i.Fotorama.instances=[],i.Fotorama.cache={},i.Fotorama.measures={},i=i||{},i.Fotorama=i.Fotorama||{},i.Fotorama.jst=i.Fotorama.jst||{},i.Fotorama.jst.style=function(e){var t,a="";return wt.escape,a+=".fotorama"+(null==(t=e.s)?"":t)+" .fotorama__nav--thumbs .fotorama__nav__frame{\npadding:"+(null==(t=e.m)?"":t)+"px;\nheight:"+(null==(t=e.h)?"":t)+"px}\n.fotorama"+(null==(t=e.s)?"":t)+" .fotorama__thumb-border{\nheight:"+(null==(t=e.h-e.b*(e.q?0:2))?"":t)+"px;\nborder-width:"+(null==(t=e.b)?"":t)+"px;\nmargin-top:"+(null==(t=e.m)?"":t)+"px}"},i.Fotorama.jst.video=function(e){function t(){a+=i.call(arguments,"")}var a="",i=(wt.escape,Array.prototype.join);return a+='<div class="fotorama__video"><iframe src="',t(("youtube"==e.type?e.p+"youtube.com/embed/"+e.id+"?autoplay=1":"vimeo"==e.type?e.p+"player.vimeo.com/video/"+e.id+"?autoplay=1&badge=0":e.id)+(e.s&&"custom"!=e.type?"&"+e.s:"")),a+='" frameborder="0" allowfullscreen></iframe></div>\n'},i(function(){i("."+de+':not([data-auto="false"])').fotorama()})}(window,document,location,"undefined"!=typeof jQuery&&jQuery),function(){function e(){this.location="",this.sitesAjax=null,this._used_domains=[],this.siteExpandSpeed=200,this.siteExpandMargins=20,this.tarifMaxSites=0,this.tarifMaxPages=0,this.tarifMaxDomains=0,this.countDomains=0,this.tarifCurSites=0,this.sitePrice=0,this.userSiteCount=0,this.draggingSiteData={},this.hasTariffDaily=!1,this.urlToTariffs="profile/tarifs",this.in_preview=!1,this.max_file_fields=null,this.siteIsEnabled=null,this.is_ready=!1,this.isEditor=a.hasClass("body_pages_edit")}function t(){this.ajaxHandlers={},this.flagIsReady=!1,this.isReady=function(){return this.flagIsReady};var e=this;this.init=function(t){e.id=t.form_id,e.el=document.getElementById(e.id),e.$el=$(e.el),e.initial_screen_id=$(".initial-screen").attr("id"),e.current_screen_id=e.initial_screen_id,e.previous_screen_id=e.initial_screen_id,e.$tpl_field=e.$el.find("#"+e.id+"__tpl"),e.$tpl_preview_field=e.$el.find("#tpl-id-in-preview"),e.$empty_tpl_field=e.$el.find("#"+e.id+"__empty_tpl"),e.$phone_field=e.$el.find("#"+e.id+"__phone"),e.$phone_output_error=e.$el.find("#sp6_create_site_output_phone_error"),e.$phone_continue_btn=e.$el.find(".create-phone-next-btn"),e.$name_field=e.$el.find("#"+e.id+"__name"),e.$phone_field.on("change",function(){e.$phone_output_error.empty(),e.validatePhone()}),e.$el.on("submit",function(t){if(!e._is_allow_submit)return t.preventDefault(),!1}),e.$el.on("click",".sp6-go-to-step",function(){var t,a=$(this),i=a.attr("data-actions").toString().split(",");for(t=0;t<i.length;t++)switch(i[t]){case"ajax":var n=a.attr("data-ajax-handler");e.runAjaxHandler(n);break;case"showPreviousScreen":e.previous_screen_id!=e.current_screen_id&&e.showScreen(e.previous_screen_id);break;case"showScreen":switch(e.current_screen_id){case"sp6_create_site_input_name":tracerSendEvent("creating site: typed name",{first:0==sitesMan.userSiteCount})}var r=a.attr("data-carrot-event");if(r&&r.length>0&&analyticSendEvent(r),!1===e.showScreen(a.attr("data-screen-id")))return!1;break;case"setCategoryFilter":if(0==e.setCategoryFilter(a))return!1;break;case"setTpl":var o=a.attr("data-site");if(0==e.setTpl(o))return!1;tracerSendEvent("chose site template",{"template id":o,first:0==sitesMan.userSiteCount});break;case"setEmptyTpl":"sp6_create_site_generator"!==a.attr("data-screen-id")&&tracerSendEvent("creating site screen",{type:"empty"}),e.$empty_tpl_field.val(0),funnelEvent(3,12);break;case"setNeedTpl":e.$empty_tpl_field.val(1),funnelEvent(2,6);break;case"showCalcScreen":switch(e.initial_screen_id){case"sp6_create_site_init":if(0==e.showScreen(0==e.$empty_tpl_field.val()?"sp6_create_site_init":"sp6_create_site_choose_tpl"))return!1;break;case"sp6_create_site_init_new":if(e.showScreen(0==e.$empty_tpl_field.val()?"sp6_create_site_init_new":"sp6_create_site_choose_tpl_new"))return!1}break;case"back":e.fixBack();break;case"closePreviewTpl":sitesMan.closePreviewTpl();break;case"backAfterCreateOnlyEmptySiteAfterSignUp":1==$.cookie("is_after_signup")&&($.removeCookie("is_after_signup",{path:"/"}),e.previous_screen_id="sp6_create_site_init_HADI1",e.current_screen_id="sp6_create_site_input_phone"),e.previous_screen_id!=e.current_screen_id&&e.showScreen(e.previous_screen_id);break;case"setTplFromPreview":var o=e.$tpl_preview_field.val();if(0==e.setTpl(o))return!1;tracerSendEvent("chose site template",{"template id":o,first:0==sitesMan.userSiteCount}),sitesMan.closePreviewTpl();break;case"clearPhone":e.$phone_field.val("");break;case"submit":switch(e.current_screen_id){case"sp6_create_site_input_name":tracerSendEvent("creating site: typed name",{first:0==sitesMan.userSiteCount});break;case"sp6_create_site_input_phone":tracerSendEvent("creating site: typed phone",{first:0==sitesMan.userSiteCount,typed:$("#frm2__phone").val().trim().length>10?1:0})}if("sp6_create_site_generator"==e.current_screen_id)GenSiteTpl.redirectToCreateSite();else if("sp6_create_site_generator"==e.previous_screen_id){if(!e.validatePhone())return!1;GenSiteTpl.redirectToCreateSite()}else e.submit(a);return a=null,!1;case"loadTpls":e.loadVisibleTpls(a);break;case"loadGenerator":var s=$("#generator-content");"0"==s.attr("data-ready")&&$.ajax({url:window.baseUrl+"sites/generator/action:get_html",type:"POST",cache:!1,dataType:"json",timeout:4e4,success:function(e){e.res&&1==e.res&&(s.html(e.html).attr("data-ready","1"),s=null)}})}return a=null,!1}),this.flagIsReady=!0,FE.runAndClr("create_page_form/ready")},this.fixBack=function(){switch(!0){case"block"==$("#sp6_create_site_init").css("display"):sitesMan.goToSites();break;case"block"==$("#sp6_create_site_input_name").css("display"):e.showScreen("sp6_create_site_input_phone");break;case"block"==$("#sp6_create_site_input_phone").css("display"):e.submit($("#sp6_create_site_input_phone .btn-1.sp6-go-to-step"))}},this.setTpl=function(t){return!!t&&(e.$tpl_field.val(t),e.$empty_tpl_field.val(1),!0)},this.validateName=function(){return!0},this.validatePhone=function(){var t=phoneHelper.formatPhoneToNumeric(e.$phone_field.val());if(0===t.length)return!0;var a=phoneHelper.validatePhone(t);return!(a.length>0)||(e.$phone_output_error.html('<div class="ui_error">'+a+"</div>"),!1)},this.submit=function(t){return!t.hasClass("disabled")&&(!!e.validateName()&&(!!e.validatePhone()&&(t.addClass("disabled"),e.$tpl_preview_field.remove(),e._is_allow_submit=!0,lockScreen("Создание сайта...",{show_animation:!0}),"1"==e.$empty_tpl_field.val()&&(userHasTag("stop-73")||!userHasTag("LPDEV-73-b")&&!userHasTag("LPDEV-73-c")||sitesMan.createSiteInHybrid()&&$(e.el).attr("target","converting-iframe")),e.el.submit(),!1)))},this.setCategoryFilter=function(t){var i=t.attr("data-class"),n=i.match(/[\d]*$/),r=sitesMan.$tplsList.children(".not-loaded."+i);e.$el.find(".btn-category.selected").removeClass("selected"),sitesMan.$tplsList.removeClass(),sitesMan.$tplsList.addClass("clearfix show_"+i),t.addClass("selected");for(var o=0;o<7&&r[o];o++)sitesMan.loadSiteTplImage(r[o]);return n.length&&n[0].length&&tracerSendEvent("chose site templates category",{"category id":n[0],first:0==sitesMan.userSiteCount}),a.scrollTop(0),r=null,!0},this.showScreen=function(t){if(!t)return!1;var a=!1;switch(t){case"sp6_create_site_init":break;case"sp6_create_site_init_new":break;case"sp6_create_site_input_name":break;case"sp6_create_site_input_phone":window.phoneMask&&(a=!0)}return e.$el.find("#"+e.current_screen_id).fadeOut(100,function(){e.$el.find("#"+t).fadeIn(100,function(){switch(e.previous_screen_id=e.current_screen_id,e.current_screen_id=t,t){case"sp6_create_site_generator":tracerSendEvent("creating site screen",{type:"generator"});break;case"sp6_create_site_input_name":e.$name_field.focus();break;case"sp6_create_site_input_phone":if(a){window.phoneMask.init();var i=window.phoneMask.getPhoneCountry();i?window.phoneMask.applyMask(i):window.phoneMask.applyMask("rus")}else e.$phone_field.focus();tracerSendEvent("creating site: phone screen");break;case"sp6_create_site_choose_tpl":tracerSendEvent("creating site screen",{type:"templates"})}})}),!0},this.loadVisibleTpls=function(e){var t=$(".tpls-list-to-load"),a=e.attr("data-cat-id");t.attr("class",t.attr("class").replace(/show_cat_(all|[0-9]+)/g,"").replace(/\s+/g," ")),t.addClass("show_cat_"+a);var i=t.find(".site-preview-template.not-loaded.cat_"+a);i.length>0&&ImgListLoader.create(i,{onload_callback:function(){var e=$(this);e.closest(".site-preview-template").removeClass("not-loaded")}}).run()},this.setAjaxHandler=function(e,t){this.ajaxHandlers[e]=t},this.runAjaxHandler=function(e){if(!this.ajaxHandlers[e])throw new Error("Не существующее имя обработчика [#3557]");this.ajaxHandlers[e]()}}var a=$("body");e.prototype.setUrlToTariffs=function(e){this.urlToTariffs=e.replace(window.baseUrl,"")},e.prototype.ready=function(){consoleDbg("INIT: sites man"),this.$sitesList=$("#sites_list1"),this.$is_tpl_changed=$("#frmnotifymail__is_tpl_changed"),this.initSiteHeaderClick(),this.bindOpengraphEvents(),this.initEditSiteName(),this.initQuiz(null,!0),this.enableQuizNav(),this.initIphone(),this.is_ready=!0,FE.runAndClr("sitesMan/ready")},e.prototype.isReady=function(){return this.is_ready},e.prototype.initSiteHeaderClick=function(){this.$sitesList.children(".one_site").find(".site_expander a").click(function(){var e=$(this).closest(".one_site"),t=e.attr("id").replace("site-",""),a=$.cookie("sites_expanded");isset(a)||(a=""),e.hasClass("collapsed")?(-1==a.indexOf(t)&&(a+=","+t),e.removeClass("collapsed")):(-1!==a.indexOf(t)&&(a=a.replace(t,"")),e.addClass("collapsed")),a=a.replace(/[,]+/g,","),a=a.replace(/^[,]+/,""),setStateCookie("sites_expanded",a),a=e=t=null})},e.prototype.initSiteTabs=function(){this.$sitesList.children(".one_site").find(".one_site_tabs .td_one_site_tab").click(function(){$(this).parent().children(".td_one_site_tab.sel").removeClass("sel"),$(this).addClass("sel"),$(this).closest(".one_site_cont").find(".one_site_tabcont > .one_site_tab").hide().filter("#"+$(this).attr("tab")).show()}),this.$sitesList.find(".one_site").find(".one_site_tabs .td_one_site_tab:first").click()},e.prototype.initSiteLinks=function(){this.$sitesList.find(".site_links a").click(function(){return"undefined"==typeof $(this).data("clicked")&&($(this).animate({paddingLeft:26},100,function(){$(this).addClass("loading")}),$(this).data("clicked",!0),!0)})},e.prototype.collapseAllSites=function(){$(".one_site").addClass("collapsed"),setStateCookie("sites_expanded","")},e.prototype.initStatChart=function(e,t,a){$("#"+e).highcharts({chart:{type:"column",renderTo:"container",showAxes:!0,style:{fontSize:"16"},spacingTop:0,spacingRight:0,spacingBottom:10,spacingLeft:0,height:"250",width:"668"},title:{text:"Посещаемость сайта"},credits:{enabled:!1},xAxis:{categories:t,gridLineWidth:1,gridLineColor:"#EDEDED",tickmarkPlacement:"on",min:0,max:30,labels:{step:2}},scrollbar:{enabled:!0},yAxis:{title:{text:"Посетители",style:{fontFamily:"Verdana",color:"#CCC",fontWeight:"normal"}},labels:{step:1},gridLineColor:"#EDEDED"},series:[{name:"Посетителей",data:a}],tooltip:{headerFormat:'<span style="font-size: 14px">{point.key}</span><br/>',pointFormat:'<span style="font-size: 14px">{series.name} <b>{point.y}</b></span>',useHTML:!0},plotOptions:{column:{animation:!1}},legend:{enabled:!1},colors:["#C3B0FA"]})},e.prototype.initDatePiker=function(e){"string"==typeof e&&(e=$(e)),e.datepicker({showAnim:"show",prevText:"Предыдущий месяц",nextText:"Следующий месяц",monthNames:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],dayNamesMin:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],dateFormat:"http://s.lpmcdn.com/web/build/pages/dd.mm.yy",firstDay:1,showButtonPanel:!0,currentText:"Сегодня",closeText:"Закрыть",constrainInput:!0,beforeShow:function(e,t){$(e).attr("disabled","disabled").blur()},onClose:function(e,t){$(this).removeAttr("disabled")}})},e.prototype.sendDeclarationForm=function(e){var t=$(e),a=t.closest("form"),i=a.attr("id"),n={},r={};n.sum=a.find('input[name="'+i+'[sum]"]'),n.d_start=a.find('input[name="'+i+'[date_start]"]'),n.d_end=a.find('input[name="'+i+'[date_end]"]'),n.check=a.find('input[name="'+i+'[avg_check]"]'),n.conv=a.find('input[name="'+i+'[conversion]"]');for(var o in n)if("d_start"==o||"d_end"==o){var s=n[o].val().match(/^(\d{2})\.(\d{2})\.(\d{4})$/);if(!s)return alert("Необходимо ввести правильную дату"),void n[o].focus();r[o]=parseInt(s[3]+s[2]+s[1])}else if(r[o]=n[o].val(),!n[o].val().match(/^\d+$/))return alert("Необходимо ввести правильное число"),void n[o].focus();return r.d_start>r.d_end?void alert("Дата начала должна быть раньше даты окончания"):void $.ajax({url:window.baseUrl+"sites/ajax/frm:frmdeclaration/id:"+i,type:"POST",cache:!1,dataType:"json",data:a.serialize(),timeout:4e4})},e.prototype.changeDeclaration=function(e){var t=$(e).closest(".declaration_view");t.hide(),t.prev(".declaration_edit_form").show()},e.prototype.cancelDeclarationEditting=function(e){var t=$(e).closest(".declaration_edit_form");t.hide(),t.next(".declaration_view").show()},e.prototype.createSiteChooseTpl=function(e){var t=$(e);t.closest("#tpls_list").children(".active").removeClass("active"),t.closest(".one_tpl").addClass("active"),t=null},e.prototype.createInit=function(){$("#frmonesite__empty_tpl input[type=radio]").click(function(){var e=$("#tpls_list"),t=$("#sites_create_blk"),a=$("#td_before_btn"),i=e.find(".one_tpl");t.is(":animated")||(1==parseInt($(this).val())?803>t.width()&&!e.is(":visible")&&(i.hide(),e.show(),t.animate({width:803},600,function(){$("#tpls_list .one_tpl").show()}),a.animate({width:0},600)):e.is(":visible")&&(i.hide(),e.hide(),t.animate({width:700},600),a.animate({width:60},600))),e=t=a=i=null}),helpSlider("#tplslide_helper")},e.prototype.createSiteCheckboxEmptyClick=function(){var e=$("#frmonesite__empty_tpl input[type=radio]:checked"),t=$("#sites_create_blk"),a=$("#td_before_btn");1==e.val()?(e.show(),t.animate({width:803},600),a.animate({width:0},600)):(e.hide(),t.animate({width:700},600),a.animate({width:60},600)),e=t=a=null},e.prototype.initNewList=function(){$("#sitesTutorialVideo").wind("setShowFunc",function(e){var t=e.$el.find(".wind-body"),a=e.$el.find(".pat");return t.html("<iframe "+a.html()+"></iframe>"),t=a=null,!0}).wind("setAfterCloseFunc",function(e){return e.$el.find(".wind-body").html(""),setcookie("sites_tutorial_closed",1,(new Date).getTime()+2592e3,"/"),!0}),sitesMan.initSiteListSortable(),sitesMan.initSitesWithAccess(),sitesMan.initSiteListOld()},e.prototype.initSiteListSortable=function(){$(".tbody_sites").length>0&&$(".tbody_sites").sortable({connectWith:".tbody_sites",handle:".site_lbl",placeholder:"sort_ph",opacity:1,cursor:"move",tolerance:"pointer",dropOnEmpty:!0,start:function(e,t){$(this).sortable("refreshPositions"),t.placeholder.addClass("tr_site fnt2").html('<td colspan="6"><div>ПОМЕСТИТЬ САЙТ ЗДЕСЬ</div></td>'),
t.helper.css({width:"auto",height:"auto"}),sitesMan.draggingSiteData[t.item.attr("id-site")]={parent:t.item.parent(),prev:t.item.prev(),item:t.item},sitesMan._used_domains=sitesMan.getUsedDomains(),projectManager.startDragSite()},stop:function(e,t){if(projectManager.stopDragSite(),null!==sitesMan.sitesAjax)return jAlert("Подождите, когда завершится предыдущая команда перемещения."),void sitesMan.moveSiteBack(t.item.attr("id-site"));var a=t.item.closest(".iblk").attr("id");if(sitesMan.tarifMaxPages>0&&"iblk-monthly"==a&&sitesMan.getMonthlyPagesCount()>sitesMan.tarifMaxPages)sitesMan.moveSiteBack(t.item.attr("id-site")),sitesMan.alertTarifIsFull(sitesMan.tarifMaxPages);else if(sitesMan.tarifMaxDomains>0&&t.item.attr("data-root_domain")&&-1==$.inArray(t.item.attr("data-root_domain"),sitesMan._used_domains)&&"iblk-monthly"==a&&sitesMan.getActiveDomainsCount()>sitesMan.tarifMaxDomains)sitesMan.moveSiteBack(t.item.attr("id-site")),sitesMan.alertDomainsLimitIsFull(sitesMan.tarifMaxDomains);else if("iblk-daily"==a){var i=parseInt(t.item.attr("last-pay"));isNaN(i)||i<sitesMan.curCronDate?sitesMan.alertDailySiteNeedPayment(function(){sitesMan.updateSiteSwitch(t.item,a),sitesMan.recountSitesPos()},function(){sitesMan.moveSiteBack(t.item.attr("id-site"))}):(sitesMan.updateSiteSwitch(t.item,a),sitesMan.recountSitesPos())}else sitesMan.updateSiteSwitch(t.item,a),sitesMan.recountSitesPos();a=null},over:function(e,t){sitesMan.showHideEmptyBlocks(),sitesMan.recountDailyExpense()}})},e.prototype.initSitesWithAccess=function(){var e=$(".tbody_sites_draggable");e.length&&e.sortable({connectWith:".user-projects__droppable",handle:".site_lbl",placeholder:"sort_ph",opacity:1,cursor:"move",tolerance:"pointer",dropOnEmpty:!0,start:function(e,t){t.placeholder.addClass("tr_site fnt2").html('<td colspan="5"><div>ПОМЕСТИТЬ САЙТ ЗДЕСЬ</div></td>'),t.helper.css({width:"auto",height:"auto"}),projectManager.startDragSite()},stop:function(e,t){projectManager.stopDragSite()},over:function(e,t){sitesMan.showHideEmptyBlocks()}}),"undefined"!=typeof access&&(access.onAddAccess=function(){var e=access.accessData.site_id,t=$(".access-site[site_id="+e+"]");if(t.hasClass("hidden"))t.removeClass("hidden").prev().addClass("hidden"),t.children(".count-access").html("1");else{var a=parseInt(t.children(".count-access").html());t.children(".count-access").html(a+1)}},access.onRemoveAccess=function(e){var t=$(".access-site[site_id="+e+"]");if(t.hasClass("hidden"));else{var a=parseInt(t.children(".count-access").text().trim());isNaN(a)||a-1<=0?(t.addClass("hidden").prev().removeClass("hidden"),t.children(".count-access").text(" ")):t.children(".count-access").text(a-1)}}),$(document).on("click",".info-new-access",function(e){e.preventDefault(),e.stopPropagation();var t=$(this),a=t.children(".popup_info"),i=function(e){$(".popup_info").hide(),$(document).unbind("click",i)};"block"==a.css("display")?$(document).unbind("click",i):($(".popup_info").hide(),a.show(),$(document).bind("click",i))}),$(document).on("click",".add-new-access",function(){access.data.site_id=$(this).attr("site_id"),access.addEmailAccess()}),$(document).on("click",".access-site",function(){access.data.site_id=$(this).attr("site_id"),$.get(window.baseUrl+"access/ajax/frm:getsiteaccess/id:"+access.data.site_id,function(e){var t=$("#myModal"),a=t.find(".access-user-item.hidden"),i=$(".tr_site[id-site="+access.data.site_id+"] .site_name_h span");if(t.find(".access-site-name").text(i.text()),t.find(".access-user-item:not(.hidden, .add)").remove(),t.modal(),e.hasOwnProperty("accesses"))for(var n=0,r=e.accesses.length;n<r;n++){var o=a.clone().removeClass("hidden"),s=e.accesses[n].email;a.before(o),o.children(".access-user-item__email").html(s)}})}),$(document).on("click",".access-user-item:not(.add)",function(){var e=$(this).children(".access-user-item__email").html();$("#myModal").modal("hide"),access.accessData={email:e,site_id:access.data.site_id},access.openModal()})},e.prototype.initSiteListOld=function(){$(document).on("click",".vl-item",function(e){var t=0;$("input.vl-item").each(function(){$(this).prop("checked")&&t++}),t>1?$("#vl-btn-start").removeClass("disabled"):$("#vl-btn-start").addClass("disabled")}),$("#vl-btn-start").unbind("click").bind("click",function(){var e=[];$("input.vl-item").each(function(){$(this).prop("checked")&&e.push($(this).attr("id-site"))}),e.length>1&&(lockScreen(),$.ajax({url:window.baseUrl+window.siteId+"/sites/abtest",method:"post",data:{list:e,do:"set_list"},success:function(e){if(1==e){unlockScreen(),$("#Start_test").modal("hide");var t=$("#ABTestIsStarted");t.off("hidden.bs.modal").on("hidden.bs.modal",function(){lockScreen("Перезагружаем раздел",{show_animation:!0}),location.reload()}),t.modal("show")}else console.log(e)}}))}),$("#vl-btn-stop").unbind("click").bind("click",function(){lockScreen(),$.ajax({url:window.baseUrl+window.siteId+"/sites/abtest",method:"post",data:{do:"stop"},success:function(e){1==e?location.reload():console.log(e)}})}),$(".disable-variant").unbind("click").bind("click",function(){lockScreen(),$.ajax({url:window.baseUrl+window.siteId+"/sites/abtest",method:"post",data:{variant_id:$(this).closest(".abtest_item").attr("variant-id"),do:"disable_variant"},success:function(e){1==e?location.reload():console.log(e)}})}),$(".enable-variant").unbind("click").bind("click",function(){lockScreen(),$.ajax({url:window.baseUrl+window.siteId+"/sites/abtest",method:"post",data:{variant_id:$(this).closest(".abtest_item").attr("variant-id"),do:"enable_variant"},success:function(e){1==e?location.reload():console.log(e)}})}),$(".delete-variant").unbind("click").bind("click",function(){$("#vl-btn-delete").attr("variant-id",$(this).closest(".abtest_item").attr("variant-id")),$("#delete_variant").modal("show")}),$("#vl-btn-delete").unbind("click").bind("click",function(){lockScreen();var e=$(this).attr("variant-id");return $.ajax({url:window.baseUrl+window.siteId+"/sites/abtest",method:"post",data:{variant_id:e,do:"delete_variant"},success:function(t){1==t?sitesMan.afterVariantDelete(e):console.log(t)}}),!1}),$(".set-base-variant").unbind("click").bind("click",function(){lockScreen(),$.ajax({url:window.baseUrl+window.siteId+"/sites/abtest",method:"post",data:{variant_id:$(this).closest(".abtest_item").attr("variant-id"),do:"set_base_variant"},success:function(e){1==e?location.reload():console.log(e)}})}),this.curCronDate=null,this.dailyExpenseBlock=$("#daily_expense"),this.dailySitesList=$("#iblk-daily .tbody_sites:first"),this.monthlySitesList=$("#iblk-monthly .tbody_sites:first")},e.prototype.createEmptyVariant=function(e){return lockScreen("Создаем пустой вариант",{show_animation:!0,show_btn_close:!1}),window.location.href=window.baseUrl+siteId+"/sites/create_empty_variant/variant_for:"+e,!1},e.prototype.cloneVariant=function(e){return lockScreen("Копируем вариант",{show_animation:!0,show_btn_close:!1}),window.location.href=window.baseUrl+e+"/sites/clone_site/variant_for:"+siteId+"/redirect_to:tab_abtest",!1},e.prototype.cloneSiteFromVariant=function(e){return lockScreen("Копируем сайт",{show_animation:!0,show_btn_close:!1}),window.location.href=window.baseUrl+e+"/sites/clone_site/variant_for:"+siteId+"/redirect_to:tab_abtest/set_variant_for:"+siteId,!1},e.prototype.initEditSiteName=function(){$(document).on("click",".tr_site .site_name .site_name_h div.edit_name, .abtest_item .abtest_name .site_name_h div.edit_name",function(e){e.preventDefault(),e.stopPropagation();var t=$(this).closest(".site_name"),a=t.find(".site_name_edit .site_name_inp");window.siteList||a.val($(this).closest(".site_name_h").children("span").text().trim()),t.addClass("edit-mode"),a.focus(),t=a=null}),$(document).on("click",".tr_site .site_name .site_name_save",function(e){var t=$(this).closest(".site_name"),a=t.find(".site_name_edit .site_name_inp"),i=a.val().trim();a.val(i),i.length<=200&&i.length>0?(ajaxLoad({url:a.attr("site_id")+"/sites/ajax/frm:frmsitename",data:{frmsitename:{name:i},from_list:1}}),window.siteList||t.find(".site_name_h span").text(i),t.removeClass("edit-mode")):alert("Рабочее имя сайта не должно превышать 200 символов и обязательно к заполнению")}),$(document).on("click",".abtest_item .abtest_name .site_name_save",function(e){var t=$(this).closest(".site_name"),a=t.find(".site_name_edit .site_name_inp"),i=$(this).closest(".abtest_item").attr("variant-id"),n=a.val().trim();a.val(n),n.length<=200&&n.length>0?(ajaxLoad({url:a.attr("site_id")+"/sites/ajax/frm:frmvariantname",data:{frmvariantname:{name:n,variant_id:i},from_list:1}}),t.find(".site_name_h span").text(n),t.removeClass("edit-mode")):alert("Рабочее имя сайта не должно превышать 200 символов и обязательно к заполнению")}),$(document).on("click",".tr_site .site_name .site_name_rollback, .abtest_item .abtest_name .site_name_rollback",function(e){$(this).closest(".site_name").removeClass("edit-mode")})},e.prototype.alertDailySiteNeedPayment=function(e,t){jAlert('<div class="title_for_message">Этот сайт еще не публиковался сегодня</div><div class="text_for_message">За него сразу будет списана оплата за 1 день</div>',{width:600,btnCls:"btn-success",btnWidth:160,okText:"Продолжить",onOk:e||function(){},onCancel:t||function(){}})},e.prototype.alertOnlySiteOwner=function(e){var t="Это действие может совершить только владелец сайта!";switch(e){case"on_site_publish":t="Опубликовать сайт может только владелец!";break;case"off_site_publish":t="Отключить сайт может только владелец!"}jAlert('<div class="title_for_message">'+t+"</div>",{width:600,btnCls:"btn-success",btnWidth:160,okText:"Хорошо",onOk:function(){},onCancel:function(){}})},e.prototype.alertDomainsLimitIsFull=function(e){var t='<div class="img_for_message img_off"></div><div class="title_for_message">На текущем тарифе можно запустить <br/><strong>максимум '+e+" домен"+plural(e,"","а","ов")+'</strong></div><hr class="mv3"/><div class="text_for_message">Запустите сайт на поддомене или<br/>прикрепите к другому сайту как страницу.</br/>Также вы можете перейти на более "мощный" тариф.</div>';jAlert(t,{width:500,btnWidth:200,btnCls:"btn btn-success",okText:"Перейти к тарифам",headerText:"",onOk:function(){return mxt("btn balance",{"источник":mxGetSourceLink()}),setTimeout("goTo('"+sitesMan.urlToTariffs+"');",200),!1}})},e.prototype.alertTarifIsFull=function(e){var t='<div class="img_for_message img_off"></div><div class="title_for_message">На текущем тарифе можно запустить<br/><strong>максимум '+e+" сайт"+plural(e,"","а","ов")+'</strong></div><hr class="mv3"/><div class="text_for_message">Выключите один из сайтов или</br>перейдите на более высокий тариф.</div>';jAlert(t,{width:500,btnWidth:200,btnCls:"btn btn-success",okText:"Перейти к тарифам",headerText:"",alertClass:"alert-max-sites-constraint",onOk:function(){return mxt("btn balance",{"источник":mxGetSourceLink()}),setTimeout("goTo('"+sitesMan.urlToTariffs+"');",200),!1}})},e.prototype.alertTarifIsFullInTest=function(e){jAlert('<div class="img_for_message img_off"></div><p class="title_for_message">На текущем тарифе вы можете запустить<br/><strong> максимум '+e+" сайт"+plural(e,"","а","ов")+'</strong></p><hr/><div class="text_for_message"><a href="'+baseUrl+'sites/list">Выключите</a> один из сайтов </br> или </br>Перейдите на более "мощный" тариф  в разделе Баланс.</div>',{width:700,btnWidth:200,btnCls:"btn btn-success",okText:"Перейти в Баланс",headerText:"",onOk:function(){return mxt("btn balance",{"источник":mxGetSourceLink()}),setTimeout("goTo('profile/balance');",200),!1}})},e.prototype.moveSiteBack=function(e,t){if(this.draggingSiteData[e]&&(this.draggingSiteData[e].prev.length?this.draggingSiteData[e].item.insertAfter(this.draggingSiteData[e].prev):this.draggingSiteData[e].item.prependTo(this.draggingSiteData[e].parent),this.draggingSiteData[e].item.attr("cur-grp",this.draggingSiteData[e].item.closest(".iblk").attr("id"))),this.showHideEmptyBlocks(),this.recountDailyExpense(),"undefined"!=typeof t){for(var a in t)$(".tr_site[id-site="+a+"]").attr("pos",t[a]);a=null}},e.prototype.getMonthlySitesCount=function(){return isset(window.siteList)?siteList.getSitesList(window.SITES_LIST_PUBLISHED_BY_MONTHLY_TARIFF).length:this.monthlySitesList.children("tr.tr_site:not(.ui-sortable-helper):not(.sort_ph)").length},e.prototype.getMonthlyPagesCount=function(){return isset(window.siteList)?siteList.getSitesList(window.SITES_LIST_PUBLISHED_BY_MONTHLY_TARIFF).length:this.monthlySitesList.children("tr.tr_site:not(.ui-sortable-helper):not(.sort_ph)").length},e.prototype.getUsedDomains=function(){if(isset(window.siteList))return siteList.getUsedDomains();var e=[];return this.monthlySitesList.children("tr[data-root_domain]:not(.ui-sortable-helper):not(.sort_ph)").each(function(){var t=$(this).attr("data-root_domain");-1==$.inArray(t,e)&&e.push(t)}),e},e.prototype.getActiveDomainsCount=function(){return this.getUsedDomains().length},e.prototype.showHideEmptyBlocks=function(){var e=$(".tbody_sites .tr_empty, .tbody_sites_draggable .tr_empty");e.each(function(){var e=$(this);if("projects"==projectManager.getProjectsViewState()){var t=projectManager.currentProject.id,a=e.parent(),i=a.find(".tr_site[data-project-id="+t+"]:not(.ui-sortable-helper)"),n=a.find(".sort_ph:not(.hidden)");i.length||n.length?e.hide():e.show()}else e.parent().children("tr.tr_site:not(.ui-sortable-helper)").length>0?e.hide():e.show();e=null})},e.prototype.recountDailyExpense=function(){this.dailyExpenseBlock.length&&this.dailyExpenseBlock.text(this.dailySitesList.find(".tr_site:not(.ui-sortable-helper)").length*this.sitePrice)},e.prototype.recountSitesPos=function(){var e=null,t={},a=0,i=null,n=null,r=null,o=null;$("#sites_list").children(".iblk").each(function(){n=$(this).attr("id"),$(this).find(".tbody_sites .tr_site").each(function(o){++o,e=parseInt($(this).attr("pos")),r=$(this).attr("cur-grp"),(isNaN(e)||e!=o||n!=r)&&(i=parseInt($(this).attr("id-site")),isNaN(i)||(a++,t[i]={pos:o,oldPos:isNaN(e)?"":e,newParent:n},$(this).attr({pos:o,"cur-grp":n})))})}),a>0&&this.saveSitesPositions(t),e=t=a=i=n=r=o=null},e.prototype.saveSitesPositions=function(e,t,a){isset(a)||(a={list:e,from:this.location});var i=window.location.href.match(/user:(\d+)/);this.sitesAjax=ajaxLoad({url:"sites/ajax/frm:frmsitespos"+(null!==i?"/user:"+i[1]:""),data:a,onBeforeSuccess:function(e){return"undefined"!=typeof e.err?(e.error=e.err,e.res=0):0!=e.res||e.script||(e.error="Возникла ошибка [#4777]!"),!0},onSuccess:function(i,n){return 1==i.res&&i.mes&&"user_has_not_enough_money_for_activate_ssl"===i.mes?void sitesMan.notifyAboutUserHasNotEnoughMoneyForActivateSsl(i,function(){a.pay_for_ssl_has_approved_by_user=0,sitesMan.saveSitesPositions(e,t,a)}):1==i.res&&i.mes&&"site_ssl_cert_is_must_payment"===i.mes?void sitesMan.requestApproveByUserPayForSsl(i,function(i){a.pay_for_ssl_has_approved_by_user=i,sitesMan.saveSitesPositions(e,t,a)}):(1==i.res&&i.siteUrl&&i.siteUrlDecoded&&(trialTariff.showModal(i),isset(window.siteList)&&i.trialDays>0&&isset(i.tariff)&&siteList.$emit("sites-list--tariff-attached",i.tariff)),void(t&&"function"==typeof t&&t(i)))}})},e.prototype.requestApproveByUserPayForSsl=function(e,t){var a=e.useCase||"site_publishing";jConfirm("<p>"+("site_publishing"===a?"Вместе с активацией сайта":"Вместе с прикрепление домена")+" автоматически продлится SSL-сертификат за <strong>"+e.ssl_cert_price+" руб.</strong> на один месяц.</p>",{width:520,btnOkWidth:115,okText:"Принять",btnCancelWidth:300,cancelText:"site_publishing"===a?"Запустить сайт без SSL-сертификата":"Прикрепить домен без SSL-сертификата",headerText:"Продление SSL-сертификата",onOk:function(){t(1)},onCancel:function(){t(0)}})},e.prototype.notifyAboutUserHasNotEnoughMoneyForActivateSsl=function(e,t,a){var i=e.useCase||"site_publishing";jConfirm("<p>Пополните баланс на "+e.user_must_pay_amount+" рублей, чтобы к сайту "+e.site_domain+"<br>подключить SSL-сертификат на месяц.</p>",{width:550,btnOkWidth:154,okText:"Пополнить баланс",btnCancelWidth:300,cancelText:"site_publishing"===i?"Запустить сайт без SSL-сертификата":"Прикрепить домен без SSL-сертификата",headerText:"На балансе недостаточно средств",onOk:function(){setTimeout("goTo('profile/balance');",200),"function"==typeof a&&a()},onCancel:function(){t()}})},e.prototype.showNotEnoughMoneyForDailySite=function(e){jConfirm("<p>На вашем балансе недостаточно средств.</p><p>Для запуска сайта за <strong>"+e.substr(4,2)+"."+e.substr(2,2)+".20"+e.substr(0,2)+"</strong> нужно, чтобы на балансе было минимум <strong>"+number_format(this.sitePrice,0)+" руб</strong>.</p><p>Пополните баланс и повторите операцию.</p>",{okText:"Пополнить",btnWidth:110,onOk:function(){mxt("btn balance",{"источник":mxGetSourceLink()}),setTimeout("goTo('profile/balance');",200)}})},e.prototype.errTplPublish=function(){jAlert("<p>Данный сайт является шаблоном, его нельзя опубликовать.</p><p>Вы можете нажать на шестеренку, выбрать пункт &laquo;Клонировать&raquo; и уже клонированный сайт сможете опубликовать.</p>")},e.prototype.errNeedTariffAttach=function(){jAlert('<div class="img_for_message img_off mb2"></div><div class="title_for_message">Для запуска сайта вам нужно перейти в раздел &laquo;Баланс&raquo; и подключить тариф.</div>',{width:600,btnWidth:200,btnCls:"btn-success btn-alert-need-tarif",okText:"Перейти в Баланс",headerText:"Запуск сайта",alertClass:"alert-need-tarif",onOk:function(){mxt("btn balance",{"источник":mxGetSourceLink()}),setTimeout("goTo('"+sitesMan.urlToTariffs+"');",200)}})},e.prototype.onFaviconUpload=function(e,t){if(console.log(e.target.files[0]),!e.target.files[0].type.match(/^image\/(png|ico|x-icon|icon|vnd.microsoft.icon)/))return alert("Нужно выбрать картинку с расширением ICO или PNG."),!1;if(e.target.files[0].size>12e4)return void alert("Максимальный размер файла - 120 Кб.");0==$("#upload_target").length&&$("body").append('<iframe id="upload_target" name="upload_target" style="width:1px;height:1px;border:0;position:absolute;left:-9999px;visibility:hidden;"></iframe>');var a=$(t).closest("form");a.submit(),a=null},e.prototype.faviconUploadOk=function(e){$("img#favicon_img").attr("src",e.url),$(".favicon_edit").removeClass("empty")},e.prototype.goToSites=function(){location.href=window.baseUrl+"sites/list"},e.prototype.onSiteDelete=function(e,t,a){var i="Удалить этот "+("variant"==a?"вариант":"сайт")+"?";jConfirm(i,{site:e,width:330,okClass:"ibtn-red",okText:"Да, удалить",btnWidth:114,onOk:function(){var a=lockScreen("Удаление...",{show_animation:!0});ajaxLoad({url:"sites/ajax/frm:delete_site/id:"+e,onSuccess:function(e){a&&unlockScreen(a),"function"==typeof t&&t(e)}})}})},e.prototype.afterSiteDelete=function(e){if(showDoneBox("Сайт удален",{width:200,cls:"c_text",showTime:1e3}),!isset(window.siteList)){var t=$("#sites_list .tr_site[id-site="+e+"]");t.animate({opacity:0},1e3,function(){var e=t.siblings(".tr_site"),a=t.siblings(".tr_empty"),i=t.closest("#iblk-archive").length>0;$(this).remove(),e.length<1&&(i?$("#iblk-archive").remove():a.show()),t=null,e=null,a=null})}},e.prototype.afterVariantDelete=function(e){location.reload()},e.prototype.siteTransfer=function(e,t,a){$("#transver_site_name h5").text(a),$("#transver_site_name a").attr("href","http://"+t).text(t),$("#frmtransfer__site").val(e),$("#wndTransfer .ui_error").hide(),$("#wndTransfer").wind("show"),$("#frmtransfer__mail").val("").focus()},e.prototype.confirmSiteTransfer=function(){jConfirm("Переносим сайт?",{width:330,btnWidth:109,okClass:"ibtn-red",okText:"Да, переносим",onOk:function(){ajaxLoad({url:"sites/ajax/frm:frmtransfer/ok:1"+(location.href.indexOf("/sites/view")>=0?"/goto:sites":""),data:$("#frmtransfer").serializeArray()})}})},e.prototype.siteTransferDone=function(e,t,a,i){isset(window.siteList)?siteList.$emit("sites-list-item--transferred",e,a):($("#sites_list .tr_site[id-site="+e+"]").remove(),alert('Сайт "'+t+'" успешно перенесен пользователю '+a+"!")),$(".wind#wndTransfer").wind("hide"),"function"==typeof i&&i()},e.prototype.updateSiteSwitch=function(e,t){e.find(".site_publish .switch")["iblk-disabled"==t?"removeClass":"addClass"]("on")["iblk-disabled"==t?"addClass":"removeClass"]("off"),e.stop().css("background-color","#FFF7C2").animate({backgroundColor:"#fff"},5e3)},e.prototype.onClickBtnLaunchSiteInDashboard=function(e,t){return sitesMan.setPublished(e,t),tracerSendEvent("editor: launch site button click",{source:"dashboard"}),!1},e.prototype.onClickBtnLaunchSiteInEditor=function(e,t){return sitesMan.setPublished(e,t),tracerSendEvent("editor: launch site button click",{source:"editor"}),!1},e.prototype.onClickBtnLaunchSiteInPreview=function(e,t){return t?sitesMan.setPublished(e,t):sitesMan.errNeedTariffAttach(),tracerSendEvent("editor: launch site button click",{source:"sitepreview"}),!1},e.prototype.setPublished=function(e,t){var a=$(t),i=window.location.href.match(/user:(\d+)/),n=a.attr("data-entry-point");a.hasClass("on")?jConfirm("Вы уверены, что хотите выключить сайт?",{width:330,btnWidth:109,okClass:"ibtn-red",okText:"Да, выключить",onOk:function(){isset(window.siteList)&&siteList.$emit("sites-list-item--before-move-in-other-list",e,window.SITES_LIST_DRAFTS),ajaxLoad({url:"sites/ajax/frm:frmpublish2"+(null!==i?"/user:"+i[1]:""),data:{id:e,action:"off"},onBeforeSuccess:function(e){return"undefined"!=typeof e.err?(e.error=e.err,e.res=0):0==e.res&&(e.error="Возникла ошибка [#4778]!"),!0},onSuccess:function(e){if(1==e.res)switch(e.mes){case"ok_site_off":if(showDoneBox("Сайт выключен",{width:200,cls:"c_text",showTime:1e3}),isset(window.siteList))return void siteList.$emit("sites-list-item--successful-move-in-other-list",e.id,e.pos);var t=$(".tr_site[id-site="+e.id+"]");t.attr("cur-grp","iblk-disabled"),t.appendTo($("#iblk-disabled .tbody_sites")),sitesMan.updateSiteSwitch(t,t.closest(".iblk").attr("id")),t.attr("pos",e.pos),sitesMan.showHideEmptyBlocks(),sitesMan.recountDailyExpense(),t=null}isset(window.siteList)&&siteList.$emit("sites-list-item--failure-move-in-other-list")}})}}):sitesMan.hasTariffDaily?jConfirm("Выберите месячный или дневной тариф для запуска сайта",{width:400,btnWidth:155,okText:"Тариф по месяцам",cancelText:"По дням",headerText:"Запуск сайта",onOk:function(){sitesMan.setPublishedOn(e,{entry_point:n,run_type:"monthly"})},onCancel:function(){sitesMan.setPublishedOn(e,{entry_point:n,run_type:"daily"})},onClose:function(){return!0}}):this.setPublishedOn(e,{entry_point:n,run_type:"monthly"}),i=a=null},e.prototype.setPublishedInTest=function(e){window.location.href.match(/user:(\d+)/);sitesMan.hasTariffDaily?jConfirm("Выберите месячный или дневной тариф для запуска сайта",{width:400,btnWidth:155,okText:"Тариф по месяцам",cancelText:"По дням",headerText:"Запуск сайта",onOk:function(){sitesMan.setPublishedOnInTest(e)},onCancel:function(){sitesMan.setPublishedOnInTest(e,"daily")},onClose:function(){return!0}}):this.setPublishedOnInTest(e)},e.prototype.setPublishedOn=function(e,t){t||(t={}),t.run_type||(t.run_type="monthly"),"undefined"==typeof t.forced&&(t.forced=0);var a=window.location.href.match(/user:(\d+)/);isset(window.siteList)&&siteList.$emit("sites-list-item--before-move-in-other-list",e,t.run_type);var i={id:e,action:"on",type:t.run_type,force:t.forced};isset(t.pay_for_ssl_has_approved_by_user)&&(i.pay_for_ssl_has_approved_by_user=t.pay_for_ssl_has_approved_by_user),ajaxLoad({url:"sites/ajax/frm:frmpublish2"+(null!==a?"/user:"+a[1]:""),data:i,withCredentials:!0,onSuccess:function(a){if(1==a.res)switch(a.mes){case"ok_site_on":if(a.siteUrl&&a.siteUrlDecoded){var i="undefined"!=typeof window.MODULE_ACTION&&"sites/list"==window.MODULE_ACTION&&0==$("#iblk-"+a.type+" .tbody_sites").length;if(isset(window.siteList)&&(i=!1,a.trialDays>0&&isset(a.tariff)&&siteList.$emit("sites-list--tariff-attached",a.tariff)),trialTariff.showModal(a,i),i)return}switch(t.entry_point){case"editor":$(".btn[data-entry-point=editor]").remove();break;case"preview":a.siteUrl&&a.siteUrlDecoded&&($(".site__status--unpublished").remove(),$(".site__published-link").attr("href",a.siteUrl).text(a.siteUrlDecoded),$(".site__status--published").removeClass("hidden"));break;default:if(showDoneBox("Сайт запущен"+("undefined"!=typeof a.is_paid&&1==a.is_paid?" и оплачен":"")+"!",{width:200,cls:"c_text",showTime:1e3}),isset(window.siteList))return void siteList.$emit("sites-list-item--successful-move-in-other-list",a.id,a.pos);var n=$(".tr_site[id-site="+a.id+"]");n.length&&(n.attr("cur-grp","iblk-"+t.run_type),n.appendTo($("#iblk-"+a.type+" .tbody_sites")),"daily"==a.type&&sitesMan.recountDailyExpense(),sitesMan.updateSiteSwitch(n,n.closest(".iblk").attr("id")),n.attr("pos",a.pos),sitesMan.showHideEmptyBlocks()),n=null,sitesMan.in_preview&&(window.location.href=window.location.href)}break;case"tarif_is_full":sitesMan.alertTarifIsFull(a.max_sites);break;case"domains_limit_is_full":sitesMan.alertDomainsLimitIsFull(a.max_domains);break;case"only_site_owner":sitesMan.alertOnlySiteOwner(a.action);break;case"need_tarif_activate":sitesMan.errNeedTariffAttach();break;case"daily_tarif_is_off":jConfirm('<p>Чтобы запустить сайт <strong>по дням</strong>, вам нужно активировать режим для PRO.</p><p>Для этого перейдите в раздел Баланс и в блоке с названием "ДЛЯ PRO" нажмите кнопку "Подключить".</p>',{width:450,btnWidth:120,okClass:"ibtn-green",okText:"Перейти в Баланс",onOk:function(){mxt("btn balance",{"источник":mxGetSourceLink()}),setTimeout("goTo('profile/balance');",200)}});break;case"daily_site_need_payment":if(sitesMan.alertDailySiteNeedPayment(function(){t.forced=1,sitesMan.setPublishedOn(e,t)},function(){isset(window.siteList)&&siteList.$emit("sites-list-item--failure-move-in-other-list")}),isset(window.siteList))return;break;case"user_has_not_enough_money_for_activate_ssl":if(sitesMan.notifyAboutUserHasNotEnoughMoneyForActivateSsl(a,function(){t.pay_for_ssl_has_approved_by_user=0,sitesMan.setPublishedOn(e,t)}),isset(window.siteList))return;break;case"site_ssl_cert_is_must_payment":if(sitesMan.requestApproveByUserPayForSsl(a,function(a){t.pay_for_ssl_has_approved_by_user=a,sitesMan.setPublishedOn(e,t)}),isset(window.siteList))return;break;case"need_balance":sitesMan.showNotEnoughMoneyForDailySite(a.curCronDate)}isset(window.siteList)&&siteList.$emit("sites-list-item--failure-move-in-other-list")}}),a=null},e.prototype.setPublishedOnInTest=function(e,t,a){var i=window.location.href.match(/user:(\d+)/);ajaxLoad({url:"sites/ajax/frm:frmpublish2"+(null!==i?"/user:"+i[1]:""),data:{id:e,action:"on",type:t||"monthly",force:a||0},withCredentials:!0,onSuccess:function(a){if(1==a.res){switch(a.mes){case"ok_site_on":$("#btn-start-test").attr("href","#Start_test"),a.siteUrl&&a.siteUrlDecoded,showDoneBox("Сайт запущен"+("undefined"!=typeof a.is_paid&&1==a.is_paid?" и оплачен":"")+"!",{width:200,cls:"c_text",showTime:1e3});break;case"tarif_is_full":sitesMan.alertTarifIsFullInTest(a.max_sites);break;case"domains_limit_is_full":sitesMan.alertDomainsLimitIsFull(a.max_domains);break;case"only_site_owner":sitesMan.alertOnlySiteOwner(a.action);break;case"need_tarif_activate":sitesMan.errNeedTariffAttach();break;case"daily_tarif_is_off":jAlert('<div class="img_for_message img_pro"></div><div class="title_for_message">Чтобы запустить сайт <strong>по дням</strong>, вам нужно активировать режим для PRO</div><div class="text_for_message">Для этого перейдите в раздел Баланс и в блоке с названием "ДЛЯ PRO" нажмите кнопку "Подключить"</div>',{width:600,btnWidth:160,btnCls:"btn-success",okText:"Перейти в Баланс",onOk:function(){mxt("btn balance",{"источник":mxGetSourceLink()}),setTimeout("goTo('profile/balance');",200)}});break;case"daily_site_need_payment":sitesMan.alertDailySiteNeedPayment(function(){sitesMan.setPublishedOn(e,{forced:1,run_type:t})});break;case"user_has_not_enough_money_for_activate_ssl":sitesMan.notifyAboutUserHasNotEnoughMoneyForActivateSsl(a,function(){sitesMan.setPublishedOn(e,{forced:1,pay_for_ssl_has_approved_by_user:0,run_type:t})});break;case"site_ssl_cert_is_must_payment":sitesMan.requestApproveByUserPayForSsl(a,function(a){sitesMan.setPublishedOn(e,{forced:1,pay_for_ssl_has_approved_by_user:a,run_type:t})});break;case"need_balance":sitesMan.showNotEnoughMoneyForDailySite(a.curCronDate)}$("#Start_test3").find("button.close:first").click()}}}),i=null},e.prototype.createSiteInHybrid=function(){if(!userHasTag("LPDEV-73-b")&&!userHasTag("LPDEV-73-c"))return!1;var e=$('<iframe name="converting-iframe" class="converting-iframe"/>'),t=!1;return $("body").append(e),e.load(function(){var e=this,a="startup-mist--visible";return!t&&(t=!0,void FE.runOnReady(function(){var t=e.contentWindow,i=t.$,n=i("."+a);n.length&&n.removeClass(a),t.hybridConverter.convertSiteToAbsolute(function(e){e.redirect_to?window.location.href=e.redirect_to:window.location.href="http://s.lpmcdn.com/"})}))}),!0},e.prototype.loadSiteTplImage=function(e){var t=$(e),a=t.find(".tpl-img");a.attr("src",a.attr("data-src")),a.removeAttr("data-src"),t.removeClass("not-loaded"),a=t=null},e.prototype.onSuccessSubmitFrmNeedSiteTpl=function(){$("#frmneedsitetpl__iwant").val("").closest(".modal").modal("hide"),alert("Спасибо!\n\nВозможно, именно ваша тематика попадет в следующее обновление!")},e.prototype.initCreatePage=function(e){this.$tplsList=$("#tpls-list"),e=e||{},this.create_page_form=new t,this.create_page_form.init(e),$(document).on("mousedown",".btn-tpl-choose",function(){sitesMan.create_page_form.$tpl_field.val($(this).attr("data-site"))}).on("click","img.tpl-img, .btn-tpl-preview",this.previewTpl);var a,i=7,n=this.$tplsList.find(".tpl-container.not-loaded");for(a=0;a<i&&n[a];a++)this.loadSiteTplImage(n[a]);n=null,$(window).on("scroll.tpl-load",function(){if("block"==$("#sp6_create_site_choose_tpl").css("display")){var e=sitesMan.$tplsList.find(".tpl-container.not-loaded");if(e.length){var t,a=$(window),i=a.scrollTop(),n=a.height();for(var r in e){if(!(e[r].offsetTop-(i+n)<20))break;sitesMan.loadSiteTplImage(e[r])}a=i=n=r=t=null}else $(window).off("scroll.tpl-load")}}),$(window).scroll(),userHasTag("test-new-reg-screen-templates")&&$(".after-reg-popup__wrap").length&&($(document).on("click",".after-reg-popup__wrap",function(){return sitesMan.closeAfterRegPopup(),!1}),$(document).on("click",".after-reg-popup",function(){return!1}),$(document).on("click",".after-reg-popup__btn",function(){return sitesMan.closeAfterRegPopup(),!1}));var r=$(".initial-screen");if(r.length){var o=r.attr("id");if(o)switch(o){case"sp6_create_site_choose_tpl":tracerSendEvent("creating site screen",{type:"templates"});break;case"sp6_create_site_init_HADI1":tracerSendEvent("creating site screen",{type:"three options"})}}},e.prototype.closeAfterRegPopup=function(){tracerSendEvent("new site: reg popup closed"),userAddTag("new-reg-screen-watched"),$(".after-reg-popup__wrap").remove()},e.prototype.setPageState=function(e,t){if($(".site_choose_btn[data-screen-id="+e+"]:first").click(),t){var a=$(".tpl-category__btn[data-class=cat_"+t+"]:first");a.length>0&&a.click()}},e.prototype.previewTpl=function(){var e=$(this).closest(".tpl-container"),t=parseInt(e.attr("id").replace("tpl-",""));$("body").addClass("no_overflow");var a=$("#tpl-preview-wrap"),i=a.find("#tpl-preview-iframe-wrap");a.addClass("visible"),i.children("iframe:visible").hide();var n=i.children("iframe[data-site="+t+"]");n.length?n.show():($("#tpl-loader").show(),$('<iframe src="'+window.baseUrl+t+'/pages/preview_tpl" data-site="'+t+'" onload="$(\'#tpl-loader\').hide()"></iframe>').appendTo(i)),$("#frm3__name").val($("#frm2__name").val()),$("#tpl-id-in-preview").val(t),$(this).hasClass("btn-tpl-preview")&&$(this).addClass("disabled"),tracerSendEvent("opened site template preview",{"template id":t,first:0==sitesMan.userSiteCount})},e.prototype.closePreviewTpl=function(){$("body").removeClass("no_overflow"),$("#tpl-preview-wrap").removeClass("visible")},e.prototype.chooseTpl=function(){var e=$(this).closest(".tpl-container");parseInt(e.attr("id").replace("tpl-",""))},e.prototype.afterGenTelegramCode=function(e){$("#telegram_code_span").text(e),$("#telegram_code").show(),$("#telegram_ready").hide()},e.prototype.afterGenVkCode=function(e){
$("#vk_code_span").text(e),$("#vk_code").show(),$("#vk_ready").hide()},e.prototype.afterVkTurnOff=function(e){},e.prototype.uploadOpengraphImg=function(e,t){return e.target.files[0]?e.target.files[0].type.match(/^image\//)?0==e.target.files[0].size?(alert("Ошибка. Файл картинки пустой"),t.reset(),!1):e.target.files[0].size>1048576?(alert("Файл слишком большой. Максимальный размер = 1 Мегабайт."),t.reset(),!1):(lockScreen("Загружаем картинку",{show_animation:!0,delay_before:1e3}),void t.submit()):(alert("Нужно выбрать файл изображения."),t.reset(),!1):(alert("Форма не может быть отправлена пустой"),t.reset(),!1)},e.prototype.opengraphUploadOk=function(e){if(isset(e.ops)){var t=$(".og_preview_image");return t.length?void t.find("#og_image").attr({src:e.url,"data-orig-w":e.extra.w,"data-orig-h":e.extra.h}):(t=null,void consoleDbg("Картинка загружена, но не найден ее блок"))}},e.prototype.saveOpengraphData=function(){var e=$("#og_header").val(),t=$("#og_description").val(),a=$("#save_opengraph"),i=$(".descr_wrapper");$.ajax({url:window.baseUrl+window.siteId+"/sites/ajax/frm:saveopengraph",method:"POST",dataType:"json",data:{title:e,description:t},success:function(e){return e.res&&1==e.res?(a.text("Сохранено"),void i.text(t)):void alert(e.error)}})},e.prototype.initSocialLocker=function(){var e=$(".to-lock");if(e.sociallocker){var t=$(".to-lock").sociallocker({demo:!0,text:{header:'Нажмите "поделиться", чтобы активировать<br/>реферальные хвосты.',message:""},theme:"flat",buttons:{order:["vk-share"],counter:!0},vk:{appId:"5203064",like:{pageUrl:"https://lpmotor.ru",requireSharing:!0,title:"Нравится"},share:{pageUrl:"https://lpmotor.ru",pageTitle:"LPmotor – Конструктор сайтов и лендингов",pageDescription:"Сейчас создаю себе сайт на конструкторе http://LPmotor.ru! Кто хочет посмотреть на результат? ))",pageImage:"https://lpmotor.s3.amazonaws.com/6/9/a/69aed0d3470e28a8574ac644456cf649.png",title:"Поделиться"},subscribe:{group_id:"lpmotor",title:"Подписаться"}}});lockerHeight=t.outerHeight(),t.on("http://s.lpmcdn.com/web/build/pages/unlock.sociallocker.onp",function(e,t,a){console.log("unlocked"),$.ajax({url:window.baseUrl+"sites/ajax",method:"POST",dataType:"JSON",data:{block:"activate_ref_tails"},success:function(e){if("undefined"!=typeof e.res&&1==e.res){var t=$(".success_mes");$(".activate_reftails").hide(),t.html("Спасибо за ваш репост! <br><br>Реф-хвосты будут подключены в течение часа <br>По факту подключения вам придет письмо на <b>"+e.email+"</b>"),t.fadeIn()}else alert("Ошибка #2258\nНапишите пожалуйста нам в тех-поддержку support@lpmotor.ru")}})})}},e.prototype.tryPublishSite=function(e){$.post(window.baseUrl+window.siteId+"/sites/ajax/frm:tryPublishSite",{id:window.siteId,action:"on",type:"monthly",force:0},function(t){if(t.res&&1==t.res)switch(t.mes){case"ok_site_on":$("#success_publish").modal("show"),e.onOk();break;default:jAlert("<br>Ошибка при публикации сайта [#2821]")}else if(t.mes)switch(t.mes){case"no_tarif":case"need_tarif_activate":$("#no_tarif_modal").modal("show");break;case"tarif_is_full":sitesMan.alertTarifIsFull2(t.max_sites);break;default:jAlert("<br>Необработанный ответ от сервера[#2831]")}else t.err&&jAlert("<br>"+t.err)},"JSON")},e.prototype.setIndexing=function(e){var t=e.find("#site_indexing"),a=(e.hasClass("on")?"on":"off",e.hasClass("on")?"off":"on",t.val()),i=$("#ref_follow_switch"),n=$("#ref_follow_section");$.post(window.baseUrl+window.siteId+"/sites/ajax/frm:siteindexing",{site_indexing:a},function(t){return"undefined"!=typeof t.res&&"index_on"==t.res?(i.removeClass("off").addClass("on"),void n.slideDown()):("undefined"!=typeof t.res&&"index_off"==t.res?(i.removeClass("on").addClass("off"),n.slideUp()):t.fail||t.error?1==t.fail?($("#not_published_modal").modal("show"),e.removeClass("on").addClass("off")):2==t.fail?($("#no_tarif_modal").modal("show"),e.removeClass("on").addClass("off")):alert(t.error):alert("ошибка при отключении/подключении индексирования сайта #2266"),!1)},"json")},e.prototype.watchType404=function(){"use strict";var e=$("#frmerrortype");e.on("change",function(){$.ajax({url:window.baseUrl+window.siteId+"/sites/ajax/frm:siteErrorType",method:"post",dataType:"json",data:e.serialize(),success:function(e){0==e.res?alert(e.error):showDoneBox("Включен "+e.message,{width:300,cls:"c_text"})}})})},e.prototype.setRefFollow=function(e){var t=e.find("#ref_follow").val(),a=e.hasClass("on")?"on":"off",i=e.hasClass("on")?"off":"on";$.post(window.baseUrl+window.siteId+"/sites/ajax/frm:ref_follow",{ref_follow:t},function(t){if(!t.res||1!=t.res)return t.error?alert(t.error):alert("ошибка при отключении/подключении передачи веса ссылок #2270"),e.removeClass(a).addClass(i),!1},"json")},e.prototype.publishSiteFromIndexing=function(e){ajaxLoad({url:"sites/ajax/frm:frmpublish2",data:{id:e,action:"on",type:"monthly",force:0},withCredentials:!0,onSuccess:function(e){if(1==e.res)switch(e.mes){case"ok_site_on":window.location.href=window.location.href;break;case"tarif_is_full":sitesMan.alertTarifIsFull2(e.max_sites)}}})},e.prototype.generateHTMLforPreview=function(e){var t="",a=e,i=$(".tip.small_img");i.hide();var n=$("#og_image"),r=intval(n.attr("data-orig-w")),o=intval(n.attr("data-orig-h")),s={vk:$(".btn-vk"),fb:$(".btn-facebook")};r<=500&&"vk"==a&&(a="vk_mini"),("fb"==a&&r<=400&&r>=200||o/r>3||r/o>3)&&(a="fb_mini");var d=$(".preview_window");switch(d.hide(),a){case"vk":t+='<div class="preview_window_vk clearfix" >',t=this.generatePreviewHTML(t),s.fb.removeAttr("disabled"),s.vk.attr("disabled","disabled");break;case"vk_mini":t+='<div class="preview_window_vk_mini clearfix" >',t=this.generatePreviewHTML(t),s.fb.removeAttr("disabled"),s.vk.attr("disabled","disabled");break;case"fb":t+='<div class="preview_window_fb" >',t=this.generateFbPreviewHTML(t),s.vk.removeAttr("disabled"),s.fb.attr("disabled","disabled");break;case"fb_mini":t+='<div class="preview_window_fb_mini" >',t=this.generatePreviewHTML(t),s.vk.removeAttr("disabled"),s.fb.attr("disabled","disabled")}var l=n.attr("src");"undefined"==typeof l||"fb"==a&&r<200&&o<200?(i.show(),t=strtr(t,{":SRC":"https://lpmotor.s3.amazonaws.com/6/9/a/69aed0d3470e28a8574ac644456cf649.png"})):t=strtr(t,{":SRC":l}),d.html(t),"fb"==a&&r/o>=2.1?(document.getElementsByClassName("img_wrapper")[0].style.backgroundPosition="center center",document.getElementsByClassName("img_wrapper")[0].style.backgroundSize="auto 100%"):(document.getElementsByClassName("img_wrapper")[0].style.backgroundPosition="0 50%",document.getElementsByClassName("img_wrapper")[0].style.backgroundSize="100%"),d.fadeIn()},e.prototype.generateFbPreviewHTML=function(e){var t='<div class="img_wrapper" style="background: url(:SRC)" >',a='<div class="title_wrapper" >',i='<div class="descr_wrapper" >';e+=t+"</div>";var n=$("#og_header").val();e+=a+n+"</div>";var r=$("#og_description").val();return e+=i+r+"</div>",e+="</div>"},e.prototype.generatePreviewHTML=function(e){var t='<div class="img_wrapper" >',a='<div class="title_wrapper" >',i='<div class="descr_wrapper" >',n='<img src=":SRC">';e+=t+n+"</div>";var r=$("#og_header").val();e+=a+htmlspecialchars(r)+"</div>";var o=$("#og_description").val();return e+=i+htmlspecialchars(o)+"</div>",e+="</div>"},e.prototype.bindOpengraphEvents=function(){var e="",t=this,a=$("#og_header, #og_description");a.bind("keyup keydown blur",function(a){if(13==a.keyCode&&!a.shiftKey)return a.preventDefault(),!1;var i=$(this).val(),n=$(this).attr("id");"og_header"==n&&(e=t.countMessageLength(i,70)),"og_description"==n&&(e=t.countMessageLength(i,300)),$("#"+n+"_left").text(e)}),a.trigger("blur")},e.prototype.countMessageLength=function(e,t){var a=t-e.length;return a},e.prototype.alertTarifIsFull2=function(e){jAlert("<p>На текущем тарифе вы можете запустить максимум<br/><strong>"+e+" сайт"+plural(e,"","а","ов")+'</strong>.</p><hr/><p class="fw_bold pt1" style="color: #f58f36;">Что теперь делать?</p><table class="mb2"><tr><td style="width:42%">Выключите один из сайтов, нажав на переключатель <span id="switch_example"></span> в <a href="'+window.baseUrl+'">главном меню </a>.</td><td class="vam c_text fw_bold" style="width:16%;">ИЛИ</td><td style="width:42%">Перейдите на более "мощный" тариф в разделе <a href="'+window.baseUrl+'profile/balance">Баланс </a>.</td></tr></table>',{width:550,btnWidth:200,okClass:"ibtn-green",okText:"Не сейчас",headerText:"Количество запущенных сайтов превышено"})},e.prototype.updateVariantLabels=function(e,t){$("label[for=ab_st_item_"+e+"]").find(".abtest_name_var:first").text(t),$("#variant-list-1[name=variant-list-1]").children("option[value="+e+"]").text(t)},e.prototype.confirmCloneSite=function(e,t){var a=$("#abtest__modal_copy"),i=a.find(".wrap_abtest_clone:first"),n=a.find(".wrap_integrations_clone:first"),r=a.find("#clone_integrations:first");r.prop("checked",!1),i.hide(),n.hide(),a.attr("site-id",e).wind("show"),"undefined"!=typeof t.has_abtest&&i.show(),"undefined"!=typeof t.has_int&&n.show()},e.prototype.cloneSite=function(e,t,a){var i={};i.type="ajax","undefined"!=typeof t&&(i.check_module=t),"undefined"!=typeof a&&a&&(i.check_int=1),ajaxLoad({url:e+"/sites/clone_site",data:i,withCredentials:!0,onSuccess:function(t){if(1==t.res)if("undefined"!=typeof t.check_data)sitesMan.confirmCloneSite(e,t.check_data);else switch(t.mes){case"go_to":window.location.href=t.redirect_to}}})},e.prototype.doCloneSiteSpa=function(e,t,a){var i=lockScreen("Клонирование...",{show_animation:!0});a.type="ajax",ajaxLoad({url:t,data:a,withCredentials:!0,onSuccess:function(t){if(i&&unlockScreen(i),1==t.res){if("undefined"!=typeof t.check_data)return void sitesMan.confirmCloneSite(e,t.check_data);if(isset(window.siteList)&&t.site_list_item)return void siteList.$emit("sites-list-item--created",t.site_list_item)}console.log(t),alert("Wrong response from server #4825. Watch info in console")}})},e.prototype.doCloneSite=function(){var e=$("#abtest__modal_copy"),t=e.find("#clone_integrations:first"),a=t.prop("checked"),i=e.attr("site-id"),n=i+"/sites/clone_site";if(a&&(n+="/copy_int:true"),"site_list_spa"==sitesMan.location){var r={};return r.from=sitesMan.location,sitesMan.doCloneSiteSpa(i,n,r),e.wind("hide"),!1}return window.location.href=window.baseUrl+n,!1},e.prototype.loadTextareas=function(){$(".textarea_load.need_load").each(function(e,t){var a=$(t),i=a.attr("data-id");if(i){var n=$("#textarea_data__"+i);if(n.length){var r=a.find("textarea:first");r.length&&(r.val(LpmBase64.decode(n.text())),$("#frmseo__"+i+"_allow").val("1"),a.removeClass("need_load"))}}})},e.prototype.initQuiz=function(e,t){var a=$(".quiz-form");e&&(a=e.find(".quiz-form"));var i=function(){var e=$(this);if(e.find(".user_form_fields_list .field:last").attr("pos")!==e.find(".field.active").attr("pos"))return e.find(".quiz__nav_next").trigger("click"),!1};t&&a.each(function(){sitesMan.initQuizForm($(this))}),a.find(".user_form").on("submit",i),this.enableQuizNav()},e.prototype.initQuizForm=function(e){var t=sitesMan.quizForm(e);0!==t.totalSteps&&t.totalSteps<2?(t.$btn.next.addClass("quiz__disabled"),t.$btn.submit.removeClass("quiz__disabled")):(t.$btn.next.removeClass("quiz__disabled"),t.$btn.submit.addClass("quiz__disabled")),sitesMan.toQuizStep(t,0)},e.prototype.quizForm=function(e){var t=e.find(".quiz"),a=e.find(".quiz.active"),i=e.find(".quiz__progress_container");return{$form:e,$steps:t,totalSteps:t.length,$activeStep:a,activeIndex:t.index(a),$progressContainer:i,$pSteps:{all:i.find(".quiz__progress_dot"),inactive:i.find(".quiz__progress_dot:not(.active)"),active:i.find(".quiz__progress_dot.active")},$indicator:{current:e.find("#steps_bar"),all:e.find("#all_steps")},$btn:{prev:e.find(".quiz__nav_prev"),next:e.find(".quiz__nav_next"),submit:e.find(".btn-new.ie_css3.btn-submit")},$regulation:e.find(".user_form_regulation")}};var i=function(e){var t=e.hasClass("is_required"),a=e.data("type"),i=["input[type=text]","input[type=tel]","input[type=radio]:checked","input[type=checkbox]:checked","option:not([hidden]):selected","textarea"],n=e.find(i.join(", ")),r=e.find(".ui_error"),o={required:"Это поле нужно заполнить",phone:"Телефон содержит неверные символы",email:"Введите корректный адрес электронной почты"},s=function(e){if(-1!==["fcheckbox","fradio","fselect"].indexOf(a))return 0===e.length;var t=e.val().trim();return 0===t.length||!t},d=function(e){var t=e.val().trim(),a=/^\+?[1-9]{1}[\d\s()-]*$/i;return!(t.length>0)||t.length>5&&a.test(t)},l=function(e){var t=e.val().trim(),a=/^[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i;return a.test(t)},c=function(t){FE.run("quiz-validate-error",{step:e}),r.text(t)};if(r.addClass("hidden"),t&&s(n))return r.removeClass("hidden"),c(o.required),!1;if("ftextbox"===a&&!s(n)){var p=n.closest(".field"),u=p.data("cls");if("femail"===u&&!l(n))return r.removeClass("hidden"),c(o.email),!1;if("fphone"===u&&!d(n))return r.removeClass("hidden"),c(o.phone),!1}return!0};e.prototype.nextQuiz=function(e){var t=this.quizForm(e),a=t.activeIndex+1;return!(!sitesMan.isEditor&&!0!==i(t.$activeStep))&&void sitesMan.toQuizStep(t,a)},e.prototype.prevQuiz=function(e){var t=this.quizForm(e),a=t.activeIndex-1;a<0&&(a=0),sitesMan.toQuizStep(t,a)},e.prototype.adaptQuizContent=function(e){var t=a.find(".wind-body .body_content"),i=e.$form.find(".wind-footer"),n=parseInt(i.outerHeight(!0));t.css("padding-bottom",n)},e.prototype.toQuizStep=function(e,t){var a=e.$form.find(".wind-body"),i=0===t,n=e.totalSteps-1===t,r=1===e.$form.data("is-regulation-enabled");e.$steps.removeClass("active"),e.$steps.eq(t).addClass("active"),i?e.$btn.prev.addClass("quiz__disabled"):e.$btn.prev.removeClass("quiz__disabled"),n?(e.$btn.submit.removeClass("quiz__disabled"),e.$btn.next.addClass("quiz__disabled"),r&&e.$regulation.removeClass("hidden")):(e.$btn.submit.addClass("quiz__disabled"),e.$btn.next.removeClass("quiz__disabled"),e.$regulation.addClass("hidden"));var o=e.$progressContainer.attr("data-progress-color")||"aaa";e.$pSteps.active.removeClass("active"),e.$pSteps.all.removeAttr("style"),e.$pSteps.all.eq(t).addClass("active").css("background-color","#"+o),e.$indicator.all.text(e.totalSteps),e.$indicator.current.text(t+1);var s=e.$steps.eq(t).find("input[type=text]:visible, textarea");e.activeIndex!==-1&&s.length&&s.trigger("focus"),n||($(".wrap-for-formPopover").animate({scrollTop:0},300),a.animate({scrollTop:0},300)),this.adaptQuizContent(e)},e.prototype.enableQuizNav=function(e){var t=$(".quiz__nav_next"),a=$(".quiz__nav_prev");"undefined"!=typeof e&&e.length&&(t=e.find(".quiz__nav_next"),a=e.find(".quiz__nav_prev")),t.off("click").on("click",function(){var e=$(this).closest(".user_form");sitesMan.nextQuiz(e)}),a.off("click").on("click",function(){var e=$(this).closest(".user_form");sitesMan.prevQuiz(e)})},e.prototype.initIphone=function(){var e={w:$(window).width(),h:screen.height,wC:$(window).width()/2,hC:screen.height/2},t=$("#sections_list"),a=t.find("> .is_iphone"),i={x:0,y:0};return 0!=a.length&&(a.find(".section-image").css({backgroundSize:"cover"}),void a.on("mousemove",function(t){var a,n,r=$(this).find(".section-image:first");document.documentElement&&document.documentElement.scrollTop?(a=document.documentElement.scrollTop,n=document.documentElement.scrollLeft):(a=document.body.scrollTop,n=document.body.scrollLeft),i.x=(t.pageX-n-e.w+e.wC)/(e.wC/10),i.y=(t.pageY-a-e.h+e.hC)/(e.hC/10),r.css("transform","translate("+i.x*-.75+"px, "+i.y*-.75+"px)")}))},e.prototype.disableIphone=function(e){e.off("mousemove"),e.find(".section-image:first").css({"background-size":"",transform:""})},FE.runOnReady(function(){window.sitesMan=new e,window.sitesMan.ready(),FE.add("file_uploaded_favicon",function(e){sitesMan.faviconUploadOk(e)}),FE.add("file_uploaded_opengraph_image",function(e){sitesMan.opengraphUploadOk(e)})})}(),function(){"use strict";function e(e,t,a){this.complete=!1,this.ptr=e,this.killTimer=null,!t.shift&&t.selector&&(t=t.toArray()),this.list=t,this.ops=a||{},"undefined"==typeof this.ops.max_loading&&(this.ops.max_loading=3),"undefined"==typeof this.ops.onload_callback&&(this.ops.onload_callback=!1),i&&console.log("[ LOADER ] init",this)}var t=0,a={},i=!1;e.prototype.loadCycle=function(){if(0!=this.list.length){var e=this.list.shift(),t=$(e).find("img[data-src]");1==t.length?(t.load(function(){var e=ImgListLoader.get($(this).attr("loader-ptr")),t=ImgListLoader.isDebug();return e?(t&&console.log("[ LOADER ] image loaded",this),e.ops.onload_callback&&e.ops.onload_callback.apply(this),e.list.length>0?setTimeout("var L=ImgListLoader.get("+e.ptr+"); if (null!==L){L.loadCycle();}",1):e.complete||(e.complete=!0,t&&console.log("Loader #"+e.ptr+" completed")),void(e=null)):void console.log("[ LOADER ] not found #"+$(this).attr("loader-ptr"))}),t.attr("src",t.attr("data-src")),t.attr("loader-ptr",this.ptr),t.removeAttr("data-src")):ImgListLoader.isDebug()&&console.log("[ LOADER ] not 1 image found. ",t)}},e.prototype.run=function(){for(var e=0,t=Math.min(this.list.length,this.ops.max_loading);e<t;e++)this.loadCycle();this.killTimer=setInterval("var loader = ImgListLoader.get("+this.ptr+"); if (null!==loader && loader.complete){ ImgListLoader.kill("+this.ptr+") }",5e3)},e.prototype.removeTimer=function(){clearInterval(this.killTimer),this.killTimer=null},window.ImgListLoader={create:function(i,n){return a[++t]=new e(t,i,n),a[t]},get:function(e){return"undefined"!=typeof a[e]?a[e]:null},getAll:function(){return a},setDebug:function(e){i=e},isDebug:function(){return i},kill:function(e){"undefined"!=typeof a[e]&&(i&&console.log("[ LOADER ] kill #"+e),a[e].removeTimer(),delete a[e])}}}(),window.animManager=new FanimManager,window.animManager.ready(),function(){var e={},t=ge("bs_cont_wrap");e.setBlockData=function(t){if(null==t||null==t.id)return!1;var a={},i=$(ge(t.id));if(0===i.length)return!1;var n=e.getRelatedBlockData(i,!0);if(n.blk_height==t.blk_height&&n.blk_width==t.blk_width&&n.pos_left==t.pos_left&&n.pos_top==t.pos_top&&n.rotate==t.rotate&&n.parent_id==t.parent_id)return!0;null!=t.blk_height&&(a.height=t.blk_height),null!=t.blk_width&&(a.width=t.blk_width),null!=t.pos_left&&(a.left=t.pos_left),null!=t.pos_top&&(a.top=t.pos_top),null!=t.rotate&&(a.transform=0==t.rotate?"":"rotate("+t.rotate+"deg) perspective(0)");var r=0,o=ge(t.section_cell_id),s=hasClass(domPN(domPN(o)),"is_absolute");n.section_cell_id!=t.section_cell_id&&(null==t.parent_id&&$(o).append(i),r=t.section_cell_id);var d=t.parent_id;if(n.parent_id!=t.parent_id){var l=null==t.parent_id?t.section_cell_id:t.parent_id,c=ge(l),p=$(c);null!=t.parent_id&&hasClass(c,"slide")&&hasClass(c,"hidden-slide")&&pages_editor.setSlide(p.closest(".blk_box_slider"),l),p.append(i),d=t.parent_id}switch(i.attr("blk_class")){case"blk_text":case"blk_image":null!=a.height&&delete a.height;break;case"blk_form":var u=i.find(".blk_form_wrap form:visible");u.length&&(a.height=u.first().get(0).offsetHeight)}i.css(a),FE.run("section/resized"),FE.run("hybrid/resized"),hybridBlockResizer.processingBlockAfterResize(i);var f=!1;if(null!=t.parent_id){var h=i.parents(".slide.hidden-slide");0!==h.length&&(f=!0,h.removeClass("hidden-slide"))}return hybridManager.saveBlockData(i,r,d),s||dndHelper.clearBlockStyles(i,!1,$(ge(t.section_cell_id)),!0),f&&h.addClass("hidden-slide"),!0},e.getBlockData=function(t){var a={id:t.attr("id"),block_name:t.attr("blk_class"),rotate:0};switch("section"!==a.block_name&&(a.rotate=e.getRotateAngle(t)),a.block_name){case"blk_yandex_map":t=t.find(".yandex_map:first");break;case"blk_button_popup":t=t.find(".blk_button_data_wrap:first a:first");break;case"blk_html":t=t.find(".blk-data:first");break;case"blk_video":t=t.find(".blk_video_data_wrap:first"),t.hasClass("empty")||(t=t.find("iframe:first"));break;case"blk_divider":t=t.find(".blk_divider_self:first");break;case"blk_text":t=t.find(".blk-data:first");break;case"blk_form":var i=t.find(".blk_form_wrap:first a.btn-form-popover:first");t=i.length>0?i:t.find(".blk_form_wrap:first form:first");break;case"blk_button":t=t.find(".blk_button_data_wrap:first a:first");break;case"blk_box_slider":t=t.find(".blk_box_slider_self:first");break;case"blk_image":case"blk_image_ext":t=t.find(".blk_image_data_wrap"),t.hasClass("empty")||(t=t.find("div.img_container:first"))}if("section"==a.block_name)a.blk_height=Math.round(t.outerHeight());else{var n=this.getPosition(t);a.pos_top=n.top,a.pos_left=n.left,a.blk_height=Math.round(t.outerHeight()),a.blk_width=Math.round(t.outerWidth())}return a},e.getRelatedBlockData=function(t,a){var i=e.getBlockData(t),n=t.parent();if(n.hasClass("slide cell")){var r=e.getRelatedBlockData(n);null!=i.pos_left&&(i.pos_left-=r.pos_left,i.pos_top-=r.pos_top)}return i.parent_id=null,i.section_cell_id=null,a&&(n.hasClass("section-cell")?i.section_cell_id=n.attr("id"):(i.parent_id=n.attr("id"),i.section_cell_id=n.closest(".section-cell").attr("id"))),i},e.getPosition=function(e){var t=e,a=0,i=0,n=!0;null==e.nodeType&&(t=e.get(0));var r=hasClass(t,"is_hidden");if(r){var o=t;removeClass(t,"is_hidden")}for(;null!=t&&!hasClass(t,"blk_section_inner");)(n||"static"!==getComputedStyle(t).getPropertyValue("position"))&&(a+=t.offsetTop,i+=t.offsetLeft,n=!1),t=domPN(t);return r&&addClass(o,"is_hidden"),{top:Math.round(a),left:Math.round(i)}},e.getRotateAngle=function(e){null==e.nodeType&&(e=e.get(0));var t=e.style.transform;return null==t||""==t?t=0:(t=/rotate\s?\((-?\d*)deg\)/.exec(t),null==t||t.length<2?t=0:(t=parseInt(t[1]),isNaN(t)&&(t=0))),t},e.getRotatedPosition=function(e,t,a){var i=0,n=0;if(0!=a){var r=Math.sqrt(Math.pow(e,2)+Math.pow(t,2));if(0!=r){var o=a-Math.atan2(t,e);i=r*Math.cos(o),n=-r*Math.sin(o)}}else i=e,n=t;return{x:i,y:n}},e.getRealOffset=function(e){for(var t=0,a=0,i=e,n=0;i&&"body"!==i.nodeName.toLowerCase()&&++n<=100;)t+=i.offsetTop-i.scrollTop,a+=i.offsetLeft-i.scrollLeft,i=i.offsetParent;return{top:t,left:a}},e.isPointInPolygon=function(e,t,a){for(var i=!1,n=e.length,r=n-1,o=0;o<n;r=o++)e[o][1]>a!=e[r][1]>a&&t<(e[r][0]-e[o][0])*(a-e[o][1])/(e[r][1]-e[o][1])+e[o][0]&&(i=!i);return i};var a=function(e,t,a,i,n,r,o,s){var d=(s-r)*(a-e)-(o-n)*(i-t);if(0==d)return!1;var l=((o-n)*(t-r)-(s-r)*(e-n))/d,c=((a-e)*(t-r)-(i-t)*(e-n))/d;return l>=0&&l<=1&&c>=0&&c<=1};e.isIntersectPolygons=function(t,i){for(var n=i.length,r=0;r<n;r++)if(e.isPointInPolygon(t,i[r][0],i[r][1]))return!0;var o=t.length;for(r=0;r<o;r++)if(e.isPointInPolygon(i,t[r][0],t[r][1]))return!0;for(r=0;r<o;r++){var s=r+1;s>=o&&(s=0);for(var d=0;d<n;d++){var l=d+1;if(l>=n&&(l=0),a(t[r][0],t[r][1],t[s][0],t[s][1],i[d][0],i[d][1],i[l][0],i[l][1]))return!0}}return!1},e.getBlockRelatedAngle=function(t){null==t.nodeType&&(t=t.get(0));for(var a=0;null!=t;)a+=e.getRotateAngle(t),t=closest(domPN(t),"blk_box_slider");return a},e.isRotatedBlock=function(t){for(;null!=t;){var a=e.getRotateAngle(t);if(0!==a)return!0;t=closest(domPN(t),"blk_box_slider")}return!1},e.getBlockPolygon=function(a,i){var n=a.getBoundingClientRect(),r=e.getBlockRelatedAngle(a);if(0===r)return[[n.x,n.y],[n.x+n.width,n.y],[n.x+n.width,n.y+n.height],[n.x,n.y+n.height]];null==i&&(i=!1);var o=0,s=0;i&&(o=t.scrollTop,s=t.scrollLeft);var d=a.offsetWidth,l=a.offsetHeight,c=d/2,p=l/2,u=Math.PI*r/180,f={x:n.x+n.width/2,y:n.y+n.height/2},h=e.getRotatedPosition(-c,p,u),_=e.getRotatedPosition(c,p,u),m=e.getRotatedPosition(c,-p,u),g=e.getRotatedPosition(-c,-p,u);return[[f.x+h.x+s,f.y-h.y+o],[f.x+_.x+s,f.y-_.y+o],[f.x+m.x+s,f.y-m.y+o],[f.x+g.x+s,f.y-g.y+o]]},e.getPolygonFromRotatedRect=function(t,a,i,n,r){var o=t/2,s=a/2,d=Math.PI*i/180,l={x:n+o,y:r+s},c=e.getRotatedPosition(-o,s,d),p=e.getRotatedPosition(o,s,d),u=e.getRotatedPosition(o,-s,d),f=e.getRotatedPosition(-o,-s,d);return[[l.x+c.x,l.y-c.y],[l.x+p.x,l.y-p.y],[l.x+u.x,l.y-u.y],[l.x+f.x,l.y-f.y]]},e.getBoundingClientRotatedRect=function(t,a,i,n,r){for(var o=e.getPolygonFromRotatedRect(t,a,i,n,r),s=o.length,d=null,l=null,c=null,p=null,u=0;u<s;u++){var f=o[u];(null===d||d>f[1])&&(d=f[1]),(null===c||c<f[1])&&(c=f[1]),(null===l||l>f[0])&&(l=f[0]),(null===p||p<f[0])&&(p=f[0])}return{top:d,left:l,width:p-l,height:c-d}},FE.runOnReady(function(){window.hybridData=e})}(),function(){"use strict";var e="http://s.lpmcdn.com/web/build/pages/2.1.41",t={mapsData:[],mapInstances:{}};t.init=function(){return null!=window.ymaps?(t.mapScriptLoaded(),!1):void setTimeout(function(){var a=ce("script",{src:"https://api-maps.yandex.ru/"+e+"/?lang=ru_RU",type:"text/javascript"});geByTag1("head").appendChild(a),a.onload=t.mapScriptLoaded},0)},t.loadMapsData=function(){for(var e=0;e<t.mapsData.length;e++){var a=t.mapsData[e];if(null!=ge(a.blockId)){var i=t.mapInstances[a.blockId]=new ymaps.Map("map_"+a.blockId,{center:[a.lat,a.lon],zoom:17,behaviors:["default"],controls:["zoomControl"]});i.behaviors.isEnabled("scrollZoom")&&i.behaviors.disable("scrollZoom");var n=new ymaps.Placemark([a.lat,a.lon]);i.geoObjects.add(n)}}},t.mapScriptLoaded=function(){if(null==window.ymaps)throw new Error("#5410 Yandex Map not inited");ymaps.ready(t.loadMapsData)},t.reInitMap=function(e,a,i){if(null!=e&&null!=window.ymaps&&ymaps.Map){var n=t.mapInstances,r=$("#map_"+e),o=r.hasClass("map-bg"),s=r.closest(".blk_section");if(n[e]&&(n[e].destroy(),delete n[e],o&&s.addClass("empty_map")),r.empty(),ymaps&&i&&a){try{n[e]=new ymaps.Map("map_"+e,{center:[a,i],zoom:17,controls:["zoomControl"]}),n[e].geoObjects.add(new ymaps.Placemark([a,i]))}catch(e){consoleDbg(e)}o&&s.removeClass("empty_map")}}},t.addMap=function(e,a,i){t.mapsData.push({blockId:e,lat:a,lon:i})},window.yandexMaps=t}(),function(){function e(){this.ADAPTABILITY_TYPE_PC="pc",this.ADAPTABILITY_TYPE_TABLET="tablet",this.ADAPTABILITY_TYPE_MOBILE="mobile370",this.view_port="editor",this.site_width=960,this.DEVICE_TABLET_CONTENT_MIN_WIDTH=800,this.DEVICE_TABLET_POPUP_MIN_WIDTH=400,this.DEVICE_MOBILE_CONTENT_MIN_WIDTH=370,this.DEVICE_MOBILE_POPUP_MIN_WIDTH=300,this.processResizing=0,this.allowMediaQuery=0,this.own_slider_editor=new t,this.typeIcons={},this.typeIcons[this.ADAPTABILITY_TYPE_PC]="fa-desktop",this.typeIcons[this.ADAPTABILITY_TYPE_TABLET]="fa-tablet",this.typeIcons[this.ADAPTABILITY_TYPE_MOBILE]="fa-mobile",this.typeIconsList=[],this.types=[],this.nonPcClass="non-pc",this.data_empty={},this.states={},this.data={},this.hybridData={},this.$sections=[],this.$blocks=[],this.type=this.ADAPTABILITY_TYPE_PC,this.prev_type=this.ADAPTABILITY_TYPE_PC,this.blockTextPcContents={},this.resize_timer=!1,this.selectors={$desktop:$(".responsive_menu .responsive_menu_item[version=pc]")},this.$defaultScopeRoot=null,this.$scopeRoot=null,this.$scopeBlocks=null,this.is_ready=!1,this.ready=function(){this.is_ready=!0,FE.runAndClr("adapterManager/ready")},this.isReady=function(){return this.is_ready},this.isEditor=function(){return"editor"==adapterManager.view_port},this.isPreview=function(){return"preview"==this.view_port},this.isView=function(){return"view"==adapterManager.view_port},this.isPC=function(){return adapterManager.ADAPTABILITY_TYPE_PC==adapterManager.type},this.getDefaultScopeRoot=function(){return this.$defaultScopeRoot||(this.$defaultScopeRoot=$("#site_wrapper1")),this.$defaultScopeRoot},this.getScopeRoot=function(){return this.$scopeRoot||this.getDefaultScopeRoot()},this.setScopeRoot=function(e){this.$scopeRoot=e},this.getDefaultScopeBlocks=function(){return this.getScopeRoot()},this.getScopeBlocks=function(){return this.$scopeBlocks||this.getDefaultScopeBlocks()},this.setScopeBlocks=function(e){this.$scopeBlocks=e},this.setVersion=function(e,t){"undefined"==typeof t&&(t={}),"undefined"==typeof t.isEnableLockScreen?t.isEnableLockScreen=!0:t.isEnableLockScreen=!!t.isEnableLockScreen,t.isDisableCloseEditor=!!t.isDisableCloseEditor,t.skipProcessingItems=!!t.skipProcessingItems,"undefined"==typeof t.$scopeRoot&&(t.$scopeRoot=adapterManager.getDefaultScopeRoot()),adapterManager.setScopeRoot(t.$scopeRoot),"undefined"==typeof t.$scopeBlocks&&(t.$scopeBlocks=adapterManager.getDefaultScopeBlocks()),adapterManager.setScopeBlocks(t.$scopeBlocks),adapterManager.isEditor()&&null!==pages_editor.$bottomEditor.data("curSmartObj")&&!t.isDisableCloseEditor&&pages_editor.closeEditor(!0),adapterManager.prev_type=adapterManager.type,adapterManager.type=e;var a=$("body");if(a.removeClass(adapterManager.types.join(" ")).removeClass(adapterManager.nonPcClass).addClass(adapterManager.type),adapterManager.type!==adapterManager.ADAPTABILITY_TYPE_PC&&a.addClass(adapterManager.nonPcClass),$.isEmptyObject(adapterManager.data)&&(adapterManager.data=adapterManager.data_empty),$.isEmptyObject(adapterManager.data[adapterManager.type])&&(adapterManager.data[adapterManager.type]={}),$.isEmptyObject(adapterManager.data[adapterManager.prev_type])&&(adapterManager.data[adapterManager.prev_type]={}),!t.skipProcessingItems)if(t.isEnableLockScreen&&adapterManager.isEditor()){var i;switch(e){case adapterManager.ADAPTABILITY_TYPE_MOBILE:i="Переход в мобильный редактор";break;case adapterManager.ADAPTABILITY_TYPE_TABLET:i="Переход в редактор для планшета";break;case adapterManager.ADAPTABILITY_TYPE_PC:default:i="Переход в редактор для ПК"}var n=lockScreen(i,{css_class:"locker-white",show_animation:!0}),r=!0;r&&$("body").addClass("editor-hidden"),setTimeout(function(){adapterManager.processingItems(),r&&$("body").removeClass("editor-hidden"),FE.run("adapter_manager/set_version"),unlockScreen(n)},50)}else adapterManager.processingItems()},this.initProcessingBlocks=function(e){"undefined"!=typeof e?e==adapterManager.ADAPTABILITY_TYPE_PC?(adapterManager.$sections=adapterManager.getScopeRoot().find(".blk_section:visible[adapter_type="+e+"], .blk_section:visible:not([adapter_type])"),adapterManager.$blocks=adapterManager.getScopeBlocks().find(".blk:visible[adapter_type="+e+"], .blk:visible:not([adapter_type])"),adapterManager.$containers=adapterManager.getScopeBlocks().find(".blk_container:visible[adapter_type="+e+"], .blk_container:visible:not([adapter_type])")):(adapterManager.$sections=adapterManager.getScopeRoot().find(".blk_section:visible[adapter_type="+e+"]"),adapterManager.$blocks=adapterManager.getScopeBlocks().find(".blk:visible[adapter_type="+e+"]"),adapterManager.$containers=adapterManager.getScopeBlocks().find(".blk_container:visible[adapter_type="+e+"]")):(adapterManager.$sections=adapterManager.getScopeRoot().find(".blk_section:visible:not([adapter_type="+adapterManager.type+"])"),adapterManager.$blocks=adapterManager.getScopeBlocks().find(".blk:visible:not([adapter_type="+adapterManager.type+"])"),adapterManager.$containers=adapterManager.getScopeBlocks().find(".blk_container:visible:not([adapter_type="+adapterManager.type+"])"))},this.savePC=function(){adapterManager.initProcessingBlocks(adapterManager.ADAPTABILITY_TYPE_PC),adapterManager.processingBlocksBeforeResize(),adapterManager.processingContainersBeforeResize(),adapterManager.processingSectionBeforeResize()},this.setVisibleSlides=function(e){e?adapterManager.getScopeBlocks().find(".hidden-slide").addClass("vis"):adapterManager.getScopeBlocks().find(".hidden-slide").removeClass("vis")},this.processingItems=function(){this.processResizing=1;var e=adapterManager.getSettings(adapterManager.type);adapterManager.setVisibleSlides(!0),adapterManager.showHideSections(),adapterManager.savePC();var t=$("#site_wrapper1 .blk_section.is_absolute").length>0;if(t&&null!=adapterManager.hybridData[adapterManager.type]){var a=adapterManager.hybridData[adapterManager.type];1!==adapterManager.allowMediaQuery&&(adapterManager.processingHybridSections(a,t),adapterManager.processingHybridBlocks(a,t))}adapterManager.initProcessingBlocks(),adapterManager.resizeContent(e),adapterManager.resizeFormPopover(e),adapterManager.resizeWindowPopup(e),adapterManager.processingSectionAfterResize(e),adapterManager.processingContainersAfterResize(e),adapterManager.processingBlocksAfterResize(),adapterManager.hasOwnProperty("slickOpt")&&adapterManager.reinitializeSlick(),adapterManager.isEditor()&&adapterManager.initContainersCells(e),adapterManager.fixFakeSections(),adapterManager.setVisibleSlides(!1),this.processResizing=0},this.processingHybridSections=function(e,t){$("#site_wrapper1 .blk_section").each(function(){
var a=$(this),i=a.attr("id"),n=e[i],r={};return null==n||0===n.length?(n=adapterManager.hybridData[adapterManager.ADAPTABILITY_TYPE_PC][i],r=null==n?{}:n):r=n,!(!t||a.hasClass("is_absolute"))||void(null!=r&&0!==r.length&&null!=r.blk_height&&a.css("height",r.blk_height))})},this.processingHybridBlocks=function(e,t){$("#site_wrapper1 .blk").each(function(){var a=$(this),i=a.attr("id"),n={},r=a.closest(".blk_section");if(t&&(!r.hasClass("is_absolute")||r.hasClass("hybrid-block-converting")))return!0;if(null!=e[i]&&0!==e[i].length){null!=e[i].blk_height&&(n.height=e[i].blk_height),null!=e[i].blk_width&&(n.width=e[i].blk_width),null!=e[i].pos_left&&(n.left=e[i].pos_left),null!=e[i].pos_top&&(n.top=e[i].pos_top);var o=e[i].rotate;null!=o&&(n.transform=0==o?"":"rotate("+o+"deg)"),a.css(n)}else{var s=adapterManager.hybridData[adapterManager.ADAPTABILITY_TYPE_PC][i];null==s&&(s=window.hybridData.getBlockData(a));var d=s.pos_left,l=s.pos_top,c=s.blk_width,p=s.blk_height,u=s.rotate,f=adapterManager.getSettings(adapterManager.type),h=f.width;if(null!=u&&a.css("transform",0==u?"":"rotate("+u+"deg)"),null!=d){var _=d;h<d+c&&(_=h-c,_<0&&(_=0)),a.css("left",_)}if(null!=l){var m=l,g=a.parent().closest(".blk_box_slider:visible");if(g.length>0)var v=g;else v=r;var w=v.height();0!=w&&w<l+p&&(m=w-p,m<0&&(m=0)),a.css("top",m)}if(null!=c){var b=c;if(c>h){b=h;var y=blockManager.getBlock(i,!0);"image_ext"==y.blockName&&2==y.data.shape_type&&(p=b)}a.css("width",b)}null!=p&&a.css("height",p)}switch(a.attr("blk_class")){case"blk_text":case"blk_image":""!=a.css("height")&&a.css("height","");break;case"blk_form":var k=a.find(".blk_form_wrap form:visible");k.length&&a.css("height",k.first().get(0).offsetHeight)}})},this.addHybridDataItem=function(e,t,a){var i={};null==adapterManager.hybridData[e]&&(adapterManager.hybridData[e]={}),null!=a.blk_height&&(i.blk_height=parseInt(a.blk_height)),null!=a.blk_width&&(i.blk_width=parseInt(a.blk_width)),null!=a.pos_left&&(i.pos_left=parseInt(a.pos_left)),null!=a.pos_top&&(i.pos_top=parseInt(a.pos_top)),null!=a.rotate&&(i.rotate=parseInt(a.rotate)),adapterManager.hybridData[e][t]=i},this.setAdaptiveHybridDataFromObject=function(e){$.each(e,function(e,t){adapterManager.addHybridDataItem(e,t.id,t)})},this.addHybridData=function(e){for(var t in e)if(e.hasOwnProperty(t))for(var a in e[t])e[t].hasOwnProperty(a)&&adapterManager.addHybridDataItem(t,a,e[t][a])},this.removeHybridData=function(e,t){null==t&&(t=[]);for(var a in this.hybridData)t.indexOf(a)===-1&&null!==this.hybridData[a][e]&&delete this.hybridData[a][e]},this.fixFakeSections=function(){adapterManager.isEditor()||$("#sections_list").children(".blk_section.fixed_fake").each(function(){var e=$(this).attr("id").substr(0,32),t=$("#"+e);$(this).css({height:t.css("height"),padding:t.css("padding")})})},this.showHideSections=function(){if(adapterManager.isEditor()){var e=adapterManager.getScopeRoot().find(".blk_section");e.each(function(){var e=$(this),t=e.attr("adapter_type"),a=e.hasClass("fixed_fake")?e.attr("id").substr(0,32):e.attr("id"),i="undefined"==typeof adapterManager.data[adapterManager.type][a]?{}:adapterManager.data[adapterManager.type][a],n="remove";if(("undefined"==typeof t||adapterManager.ADAPTABILITY_TYPE_PC==t)&&adapterManager.isEditor()){var r="undefined"==typeof adapterManager.data[adapterManager.ADAPTABILITY_TYPE_PC][a]?{}:adapterManager.data[adapterManager.ADAPTABILITY_TYPE_PC][a];r.is_hidden=e.hasClass("is_hidden_on_pc")?1:0,adapterManager.data[adapterManager.ADAPTABILITY_TYPE_PC][a]=r}adapterManager.isPC()?"undefined"!=typeof i.is_hidden&&1==i.is_hidden&&(n="add"):"undefined"!=typeof i.is_hidden&&1==i.is_hidden&&(n="add"),"add"==n?e.addClass("is_hidden"):e.removeClass("is_hidden")})}},this.resizeContent=function(e){if(1!==adapterManager.allowMediaQuery){var t="#site_wrapper1";adapterManager.isView()&&(t+=",body"),$(t).css("min-width",e.min_width);var a=e.popup_section_inner!==!1&&e.popup_section_inner,i=$();adapterManager.$sections.each(function(){i=$(this),i.hasClass("section_popup")&&a!==!1?i.find(".blk_section_inner:first").css({width:a}):i.find(".blk_section_inner:first").css({width:e.width})})}},this.resizeFormPopover=function(e){},this.resizeWindowPopup=function(e){$("#btnPopupWnd").css("width",e.window_popover_width),$("#j_lead_confirm").css("width",e.window_popover_width)},this.processingContainersBeforeResize=function(){adapterManager.$containers.each(function(){var e=$(this),t=e.attr("adapter_type");"undefined"==typeof t&&(t=adapterManager.ADAPTABILITY_TYPE_PC);var a=e.hasClass("v3"),i=a?".td_container_cell":".cell.container_cell",n=e.find(".blk_container_cells:first>"+i),r=e.find(".blk_container_cells:first").outerWidth(),o=t==adapterManager.ADAPTABILITY_TYPE_PC||"undefined"==typeof e.attr("count-cell-in-row")?n.length:e.attr("count-cell-in-row"),s=0;n.each(function(){var e=$(this),i=e.attr(a?"cell_id":"id"),n=e.css("padding"),o="undefined"!=typeof InstallTrigger;o&&(n=e.css("padding-top")+" "+e.css("padding-left")),s=number_format((100*e.outerWidth()/r).toFixed(3),3,"."),adapterManager.data[t][i]={},1!==adapterManager.allowMediaQuery&&(adapterManager.data[t][i]={width:s,padding:n,margin_left:parseInt(e.css("margin-left"))})});var d=e.find(".blk_container_cells:first "+i+":not(:first):first");adapterManager.data[t][e.attr("id")]={cell_margin_horizontal:parseFloat(d.css("margin-left")),w_container_cells:r,count_cell_in_row:o}})},this.processingContainersAfterResize=function(e){adapterManager.$containers.each(function(){var t=$(this);t.attr("adapter_type",adapterManager.type);var a="undefined"!=typeof adapterManager.data[adapterManager.type][t.attr("id")]&&adapterManager.data[adapterManager.type][t.attr("id")],i=parseInt(0==a||"undefined"==typeof a.count_cell_in_row?e.default_count_cell_in_row:a.count_cell_in_row),n=t.hasClass("v3");if(adapterManager.isPC()){if(1!==adapterManager.allowMediaQuery&&n&&t.find(".blk_container_cells:first").css({display:"table"}),(1!==adapterManager.allowMediaQuery||!n)&&(adapterManager.processingCellsInBlockOnPC(t),adapterManager.isEditor())){var r=n?".td_container_cell":".cell.container_cell",o=t.find(".blk_container_cells:first>"+r);adapterManager.setResizerPosition(o)}}else 1===adapterManager.allowMediaQuery&&n||(n&&t.find(".blk_container_cells:first").css({display:"flex","flex-flow":"row wrap"}),adapterManager.setCountColumn(t,i))}),adapterManager.hasOwnProperty("slickOpt")&&adapterManager.reinitializeSlick()},this.removeSlickClasses=function(e){e.length&&e.removeClass("initSlick")},this.rebuildSlick=function(e){e.length&&e.each(function(e){var t=$(this),a=t.closest(".blk_box_slider"),i=t.children(".slider:first");null!=i.get(0).slick&&(i.slick("unslick"),i.slick(adapterManager.slickOpt[a.attr("id")]))})},this.reinitializeSlick=function(){var e=this.getScopeRoot();this.getScopeRoot().is("#popup_list")?this.removeSlickClasses(e.find(".initSlick")):this.removeSlickClasses(e.find("#popup_list .initSlick")),this.rebuildSlick(e.find(".blk_box_slider_self"))},this.processingCellsInBlockOnPC=function(e){var t=e.hasClass("v3");if(1!==adapterManager.allowMediaQuery||!t){var a=t?".td_container_cell":".cell.container_cell",i=e.find(".blk_container_cells:first>"+a);e.find(".row-splitter").remove(),1!==adapterManager.allowMediaQuery&&i.each(function(){var e=$(this),a=e.attr(t?"cell_id":"id"),i=adapterManager.data[adapterManager.ADAPTABILITY_TYPE_PC][a];e.css({width:i.width+"%",padding:i.padding,"margin-left":i.margin_left})})}processingBlockInCells(i)},this.processingSectionBeforeResize=function(){adapterManager.$sections.each(function(){var e=$(this),t=e.attr("adapter_type");"undefined"==typeof t&&(t=adapterManager.ADAPTABILITY_TYPE_PC);var a=e.find(".blk_section_inner:first"),i="undefined"==typeof adapterManager.data[t][e.attr("id")]?{}:adapterManager.data[t][e.attr("id")];i.pad_top=e.css("padding-top"),i.pad_bottom=e.css("padding-bottom"),i.width=a.css("width"),i["max-width"]=a.css("max-width"),adapterManager.data[t][e.attr("id")]=i})},this.processingSectionAfterResize=function(){adapterManager.$sections.each(function(){var e=$(this);e.attr("adapter_type",adapterManager.type);var t=e.attr("id"),a="undefined"==typeof adapterManager.data[adapterManager.type][t]?{}:adapterManager.data[adapterManager.type][t];if(1!==adapterManager.allowMediaQuery){var i={};"undefined"!=typeof a.pad_top&&(i["padding-top"]=a.pad_top),"undefined"!=typeof a.pad_bottom&&(i["padding-bottom"]=a.pad_bottom),e.css(i);var n={};"undefined"!=typeof a.width&&(n.width=a.width),"undefined"!=typeof a["max-width"]&&(n["max-width"]=a["max-width"]),e.find(".blk_section_inner:first").css(n)}(e.hasClass("bg_type_map")||"map"==e.attr("bg_type"))&&yandexMaps.reInitMap(e.attr("id"),e.attr("data-map-latitude"),e.attr("data-map-longitude"))})},this.processingBlocksBeforeResize=function(){adapterManager.$blocks.each(function(){var e=$(this);if(e.closest(".slick-cloned").length>0)return!0;var t=e.attr("blk_class"),a=e.attr("adapter_type"),i=e.attr("id");if("undefined"==typeof a&&(a=adapterManager.ADAPTABILITY_TYPE_PC),"blk_image_ext"===t&&adapterManager.isEditor()){var n=e.find(".img-crop:first"),r=n.find("img:first, .svg_container"),o=e.find(".blk_image_data_wrap:first");pages_editor.img_ext_list_w[i]={crop_start_w:n.width(),crop_start_h:n.height(),prod_start_w:r.width(),wrap_start_w:o.width(),img_position_start:r.length>0?r.position():{top:0,left:0},real_w:r.attr("real_w"),real_h:r.attr("real_h")}}adapterManager.data[a][i]=adapterManager.getAdaptiveDataOfBlock(e)})},this.processingBlocksAfterResize=function(){adapterManager.$blocks.each(function(){$(this).attr("adapter_type",adapterManager.type),adapterManager.processingBlockAfterResize($(this))})},this.getSrcImageMod=function(e,t,a){var i=e.split(".").pop(),n=e.substring(0,e.indexOf("/-/"));if("gif"==i)return e;var r=a?"/-/scale/x2":"";if("undefined"!=typeof t.offset_top&&"undefined"!==t.offset_left&&"undefined"!==t.crop_w&&"undefined"!==t.crop_h&&"undefined"!==t.real_w&&"undefined"!==t.real_h&&"undefined"!==t.prod_w&&"undefined"!==t.prod_h){var o=t.prod_h/t.real_h,s=t.prod_w/t.real_w,d=Math.ceil(Math.abs(t.offset_left||0)/s),l=Math.ceil(Math.abs(t.offset_top||0)/o),c=Math.ceil((t.crop_w||0)/s),p=Math.ceil((t.crop_h||0)/o);r+="/-/crop/"+d+"x"+l+"x"+c+"x"+p}return t.crop_w&&(r+="/-/resize/"+t.crop_w),t.quality&&(r+="/-/quality/"+t.quality),r+="/file."+i,r=n+r},this.processingBlockAfterResize=function(e){var t=e.attr("id"),a=adapterManager.data[adapterManager.type][t],i={};null==a?(a=adapterManager.data[adapterManager.ADAPTABILITY_TYPE_PC][t],i=null==a?{}:a):i=a,adapterManager.setBlockData(e,i)},this.setBlockData=function(e,t){var a,i=e.attr("blk_class");switch(adapterManager.isEditor()||"blk_image_ext"!=i||(i="blk_image"),i){case"blk_image":var n=e.find(".img_container img:first:not(.zoom-icon), .svg_wrap");if(e.has(".blk_image_data_wrap.empty").length||null==n.attr("src")||""==n.attr("src"))break;if("undefined"!=typeof t.align){var r=e.find(".blk_image_data_wrap:first");r.removeClass("l_text").removeClass("c_text").removeClass("r_text").addClass(t.align)}var o=n.attr("bad-image");if(a=n.attr("src").split(".").pop(),"undefined"!=typeof t.prod_w&&1!==adapterManager.allowMediaQuery&&(n.css("width",t.prod_w).attr("prod_w",t.prod_w),n.css("height","auto")),!adapterManager.isEditor()&&(1!==adapterManager.allowMediaQuery&&("undefined"!=typeof t.crop_w&&n.css("width",t.crop_w),o?this.isPC()?(n.css("height",n.attr("pc-bad-img-h")),n.css("width",n.attr("medium-style-w"))):n.css("height",n.attr("mobile-bad-img-h")?n.attr("mobile-bad-img-h"):"auto"):this.isPC()?n.css("width",n.attr("medium-style-w")):n.css("height","auto")),"undefined"!=typeof n.attr("src")&&"svg"!=a)){var s=n.attr("src");if(adapterManager.isPC())s=o?n.attr("pc-adapt").replace(/\/resize\/\d+\//,"/resize/30/"):n.attr("pc-adapt");else if(1==t.has_crop_image){t.quality=n.attr("data-quality");var d=!1;n.attr("pc-adapt")&&(d=n.attr("pc-adapt").toString().indexOf("/scale/x2/")!=-1),s=this.getSrcImageMod(s,t,d)}n.attr("src",s)}break;case"blk_slider":var l=e.find(".fotorama:first");(l.hasClass("fotorama--is-ready")||e.closest(".blk_section").hasClass("section_popup"))&&adapterManager.own_slider_editor.reinitFotorama(l);break;case"blk_form":if("undefined"!=typeof t.width&&1!==adapterManager.allowMediaQuery&&e.find(".blk_form_wrap:not(.is_popover) form").css("width",t.width),"undefined"!=typeof t.align){var c=e.find(".blk_form_wrap:first");c.removeClass("l_text").removeClass("c_text").removeClass("r_text").addClass(t.align)}break;case"blk_video":if(adapterManager.isEditor()&&window.userCanUndoRedo){blockManager.getBlock(e.attr("id"),!0).applyToHtmlAdaptiveData(t);break}var p=e.find("iframe:first");if(p.length&&null!=t.width&&null!=t.height){var u={height:t.height,width:t.width};1!==adapterManager.allowMediaQuery&&(p.css(u),p.attr("data-width",u.width))}break;case"blk_image_ext":var f=e.find(".img-crop:first"),h=f.find("img:first, .svg_container"),_=h.length>0?h.position():{top:0,left:0},m={crop_w:0,crop_h:0,offset_top:0,offset_left:0,prod_w:0,prod_h:0};a="",h.attr("src")&&(a=h.attr("src").split(".").pop()),adapterManager.isEditor()&&pages_editor.setZoomImgExt(e.attr("id"),h),"undefined"!=typeof t.crop_w?m.crop_w=t.crop_w:m.crop_w=f.width(),"undefined"!=typeof t.crop_h?m.crop_h=t.crop_h:m.crop_h=f.height(),"undefined"!=typeof t.offset_top?m.offset_top=t.offset_top:m.offset_top=_.top,"undefined"!=typeof t.offset_left?m.offset_left=t.offset_left:m.offset_left=_.left,"undefined"!=typeof t.prod_w?m.prod_w=t.prod_w:m.prod_w=h.width(),"undefined"!=typeof t.prod_h?m.prod_h=t.prod_h:m.prod_h=h.height(),f.attr("crop_w",m.crop_w).attr("crop_h",m.crop_h).css({width:m.crop_w,height:m.crop_h}),h.attr("prod_w",m.prod_w).attr("prod_h",m.prod_h),h.attr("offset_top",m.offset_top).attr("offset_left",m.offset_left),"svg"===a?h.css({width:"100%"}):h.css({width:m.prod_w,top:m.offset_top,left:m.offset_left}),"undefined"!=typeof t.align&&(r=e.find(".blk_image_data_wrap:first"),r.removeClass("l_text").removeClass("c_text").removeClass("r_text").addClass(t.align));break;case"blk_yandex_map":var g=e.find(".yandex_map_wrap:first"),v=e.find(".blk_yandex_map_data_wrap:first"),w={};"undefined"!=typeof t.width&&(w.width=t.width,v.attr("data-width",t.width)),"undefined"!=typeof t.height&&(w.height=t.height,v.attr("data-height",t.height)),1!==adapterManager.allowMediaQuery&&g.css(w);var b=e.attr("id"),y=v.attr("data-map-latitude"),k=v.attr("data-map-longitude");yandexMaps.reInitMap(b,y,k);break;case"blk_text":if(!adapterManager.isEditor()&&1===adapterManager.allowMediaQuery)break;var $=e.children(".blk-data");$.length>1&&($=$.filter("."+adapterManager.type+"--blk-data:first"));var M={},x="",C="";if("undefined"!=typeof t.body&&adapterManager.isEditor()&&$.html(t.body),adapterManager.isPC()||(x=parseInt($.css("font-size")),C=$.css("text-align")),1===adapterManager.allowMediaQuery)break;"undefined"!=typeof t.padding_top&&(M["padding-top"]=t.padding_top),"undefined"!=typeof t.padding_bottom&&(M["padding-bottom"]=t.padding_bottom),M["text-align"]=C,"undefined"!=typeof t.text_align&&(M["text-align"]=t.text_align),M["font-size"]=x,"undefined"!=typeof t.font_size&&(M["font-size"]=t.font_size),$.css(M);break;case"blk_divider":"undefined"!=typeof t.blc_height&&1!==adapterManager.allowMediaQuery&&e.find(".blk_divider_self:first").css("height",t.blc_height);break;case"blk_button":case"blk_button_popup":if("undefined"!=typeof t.align){var S=e.find(".blk_button_data_wrap:first");S.removeClass("l_text").removeClass("c_text").removeClass("r_text").addClass(t.align)}}},this.initContainersCells=function(e){adapterManager.$containers.each(function(){$(this).attr("adapter_type",adapterManager.type),adapterManager.initContainerCells($(this),e)})},this.initContainerCells=function(e,t){e.find(".cell-resizer").remove();for(var a=1,i=$(),n=1,r=e.hasClass("v3")?3:2,o=3==r?".td_container_cell":".cell.container_cell";;){if(i=e.find(".blk_container_cells:first>"+o+"[row="+a+"]"),0==i.length)break;n=1,i.each(function(){n!=i.length&&adapterManager.appendContainerCellResizer(t,$(this)),++n}),++a}adapterManager.updateCells(e)},this.appendContainerCellResizer=function(e,t){var a=e.cell_margin_horizontal!==!1?e.cell_margin_horizontal:3,i=t.closest(".blk_container").hasClass("v3")?3:2;if(3==i)return!0;var n=t.attr(3==i?"cell_id":"id"),r="cell-resizer-"+n,o=$("#"+r);0==o.length&&(o=$('<div class="cell-resizer"></div>'),o.attr("id",r).attr("parent",n).attr("margin_horizontal",a),t.parent().find(".row-splitter[owner-row="+t.attr("row")+"]:first").append(o))},this.updateCells=function(e,t){var a="";"undefined"!=typeof t&&(a="[row="+t+"]");var i=e.hasClass("v3")?3:2,n=3==i?".td_container_cell":".cell.container_cell";if(0!=e.length){var r=e.find(".blk_container_cells:first>"+n+a),o=0,s=$(),d=$();r.each(function(){s=$(this),o=parseInt(s.attr("row"))}),r.each(function(){s=$(this);var e=s.attr(3==i?"cell_id":"id");if(d=$("#cell-resizer-"+e),0!=d.length){var t=d.attr("margin_horizontal");d.css({height:40,left:s.position().left+parseInt(s.css("width"))+Math.floor(t/2)+parseInt(t)})}})}},this.getSettings=function(e){var t={};switch(e){case adapterManager.ADAPTABILITY_TYPE_PC:t={min_width:adapterManager.site_width,width:adapterManager.site_width,popup_section_inner:!1,form_popover_width:400,window_popover_width:500,cell_margin_horizontal:!1,default_count_cell_in_row:1};break;case adapterManager.ADAPTABILITY_TYPE_TABLET:t={min_width:adapterManager.DEVICE_TABLET_CONTENT_MIN_WIDTH,width:adapterManager.DEVICE_TABLET_CONTENT_MIN_WIDTH,popup_section_inner:adapterManager.DEVICE_TABLET_POPUP_MIN_WIDTH,form_popover_width:adapterManager.DEVICE_TABLET_POPUP_MIN_WIDTH,window_popover_width:450,cell_margin_horizontal:3,default_count_cell_in_row:2};break;case adapterManager.ADAPTABILITY_TYPE_MOBILE:t={min_width:adapterManager.DEVICE_MOBILE_CONTENT_MIN_WIDTH,width:adapterManager.DEVICE_MOBILE_CONTENT_MIN_WIDTH,popup_section_inner:adapterManager.DEVICE_MOBILE_POPUP_MIN_WIDTH,form_popover_width:adapterManager.DEVICE_MOBILE_POPUP_MIN_WIDTH,window_popover_width:340,cell_margin_horizontal:3,default_count_cell_in_row:2};break;case"":}return t},this.clearDataById=function(e){for(var t in adapterManager.data)adapterManager.ADAPTABILITY_TYPE_PC!=t&&saveMan.add("reset_block_data",{block_id:e,adaptability_type:t})},this.resetSizeInContainer=function(e){var t=$("#"+e);if(t.hasClass("blk_container")){var a=t.hasClass("v3")?3:2,i=3==a?".td_container_cell":".cell.container_cell";t.find(".blk_container_cells:first>"+i+", .blk").each(function(){var e=$(this).attr(3==a&&$(this).hasClass("td_container_cell")?"cell_id":"id");adapterManager.resetBlockData(e)})}},this.resetBlockData=function(e){var t=$("#"+e),a="";t.hasClass("blk_section")&&(a="blk_section"),t.hasClass("blk_container")&&(a="blk_container"),t.hasClass("container_cell")&&(a="container_cell"),"undefined"!=typeof t.attr("blk_class")&&(a=t.attr("blk_class"));var i=["blk_section","blk_container","blk_divider","blk_text","blk_slider","blk_button","blk_button_popup","blk_html","blk_image_ext, blk_image"];$.inArray(a,i)>=0||adapterManager.clearDataById(e)},this.saveCells=function(e){var t={id:e.attr("id"),cells:[]},a=e.hasClass("v3")?3:2,i=3==a?".td_container_cell":".cell.container_cell";t.version=a,e.find(".blk_container_cells:first>"+i).each(function(){var e=$(this),i=e.attr(3==a?"cell_id":"id");t.cells.push({id:i,width:parseFloat(e[0].style.width)})}),saveMan.add("mod_container_cells",t)},this.setCountColumn=function(e,t,a){if(e.closest(".slick-cloned").length>0)return!0;e.attr("count-cell-in-row",t);var i=e.attr("id"),n=adapterManager.data[adapterManager.ADAPTABILITY_TYPE_PC][i];if("undefined"!=typeof n){var r=adapterManager.data[adapterManager.type][i],o=adapterManager.getSettings(adapterManager.type),s=!1,d={},l=e.hasClass("v3"),c=l?".td_container_cell":".cell.container_cell",p=e.find(".blk_container_cells:first>"+c),u=e.width(),f=n.w_container_cells,h="undefined"==typeof r||"undefined"==typeof r.cell_margin_horizontal?o.cell_margin_horizontal:r.cell_margin_horizontal,_=0,m=0,g=[],v=0,w=!1,b=1,y=0,k=e.closest(".slide").length>0,M=100/u,x=(100/f).toFixed(3),C=0,S=k&&!a?2.8:0;e.find(".row-splitter").remove(),p.each(function(){1!==adapterManager.allowMediaQuery&&$(this).css({"padding-left":0,"padding-right":0});var a=$(this).attr(l?"cell_id":"id");if(++_,d=adapterManager.data[adapterManager.ADAPTABILITY_TYPE_PC][a],m+=parseFloat(d.width),g.push(a),_%t==0||_==p.length){v=u-h*(g.length+1);var i=Math.floor(m/x),n="";if(!adapterManager.isPC()){var r=$('<div class="row-splitter clearfix" style="height: '+C+'px"></div>');r.attr("owner-row",b),w=l?$("div[cell_id="+g[0]+"]"):$("#"+g[0]),l&&r.css("display","table-row"),w.before(r)}for(var o in g){w=l?$("div[cell_id="+g[o]+"]"):$("#"+g[o]);var c=0;s="undefined"!=typeof adapterManager.data[adapterManager.type][g[o]]&&adapterManager.data[adapterManager.type][g[o]];var f=0!=s&&"undefined"!=typeof s.width&&s.width;d=adapterManager.data[adapterManager.ADAPTABILITY_TYPE_PC][g[o]];var k=0;if(0==f){var T=Math.floor(d.width/x);k=100*T/i,c=Math.round((k-S)/(100/v).toFixed(3)),n=number_format((M*c).toFixed(3),3,".")}else n=f;1!==adapterManager.allowMediaQuery&&w.css({width:n+"%","margin-left":h}),adapterManager.resetSizeImageExt(w),processingBlockInCells(w),w.attr("row",b)}adapterManager.updateCells(e,b),g=[],m=0,y=0,++b,C=11}}),adapterManager.setResizerPosition(p,h)}},this.setResizerPosition=function(e,t){t=t||0;var a=e.find(".blk-container__resize-inner").removeAttr("style");if(!adapterManager.isPC()){var i=parseInt(a.css("left"),10);a.css("left",i-(t/2).toFixed(0))}},this.resetSizeImageExt=function(e){var t=e.hasClass("blk_image_ext")?e:e.find(".blk.blk_image_ext");"undefined"!=typeof adapterManager.data[adapterManager.ADAPTABILITY_TYPE_PC]&&t.each(function(){var e=$(this),t=e.attr("id"),a="undefined"==typeof adapterManager.data[adapterManager.ADAPTABILITY_TYPE_PC][t]?{}:adapterManager.data[adapterManager.ADAPTABILITY_TYPE_PC][t];adapterManager.setBlockData(e,a)})},this.initView=function(){adapterManager.initFotorama()},this.initResize=function(e){var t=function(t){var a=$(window).width(),i=adapterManager.ADAPTABILITY_TYPE_PC;for(var n in e){var r=e[n];a>=r.min&&a<=r.max&&(i=r.name)}t||(t={}),adapterManager.setVersion(i,t)};$(window).resize(function(){clearTimeout(adapterManager.resize_timer),adapterManager.resize_timer=setTimeout(t,100)}),FE.add("show_section_popup",function(e){var a={};isset(e.section_id)&&(a.$scopeBlocks=$("#"+e.section_id),a.$scopeRoot=$("#popup_list")),t(a),adapterManager.setScopeRoot(adapterManager.getDefaultScopeRoot()),adapterManager.setScopeBlocks(adapterManager.getDefaultScopeBlocks())}),t()},this.setSectionState=function(e,t){"undefined"==typeof adapterManager.data[e]&&(adapterManager.data[e]={}),"undefined"==typeof adapterManager.data[e][t.id]&&(adapterManager.data[e][t.id]={}),adapterManager.data[e][t.id][t.name]=t.value},this.getAdaptiveParamsForSave=function(e,t,a){return{type:t,id:e,adaptability_type:a}},this.processingBlockTextBeforeSave=function(e,t){if(adapterManager.isPC()&&"save_block"==e&&"text"==t.type){var a=adapterManager.blockTextPcContents[t.id],i=adapterManager.getTextContent($(ge(t.id)));null==a&&(a=i);for(var n in adapterManager.data)if(adapterManager.data.hasOwnProperty(n)){var r=adapterManager.data[n];if(null!=r&&null!=r[t.id]&&null!=r[t.id].body){var o=r[t.id],s=0;delete adapterManager.data[n][t.id].body,s=1;var d=adapterManager.getAdaptiveParamsForSave(t.id,t.type,n);d.replace_all_data=s,d.padding_top=o.padding_top||0,d.padding_bottom=o.padding_bottom||0,o.text_align&&(d.text_align=o.text_align),o.font_size&&(d.font_size=o.font_size),saveMan.add("save_adaptive_data",d)}}adapterManager.blockTextPcContents[t.id]=i}},this.getParamsForSaveAdaptiveDataOfBlock=function(e){var t=e.attr("id"),a=e.attr("blk_class").replace("blk_",""),i=adapterManager.getAdaptiveParamsForSave(t,a,adapterManager.type),n=adapterManager.getAdaptiveDataOfBlock(e);return extend(i,n),i},this.getAdaptiveDataOfBlock=function(e){if(adapterManager.isEditor()&&window.userCanUndoRedo)return blockManager.getBlock(e.attr("id"),!0).getAdaptiveDataFromHtml();var t={},a=e.attr("blk_class");switch(adapterManager.isEditor()||"blk_image_ext"!==a||(a="blk_image"),a){case"blk_text":var i=e.find(".blk-data:first");t.body=i.html(),t.text_align=i.css("text-align"),t.font_size=parseInt(i.css("font-size")),t.padding_top=parseInt(i.css("padding-top")),t.padding_bottom=parseInt(i.css("padding-bottom")),t.padding_left=parseInt(i.css("padding-left")),t.padding_right=parseInt(i.css("padding-right")),t.is_padding_split=1,t.padding_top===t.padding_bottom&&t.padding_top===t.padding_left&&t.padding_left===t.padding_right&&(t.is_padding_split=0);break;case"blk_image":t.prod_w=e.find(".img_container img").css("width"),t.prod_h=e.find(".img_container img").css("height");var n=e.find(".blk_image_data_wrap:first");n.hasClass("l_text")?t.align="l_text":n.hasClass("r_text")?t.align="r_text":n.hasClass("c_text")&&(t.align="c_text");break;case"blk_image_ext":var r=e.find(".img-crop:first"),o=r.find("img:first, .svg_container"),s=o.length>0?o.position():{top:0,left:0},d=e.find(".blk_image_data_wrap:first");t={crop_w:r.width(),crop_h:r.height(),offset_top:s.top,offset_left:s.left,prod_w:o.width(),prod_h:o.height()},d.hasClass("l_text")?t.align="l_text":d.hasClass("r_text")?t.align="r_text":d.hasClass("c_text")&&(t.align="c_text");break;case"blk_button":case"blk_button_popup":var l=e.find(".blk_button_data_wrap:first");l.hasClass("l_text")?t.align="l_text":l.hasClass("r_text")?t.align="r_text":l.hasClass("c_text")&&(t.align="c_text");break;case"blk_form":var c=e.find(".blk_form_wrap:first");c.hasClass("l_text")?t.align="l_text":c.hasClass("r_text")?t.align="r_text":c.hasClass("c_text")&&(t.align="c_text");var p=c.children("form:first").css("width");t.width="100%"===p?null:parseInt(p);break;case"blk_video":var u=e.find("iframe:first");t.width=u.width(),t.height=u.height();break;case"blk_yandex_map":var f=e.find(".yandex_map_wrap:first");t.width=f.width(),t.height=f.height();break;case"blk_divider":t.blc_height=e.find(".blk_divider_self:first").height()}return t},this.saveAdaptiveDataOfBlock=function(e){var t=adapterManager.getAdaptiveDataOfBlock(e),a=adapterManager.getParamsForSaveAdaptiveDataOfBlock(e),i=a.adaptability_type;if(adapterManager.data[i][a.id]=t,saveMan.add("save_adaptive_data",a),pages_editor.userCanUndoRedo){var n=blockManager.getBlock(a.id,!0);n.setAdaptiveData(i,t)}},this.processingDataBeforeSave=function(e,t){if("save_adaptive_data"!==e){switch(adapterManager.processingBlockTextBeforeSave(e,t),e){case"reset_block_data":"undefined"!=typeof adapterManager.data[t.adaptability_type]&&"undefined"!=typeof adapterManager.data[t.adaptability_type][t.block_id]&&delete adapterManager.data[t.adaptability_type][t.block_id]}if(window.userCanUndoRedo&&"save_block"===e&&!t.type)throw new Error('Error #5358 The parameter "type" is required');if(window.userCanUndoRedo&&!adapterManager.isPC()&&("save_img_ext_size"===e||"save_block"===e&&"image_ext"===t.type)&&!t.align)throw new Error('Error #5359 The parameter "align" is required');if(!adapterManager.isPC()&&"undefined"==typeof t.adaptability_type){switch(e){case"save_img_size":case"save_img_ext_size":case"save_yandex_map_size":case"save_video_size":case"save_form_size":case"save_popup_style":case"mod_pad_section":case"mod_container_cells":case"set_section_state":case"save_count_cells_in_row":t.adaptability_type=adapterManager.type;break;case"save_block":adapterManager.adaptiveDataIsEnabledForBlock($("#"+t.id))&&(t.adaptability_type=adapterManager.type)}switch(e){case"save_img_size":adapterManager.data[adapterManager.type][t.id]={prod_w:t.prod_w,prod_h:t.prod_h};break;case"save_img_ext_size":adapterManager.data[adapterManager.type][t.id]={crop_w:t.crop_w,crop_h:t.crop_h,offset_top:t.offset_top,offset_left:t.offset_left,prod_w:t.prod_w,prod_h:t.prod_h,align:t.align,is_our_svg_icon:t.is_our_svg_icon,svg_fill_color:t.svg_fill_color};break;case"save_yandex_map_size":adapterManager.data[adapterManager.type][t.id]={width:t.width,height:t.height};break;case"save_video_size":adapterManager.data[adapterManager.type][t.id]={width:t.width,height:t.height};break;case"save_form_size":"undefined"==typeof adapterManager.data[adapterManager.type][t.id]&&(adapterManager.data[adapterManager.type][t.id]={}),adapterManager.data[adapterManager.type][t.id].width=t.width;break;case"save_popup_style":adapterManager.data[adapterManager.type][t.id]={wnd_width:t.wnd_width};break;case"set_section_state":adapterManager.setSectionState(adapterManager.type,t);break;case"mod_pad_section":"undefined"==typeof adapterManager.data[adapterManager.type][t.id]&&(adapterManager.data[adapterManager.type][t.id]={}),adapterManager.data[adapterManager.type][t.id].pad_bottom=t.pad_bottom,adapterManager.data[adapterManager.type][t.id].pad_top=t.pad_top;break;case"mod_container_cells":for(var a in t.cells){var i=t.cells[a];adapterManager.data[adapterManager.type][i.id]={width:i.width}}break;case"save_block":if(blc_class=$("#"+t.id).attr("blk_class"),"blk_divider"==blc_class&&(adapterManager.data[adapterManager.type][t.id]={blc_height:t.blcHeight}),"blk_text"==blc_class){"undefined"==typeof adapterManager.data[adapterManager.type][t.id]&&(adapterManager.data[adapterManager.type][t.id]={}),"undefined"!=typeof t.html&&(adapterManager.data[adapterManager.type][t.id].body=t.html);var n=$("#"+t.id).find(".blk-data:first");adapterManager.data[adapterManager.type][t.id].text_align=n.css("text-align"),adapterManager.data[adapterManager.type][t.id].font_size=parseInt(n.css("font-size")),adapterManager.data[adapterManager.type][t.id].padding_top=parseInt(n.css("padding-top")),adapterManager.data[adapterManager.type][t.id].padding_bottom=parseInt(n.css("padding-bottom")),t.text_align=n.css("text-align"),t.font_size=parseInt(n.css("font-size")),t.padding_top=parseInt(n.css("padding-top")),t.padding_bottom=parseInt(n.css("padding-bottom"))}"blk_image_ext"==blc_class&&("undefined"==typeof adapterManager.data[adapterManager.type][t.id]&&(adapterManager.data[adapterManager.type][t.id]={}),adapterManager.data[adapterManager.type][t.id].align=t.align),"blk_button"!=blc_class&&"blk_button_popup"!=blc_class||(adapterManager.data[adapterManager.type][t.id]={align:t.align}),"blk_form"==blc_class&&("undefined"==typeof adapterManager.data[adapterManager.type][t.id]&&(adapterManager.data[adapterManager.type][t.id]={}),adapterManager.data[adapterManager.type][t.id].align=t.align);break;case"save_count_cells_in_row":adapterManager.data[adapterManager.type][t.id]={count_cell_in_row:t.count_cell_in_row}}}}},this.adaptiveDataIsEnabledForBlock=function(e){var t=e.attr("blk_class"),a=["blk_divider","blk_text","blk_form","blk_button","blk_button_popup","blk_image_ext"];return a.indexOf(t)>=0},this.actionFilter=function(e,t){var a=!0;if($.inArray(e,["del_block","del_section","del_container_cell","mod_container_cells"])!=-1)return a;if(!adapterManager.isPC())switch(a=!1,e){case"reset_block_data":case"save_img_size":case"save_img_ext_size":case"save_yandex_map_size":case"save_video_size":case"save_form_size":case"save_popup_style":case"mod_pad_section":case"mod_container_cells":case"save_count_cells_in_row":case"save_adaptive_settings":case"save_block_hybrid_data":case"save_section_hybrid_data":case"del_block_hybrid_data":case"save_blk_frozen_state":case"save_blk_hidden_state":case"save_group_block":case"del_group_block":case"del_blocks":case"add_new_block":case"save_ruler_state":case"convert_section_to_hybrid":case"save_order_in_parent":a=!0;break;case"save_adaptive_data":case"save_block":a=adapterManager.adaptiveDataIsEnabledForBlock($("#"+t.id));break;case"set_section_state":"is_hidden"==t.name&&(a=!0);break;default:a=!1}return a},this.hasVisibilityProperty=function(e,t){var a=!1;return"undefined"!=typeof adapterManager.data[e]&&"undefined"!=typeof adapterManager.data[e][t]&&"undefined"!=typeof adapterManager.data[e][t].is_hidden&&(a=!0),
a},this.getVisibilityBlock=function(e,t){var a=!1;return a=adapterManager.hasVisibilityProperty(e,t)?0==adapterManager.data[e][t].is_hidden:adapterManager.ADAPTABILITY_TYPE_PC!==e},this.setSectionClass=function(e){"undefined"==typeof e&&(e=adapterManager.getScopeRoot().find(".blk_section")),e.each(function(){var e=$(this);for(var t in adapterManager.types){var a="is_hidden_on_"+adapterManager.types[t];adapterManager.getVisibilityBlock(adapterManager.types[t],e.attr("id"))?e.removeClass(a):e.addClass(a)}})},this.cloneAdaptability=function(e,t,a){var i=!1;for(var n in adapterManager.data)"undefined"!=typeof adapterManager.data[n][e]&&(adapterManager.data[n][t]=clone(adapterManager.data[n][e]),adapterManager.ADAPTABILITY_TYPE_PC!=n&&(i||(saveMan.add("clone_adaptability",{type:a,old_block_id:e,new_block_id:t}),i=!0),"block"==a&&"undefined"!=typeof adapterManager.data[n][t].crop_h&&saveMan.add("save_img_ext_size",{id:t,type:"image_ext",prod_w:adapterManager.data[n][t].prod_w,prod_h:adapterManager.data[n][t].prod_h,crop_w:adapterManager.data[n][t].crop_w,crop_h:adapterManager.data[n][t].crop_h,offset_top:adapterManager.data[n][t].offset_top,offset_left:adapterManager.data[n][t].offset_left,align:adapterManager.data[n][t].align,adaptability_type:n})))},this.addAdaptabilityData=function(e){for(var t in e){"undefined"==typeof adapterManager.data[t]&&(adapterManager.data[t]={});for(var a in e[t])adapterManager.data[t][a]=e[t][a]}},this.initTextBlocks=function(){adapterManager.getScopeBlocks().find(".blk_text").each(function(){var e=$(this);adapterManager.blockTextPcContents[e.attr("id")]=adapterManager.getTextContent(e)})},this.initFotorama=function(){adapterManager.getScopeBlocks().find(".blk_slider_data_wrap > .fotorama, .blk-data > .fotorama").each(function(){var e=$(this);if(0==e.find(".fotorama__wrap").length){var t=e.closest(".blk_section").hasClass("is_absolute");if(t){var a=e.closest(".blk.blk_slider").height();e.attr("data-height",a)}e.on("fotorama:load",function(){$(this).addClass("fotorama--is-ready")}).fotorama()}else e.addClass("fotorama--is-ready");e=null})},this.initInEditor=function(){adapterManager.initTextBlocks(),adapterManager.initFotorama()},this.initInPreview=function(){adapterManager.initFotorama(),FE.add("show_section_popup",function(e){var t={};e.section_id&&(t.$scopeBlocks=$("#"+e.section_id),t.$scopeRoot=$("#popup_list")),adapterManager.setVersion(adapterManager.type,t)})},this.initStates=function(e){for(var t in e)e.hasOwnProperty(t)&&(adapterManager.states[t]=e[t]?1:0,adapterManager.types.push(t),adapterManager.typeIconsList.push(adapterManager.typeIcons[t]),adapterManager.data_empty[t]={})},this.getTextContent=function(e){"string"!=typeof e&&(e=e.find(".blk-data:first").html());var t=$("<div></div>").html(e);return t.find("*[style]").each(function(){$(this).css({"font-size":"inherit","text-align":"inherit","line-height":"normal"})}),t.find("link[f_id]").attr("href",""),t.html()},this.disableConfirmOnOtherEditorMode=function(){userAddTag("LPDEV-237")},this.needConfirmOnOtherEditorMode=function(){return window.userCanUndoRedo&&!historyManager.historyIsEmpty()&&!userHasTag("LPDEV-237")},this.getContainerAdaptiveDataDefault=function(e){return e.hasClass("v3")?blockContainerV3.getAdaptiveDataDefault():blockContainerV3.getAdaptiveDataDefault()},this.setContainerAdaptiveData=function(e,t){var a=adapterManager.getContainerAdaptiveData(e);extend(a,t)},this.getContainerAdaptiveData=function(e){var t=adapterManager.type,a=e.attr("id");return adapterManager.data[t][a]?adapterManager.data[t][a]:adapterManager.getContainerAdaptiveDataDefault(e)},this.saveCountCellsInRow=function(e,t){var a=adapterManager.type,i=$("#"+e);adapterManager.resetSizeInContainer(e),adapterManager.setCountColumn(i,t,!0),i.find(".blk").each(function(){adapterManager.processingBlockAfterResize($(this))});var n=adapterManager.getSettings(a);adapterManager.initContainerCells(i,n),adapterManager.setContainerAdaptiveData(i,{count_cell_in_row:t}),saveMan.add("save_count_cells_in_row",{id:e,count_cell_in_row:t}),adapterManager.saveCells(i)}}function t(){this.$btn_slider_settings=null,this.$wnd_slider_empty=null,this.$wnd_slider=null,this.$wnd_slider_images=null,this.$block_fotorama=null,this.$block_data_encoded=null,this.$block_wrap=null,this.$block_loading=null,this.smart_block=null}sliderEditorExtend(t),FE.runOnReady(function(){window.adapterManager=new e,window.adapterManager.ready()})}(),function(){var e={},t={};e.mouse_move=function(e){var a=e.pageX-t.pageX_start,i=t.w_parent_start+a;i=i<t.w_min?t.w_min:i,i=i>t.w_max?t.w_max:i;var n=100*i/t.gridWidthInPixel,r=t.changedCellsWidthInPercent-n;return t.$parent.css("width",n+"%"),t.$next.css("width",r+"%"),processingBlockInCells(t.$changedCells),adapterManager.updateCells(t.$container),!1},e.mouse_up=function(){if($(document).unbind("mousemove",e.mouse_move).unbind("mouseup",e.mouse_up),blockContainerOld.getWidthInPixel(t.$parent,t.gridWidthInPixel)!=t.w_parent_start&&($(this).data("cell",t.$parent),window.pages_editor.stopResizeColumn(!1,!1,t.$container,$(this),!0,!0),adapterManager.saveCells(t.$container)),window.userCanUndoRedo){var a=new cHistoryItemBlockCellV2Resize(t.$container.attr("id"));a.setNewData(a.getDataByEl(t.$parent)),historyBuffer.finishOperation(a)}return!1},e.mouse_down=function(a){if(t.pageY_start=a.pageY,t.pageX_start=a.pageX,t.$resizer=$(a.currentTarget),t.$container=t.$resizer.closest(".blk_container"),t.gridWidthInPixel=parseFloat(t.$resizer.closest(".blk_container_cells").width()),t.resizer_pos_start=t.$resizer.position(),t.$parent=$("#"+t.$resizer.attr("parent")),t.$next=t.$parent.next(),t.$changedCells=$("#"+t.$parent.attr("id")+", #"+t.$next.attr("id")),t.w_parent_start=blockContainerOld.getWidthInPixel(t.$parent,t.gridWidthInPixel),t.w_next_start=blockContainerOld.getWidthInPixel(t.$next,t.gridWidthInPixel),t.changedCellsWidthInPercent=parseFloat(blockContainerOld.getWidthInPercent(t.$parent,t.gridWidthInPixel))+parseFloat(blockContainerOld.getWidthInPercent(t.$next,t.gridWidthInPixel)),t.w_min=21,t.w_max=t.w_parent_start+t.w_next_start-t.w_min,t.margin_horizontal=t.$resizer.attr("margin_horizontal"),window.pages_editor.startResizeColumn(t.$parent,t.$next),window.userCanUndoRedo){var i=new cHistoryItemBlockCellV2Resize(t.$container.attr("id"));i.setOldData(i.getDataByEl(t.$parent)),historyBuffer.startOperation(i),pages_editor.beforeResizeInRoot(t.$changedCells)}return $(document).unbind("mousemove",e.mouse_move).unbind("mouseup",e.mouse_up),$(document).on("mousemove",e.mouse_move).on("mouseup",e.mouse_up),!1},$("#sections_list, #popup_list").on("mousedown",".cell-resizer",e.mouse_down)}(),function(){var e={},t={};e.click=function(a){switch(t.$btn=$(a.currentTarget),t.$block=t.$btn.closest(".blk"),t.type=t.$btn.attr("btn-type"),t.type){case"align_left":case"align_center":case"align_right":e.setAlign(t.type);break;case"save":e.saveBlock()}return!1},e.setAlign=function(e){var a,i,n=e.substr(6,1),r=n+"_text",o=t.$block.attr("id");window.userCanUndoRedo&&(a=new cHistoryItemBlockSaveAdaptive(o),i=adapterManager.getParamsForSaveAdaptiveDataOfBlock(t.$block),a.setOldData(i),historyBuffer.startOperation(a)),t.$block.find(".blk_image_data_wrap:first").removeClass("l_text").removeClass("c_text").removeClass("r_text").addClass(r);var s=pages_editor.$bottomEditor.data("curSmartObj");return s&&s.id===o&&(s.data.align=r),adapterManager.saveAdaptiveDataOfBlock(t.$block),a&&(i=adapterManager.getParamsForSaveAdaptiveDataOfBlock(t.$block),a.setNewData(i),historyBuffer.finishOperation(a)),!1},e.saveBlock=function(){adapterManager.saveAdaptiveDataOfBlock(t.$block)},$("#sections_list, #popup_list").on("click",".blk_image_ext .mc-text-control",e.click)}(),function(){var e={},t={};e.click=function(a){switch(t.$btn=$(a.currentTarget),t.$block=t.$btn.closest(".blk.blk_text"),t.$blk_data=t.$block.find(".blk-data:first"),t.type=t.$btn.attr("btn-type"),t.type){case"increase_font_size":case"decrease_font_size":e.setFontSize(t.type,t.$btn);break;case"align_left":case"align_center":case"align_right":e.setAlign(t.type);break;case"save":e.saveBlock()}return!1},e.setFontSize=function(e,a){var i,n,r=parseInt(t.$blk_data.css("font-size")),o=t.$block.attr("id");pages_editor.userCanUndoRedo&&(i=new cHistoryItemBlockSaveAdaptive(o),n=adapterManager.getParamsForSaveAdaptiveDataOfBlock(t.$block),i.setOldData(n),historyBuffer.startOperation(i)),t.$blk_data.find("*[style]").each(function(){$(this).css({"font-size":"inherit","text-align":"inherit"})}),r+="increase_font_size"==e?1:-1,t.$blk_data.css("font-size",r+"px"),adapterManager.saveAdaptiveDataOfBlock(t.$block),i&&(n=adapterManager.getParamsForSaveAdaptiveDataOfBlock(t.$block),i.setNewData(n),historyBuffer.finishOperation(i));var s=a.attr("data-timeout_id"),d=function(e,t){e.tooltip("destroy"),e.attr("title",t),e.removeAttr("data-timeout_id"),e.removeAttr("data-orig_title")},l=function(e,t){e.attr("data-orig_title",e.attr("title")),e.removeAttr("title"),e.tooltip({animation:!1,title:t,trigger:"manual"}),e.tooltip("show"),e.attr("data-timeout_id",setTimeout(function(){d(e,e.attr("data-orig_title"))},1e3))};return s?(clearTimeout(s),d(a,a.attr("data-orig_title")),l(a,r)):l(a,r),setTimeout(function(){hybridBlockPanel.fixPosition(t.$block)}),!1},e.setAlign=function(e){var a,i,n=e.substr(6),r=t.$block.attr("id");return pages_editor.userCanUndoRedo&&(a=new cHistoryItemBlockSaveAdaptive(r),i=adapterManager.getParamsForSaveAdaptiveDataOfBlock(t.$block),a.setOldData(i),historyBuffer.startOperation(a)),t.$blk_data.find("*[style]").each(function(){$(this).css({"font-size":"inherit","text-align":"inherit"})}),t.$blk_data.css("text-align",n),adapterManager.saveAdaptiveDataOfBlock(t.$block),a&&(i=adapterManager.getParamsForSaveAdaptiveDataOfBlock(t.$block),a.setNewData(i),historyBuffer.finishOperation(a)),!1},e.saveBlock=function(){adapterManager.saveAdaptiveDataOfBlock(t.$block)},$("#sections_list, #popup_list").on("click",".blk_text .mc-text-control",e.click)}(),function(){var e={},t={};e.click=function(a){switch(t.$btn=$(a.currentTarget),t.$block=t.$btn.closest(".blk"),t.type=t.$btn.attr("btn-type"),t.type){case"align_left":case"align_center":case"align_right":e.setAlign(t.type);break;case"save":e.saveBlock()}return!1},e.setAlign=function(e){var a,i,n=e.substr(6,1),r=n+"_text",o=t.$block.attr("id");return window.userCanUndoRedo&&(a=new cHistoryItemBlockSaveAdaptive(o),i=adapterManager.getParamsForSaveAdaptiveDataOfBlock(t.$block),a.setOldData(i),historyBuffer.startOperation(a)),t.$block.find(".blk_button_data_wrap:first, .blk_form_wrap:first").removeClass("l_text").removeClass("c_text").removeClass("r_text").addClass(r),adapterManager.saveAdaptiveDataOfBlock(t.$block),a&&(i=adapterManager.getParamsForSaveAdaptiveDataOfBlock(t.$block),a.setNewData(i),historyBuffer.finishOperation(a)),!1},e.saveBlock=function(){adapterManager.saveAdaptiveDataOfBlock(t.$block)},$("#sections_list, #popup_list").on("click",".blk_button .mc-text-control, .blk_button_popup .mc-text-control, .blk_form .mc-text-control",e.click)}(),function(){var e={};e.btn_click=function(e){null!==pages_editor.$bottomEditor.data("curSmartObj")&&pages_editor.closeEditor(!0);var t=$(e.currentTarget),a=t.closest("#mobile_columns_popover"),i=parseInt(t.attr("data")),n=a.attr("block-parent-id"),r=$("#"+n);if(window.userCanUndoRedo){var o=new cHistoryItemSaveCountCellsInRow(n),s=adapterManager.getContainerAdaptiveData(r);return s.id=n,o.setOldData(s),historyBuffer.startOperation(o),adapterManager.saveCountCellsInRow(n,i),s=adapterManager.getContainerAdaptiveData(r),s.id=n,o.setNewData(s),void historyBuffer.finishOperation(o)}adapterManager.resetSizeInContainer(n),adapterManager.setCountColumn(r,i,!0),r.find(".blk").each(function(){adapterManager.processingBlockAfterResize($(this))});var d=adapterManager.getSettings(adapterManager.type);adapterManager.initContainerCells(r,d),"undefined"==typeof adapterManager.data[adapterManager.type][n]&&(adapterManager.data[adapterManager.type][n]={}),adapterManager.data[adapterManager.type][n].count_cell_in_row=i,saveMan.add("save_count_cells_in_row",{id:n,count_cell_in_row:i}),adapterManager.saveCells(r)},$("#mobile_columns_popover").find("button").bind("click",e.btn_click)}(),function(){function e(e){var a=e.attr("version"),i="Далее будет доступна отмена только тех действий, которые вы сделаете в основном редакторе сайта.";adapterManager.ADAPTABILITY_TYPE_TABLET===a?i="Далее будет доступна отмена только тех действий, которые вы сделаете в редакторе сайта для планшета.":adapterManager.ADAPTABILITY_TYPE_MOBILE===a&&(i="Далее будет доступна отмена только тех действий, которые вы сделаете в мобильном редакторе сайта.");var n='<input type="checkbox" class="mi0" onclick="adapterManager.disableConfirmOnOtherEditorMode()">',r='<div class="mt2"><label class="fs12">'+n+" Больше не показывать это сообщение</label></div>",o='<div class="">'+i+"</div>"+r;jConfirm(o,{width:400,onOk:function(){t.onOtherEditorMode(e)}})}var t={},a={};a.$responsive_menu=$(".responsive_menu"),a.$responsive_menu_title=a.$responsive_menu.find("#responsive_menu_title:first"),a.$responsive_settings=a.$responsive_menu.find(".responsive_submenu"),a.$responsive_menu_items=a.$responsive_menu.find(".responsive_menu_item"),t.setVersionTitle=function(e){a.$responsive_menu_items.removeClass("item_on"),a.$responsive_menu_items.filter("[version="+e+"]").addClass("item_on"),a.$responsive_menu_title.removeClass(adapterManager.typeIconsList.join(" ")),a.$responsive_menu_title.addClass(adapterManager.typeIcons[e])},t.setAdapterVersion=function(e){a.$responsive_menu.find('.responsive_menu_item[version="'+e+'"]').click()},t.set_view=function(){var a=$(this);return a.attr("version")==adapterManager.type?(t.closeEditorModeDropDown(a),!1):adapterManager.needConfirmOnOtherEditorMode()?(e(a),!1):t.onOtherEditorMode(a)},t.closeEditorModeDropDown=function(e){a.$responsive_settings.hide(),e.closest(".custom-dropdown").removeClass("open"),layersPanelOpenButton.updateOpenBtnPosition()},t.onOtherEditorMode=function(e){var a=e.attr("version");return t.setVersionTitle(a),adapterManager.setVersion(a),pages_editor.$addElementBtn.hasClass("active")&&pages_editor.$addElementBtn.click(),t.closeEditorModeDropDown(e),window.userCanUndoRedo&&historyManager.clearHistory(),!1},t.toggle_settings=function(){var e=$(this).parent().attr("version"),t=$(".responsive_submenu__"+e),i=function(){t.hide(),e==adapterManager.ADAPTABILITY_TYPE_PC&&adapterManager.isPC()&&site_width_manager.cancelBtnClick(),$(document).off("click","body",i)};return $(document).on("click","body",i),FE.one("hybrid/click",i),t.toggle(),a.$responsive_settings.not(t).hide(),!1},t.switch=function(){var e=$(this),t=0,a=e.closest(".responsive_submenu"),i=a.find(".switch_state"),n=a.attr("version");return e.removeClass("on"),e.hasClass("off")?(e.removeClass("off").addClass("on"),t=1,i.text("Включена")):(e.removeClass("on").addClass("off"),t=0,i.text("Отключена")),adapterManager.states[n]=t,saveMan.add("save_adaptive_settings",{value:adapterManager.states}),!1},$(document).on("click",".responsive_menu_item",t.set_view).on("click",".responsive_menu_item .fa-cog",t.toggle_settings).on("click",".responsive_submenu .mini.switch",t.switch).on("click",".responsive_submenu",function(){return null!=$(this).closest("#desktop_responsive_settings-group")}),FE.add("hybrid/click",function(){$(".menu_dropdown_item.open").click()}),window.adapterVersionPanel=t}(),function(){var e={};e.ico_click=function(e){return e.stopPropagation(),pages_editor.editBlock($(this).closest(".blk").attr("id")),paneStore.panes.button_popup.$btnWnd.click(),!1},$(document).on("click",".mobile_control .open-section-popup, .mobile_control.open-section-popup",e.ico_click)}(),function(){function e(){this.integration_id="yandex_money",this.form_root=$(),this.module_price_id=!1,this.submitFormSettings=function(){var e={},t=!0;ymis_manager.form_root.find("input").each(function(){"checkbox"===$(this).attr("type")||"radio"===$(this).attr("type")?e[$(this).attr("name")]=$(this).prop("checked")?1:0:e[$(this).attr("name")]=$(this).val().trim()});var a=ymis_manager.validateFormSettings(e);for(var i in a)ymis_manager.form_root.find("div[parent-name="+i+"]:first").html(a[i].join("<br/>")),a[i].length>0&&(t=!1,"successURL"==i&&ymis_manager.form_root.find(".js_yamoney_settings_extra").addClass("in").css({height:"auto"}));if(t){var n={settings:e};n.form_id=pages_editor.$bottomEditor.data("curSmartObj").id,n.integration_id=ymis_manager.integration_id,saveMan.add("save_ymis_settings",n)}return t},this.onSaveSettings=function(e){formEditor.setPaymentSettings(ymis_manager.integration_id,e.settings,e.form_id)},this.clearFormSettings=function(e){sitesIntMan.isIntegrationEnabledForSite(ymis_manager.integration_id)?ymis_manager.form_root.find(".lock-ind-settings:first").hide():ymis_manager.form_root.find(".lock-ind-settings:first").show(),e.find("input").each(function(){ymis_manager.form_root.find("div[parent-name="+$(this).attr("name")+"]:first").html(""),"checkbox"===$(this).attr("type")||"radio"===$(this).attr("type")?$(this).prop("checked",!1):$(this).val("")})},this.getDefaultSettings=function(){return{wallet_number:"",targets:"",amount:"",formcomment:"",after_pay_action:"back",successURL:""}},this.validateFormSettings=function(e){var t={};for(var a in e)switch(t[a]=[],$.inArray(a,["wallet_number","targets","amount"])>=0&&0==e[a].length&&t[a].push("Поле обязательно для заполнения"),a){case"wallet_number":/[^[0-9]/.test(e[a])&&t[a].push("Неверный формат. Допустимы только цифры");break;case"amount":e[a]=e[a].split(",").join("."),/^\.|\d+\..*\.|[^\d\.{1}]/.test(e[a])&&t[a].push("Неверный формат. Допустимы только цифры"),""!==e[a]&&e[a].split(".")[0]<2&&t[a].push("Сумма должна быть не менее 2 рублей");break;case"successURL":e[a].length>0&&!checkProtocolInUrl(e[a])&&t[a].push("Неверный формат URL");break;case"targets":e[a].length>150&&t[a].push("максимальное значение поля 150 символов");break;case"formcomment":e[a].length>50&&t[a].push("максимальное значение поля 50 символов")}return t},this.loadFormSettings=function(e){var t=$(),a=ymis_manager.form_root;if(0!=a.length&&(ymis_manager.clearFormSettings(a),"undefined"!=typeof e&&"undefined"!=typeof e.settings))for(var i in e.settings)t=a.find("input[name="+i+"]"),"checkbox"===t.attr("type")||"radio"===t.attr("type")?t.prop("checked",1==e.settings[i]):t.val(e.settings[i])},this.submitLeadForm=function(e,t,a,i){var n=LpmBase64.encode(JSON.stringify({lead_id:t,key:a})),r=$("#ymis_"+e),o=r.find("input[name=successURL]"),s=o.data("url");o.val(s+t),r.find("input[name=paymentType]").val(i),r.find("input[name=label]").val(n),r.submit()},this.enabledModule=function(){var e=lockScreen("Подключаем интеграцию!",{show_animation:!0});saveMan.add("enabled_ymis_module",{integration_id:ymis_manager.integration_id,lock_id:e})},this.afterEnabledModule=function(e){ymis_manager.form_root.find("#ymis-enabled-text:first").hide(),ymis_manager.form_root.find("#ymis-msg:first").show(),setTimeout(function(){ymis_manager.form_root.find(".lock-ind-settings:first").hide()},2e3),sitesIntMan.onIntegrationEnabledForSite(ymis_manager.integration_id),unlockScreen(e)},this.getAfterPaymentUrlInput=function(){return ymis_manager.form_root.find("input[name=successURL]")},this.getAfterPaymentActionInput=function(){return ymis_manager.form_root.find(".after-pay-action__input-radio")}}FE.runOnReady(function(){window.ymis_manager=new e,ymis_manager.form_root=$("#yandex-money-ind-settings"),ymis_manager.getAfterPaymentUrlInput().on("keyup change",function(){formEditor.onChangePaymentUrl(this,window.ymis_manager)}),ymis_manager.getAfterPaymentActionInput().on("click",function(){formEditor.onSelectAfterPaymentAction(this,window.ymis_manager)}),FE.add("formEditor/loaded",function(){ymis_manager.getAfterPaymentUrlInput().trigger("change")})})}(),ModuleButtonUp.prototype.drawButton=function(){this.$btn_wrap.addClass(this.settings_arr.join(" "))},ModuleButtonUp.prototype.bindEvent=function(){var e=this;$(window).scroll(function(){$(this).scrollTop()>100?e.$btn_wrap.fadeIn():e.$btn_wrap.fadeOut()}),this.$btn_wrap.click(function(){return $("html, body").animate({scrollTop:0},600),!1})};